var As=Object.defineProperty;var Ts=(t,r,a)=>r in t?As(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a;var oo=(t,r,a)=>Ts(t,typeof r!="symbol"?r+"":r,a);import{r as y,a as mn,O as Is,N as Ps,c as ca,g as Ms,R as Ge,u as Ls,b as Bs,d as In,B as Ks}from"./vendor-Bi8yWnOT.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))i(d);new MutationObserver(d=>{for(const f of d)if(f.type==="childList")for(const p of f.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function a(d){const f={};return d.integrity&&(f.integrity=d.integrity),d.referrerPolicy&&(f.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?f.credentials="include":d.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function i(d){if(d.ep)return;d.ep=!0;const f=a(d);fetch(d.href,f)}})();var Aa={exports:{}},Nr={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fs=y,$s=Symbol.for("react.element"),qs=Symbol.for("react.fragment"),Hs=Object.prototype.hasOwnProperty,zs=Fs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Us={key:!0,ref:!0,__self:!0,__source:!0};function Ta(t,r,a){var i,d={},f=null,p=null;a!==void 0&&(f=""+a),r.key!==void 0&&(f=""+r.key),r.ref!==void 0&&(p=r.ref);for(i in r)Hs.call(r,i)&&!Us.hasOwnProperty(i)&&(d[i]=r[i]);if(t&&t.defaultProps)for(i in r=t.defaultProps,r)d[i]===void 0&&(d[i]=r[i]);return{$$typeof:$s,type:t,key:f,ref:p,props:d,_owner:zs.current}}Nr.Fragment=qs;Nr.jsx=Ta;Nr.jsxs=Ta;Aa.exports=Nr;var u=Aa.exports,uo={},la=mn;uo.createRoot=la.createRoot,uo.hydrateRoot=la.hydrateRoot;const Ws=[{path:"/",label:"Grid",icon:"â—»ï¸"},{path:"/habits",label:"Habits",icon:"ðŸ“"},{path:"/analytics",label:"Analytics",icon:"ðŸ“Š"},{path:"/settings",label:"Settings",icon:"âš™ï¸"}];function Vs(){return u.jsxs("div",{className:"min-h-screen bg-dark-bg flex flex-col",children:[u.jsx("main",{className:"flex-1 pb-16",children:u.jsx(Is,{})}),u.jsx("nav",{className:"bottom-nav",children:u.jsx("div",{className:"flex justify-around items-center max-w-lg mx-auto",children:Ws.map(t=>u.jsxs(Ps,{to:t.path,className:({isActive:r})=>`bottom-nav-item flex-1 ${r?"active":""}`,children:[u.jsx("span",{className:"text-lg mb-0.5",children:t.icon}),u.jsx("span",{className:"text-xs font-medium",children:t.label})]},t.path))})})]})}const Ae=44,Pn=140,pn=56,gr=3,Ia="2025-12-17",Ys=365,ua=300,da=8,Xs=2,tn={SCROLL_LEFT:"habitgrid-scroll-left",SCROLL_TOP:"habitgrid-scroll-top",LAST_OPENED_DATE:"habitgrid-last-opened-date"},Gs=300,Js=y.memo(function({log:r,habitColor:a,isScheduled:i,isToday:d,style:f,onPointerDown:p,onPointerUp:m,onPointerCancel:S}){const[D,O]=y.useState(!1),R=r==null?void 0:r.status;let M="transparent",F=1,q=null;R==="completed"?(M=a,q=u.jsx("span",{className:"text-white text-xs font-bold drop-shadow-sm",children:"âœ“"})):R==="skipped"?(M="#374151",q=u.jsx("span",{className:"text-gray-400 text-xs",children:"â€”"})):i||(F=.3);const I=B=>{O(!0),p(B)},z=B=>{O(!1),m(B)},ne=()=>{O(!1),S()};return u.jsx("div",{style:{...f,width:Ae,height:Ae},className:`
        absolute flex items-center justify-center
        border-r border-b border-dark-border/50
        select-none touch-none
        ${d?"bg-accent-primary/10":""}
      `,onPointerDown:I,onPointerUp:z,onPointerCancel:ne,onPointerLeave:ne,children:u.jsx("div",{className:`
          w-8 h-8 rounded-md flex items-center justify-center 
          transition-transform duration-75
          ${D?"scale-90":"scale-100"}
        `,style:{backgroundColor:M,opacity:F},children:q})})});function Qs(t,r){const a=[],i=new Date(t+"T00:00:00"),d=new Date(r+"T00:00:00"),f=new Date(i);for(;f<=d;)a.push(yo(f)),f.setDate(f.getDate()+1);return a}function yo(t){const r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}function rn(){return yo(new Date)}function Pa(){const t=new Date;return t.setDate(t.getDate()+Ys),yo(t)}function Zs(){return Qs(Ia,Pa())}function ei(t){const r=rn();return t.indexOf(r)}function Ma(t){return new Date(t+"T00:00:00")}function ti(t){return Ma(t).getDay()}function ni(t,r){if(r==="everyday")return!0;const a=ti(t);return r.includes(a)}function fa(t){const r=Ma(t),a=["S","M","T","W","T","F","S"][r.getDay()],i=r.getDate(),d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r.getMonth()];return{dayAbbrev:a,dayNum:i,monthAbbrev:d,isFirstOfMonth:i===1}}function ha(t){return t===rn()}function ri(t,r){const a=t.indexOf(r);if(a===-1){if(r<t[0])return 0;if(r>t[t.length-1])return t.length-1;for(let i=0;i<t.length-1;i++)if(r>=t[i]&&r<t[i+1])return i;return t.length-1}return a}function oi({onJump:t,onClose:r}){const[a,i]=y.useState(rn()),[d,f]=y.useState(null),p=Ia,m=Pa();y.useEffect(()=>{const D=O=>{O.key==="Escape"&&r()};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[r]);const S=D=>{D.preventDefault(),f(null);let O=a;O<p?(O=p,f(`Date adjusted to earliest available: ${p}`)):O>m&&(O=m,f(`Date adjusted to latest available: ${m}`)),d?setTimeout(()=>{t(O),r()},1e3):(t(O),r())};return u.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",onClick:r,children:[u.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),u.jsxs("div",{className:`relative w-full max-w-sm bg-dark-surface border-t sm:border 
                   border-dark-border sm:rounded-2xl rounded-t-2xl p-5`,onClick:D=>D.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-lg font-semibold",children:"Jump to Date"}),u.jsx("button",{type:"button",onClick:r,className:`w-8 h-8 rounded-full bg-dark-elevated flex items-center justify-center
                       text-gray-400 hover:text-white transition-colors`,"aria-label":"Close",children:"âœ•"})]}),u.jsxs("form",{onSubmit:S,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Select a date"}),u.jsx("input",{type:"date",value:a,onChange:D=>i(D.target.value),min:p,max:m,className:`w-full px-4 py-3 bg-dark-elevated border border-dark-border rounded-lg
                         text-white focus:border-accent-primary focus:outline-none
                         [color-scheme:dark]`,autoFocus:!0})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{type:"button",onClick:()=>i(rn()),className:`flex-1 py-2 px-3 bg-dark-elevated border border-dark-border
                         text-gray-300 text-sm rounded-lg hover:border-gray-500 transition-colors`,children:"Today"}),u.jsx("button",{type:"button",onClick:()=>i(p),className:`flex-1 py-2 px-3 bg-dark-elevated border border-dark-border
                         text-gray-300 text-sm rounded-lg hover:border-gray-500 transition-colors`,children:"Start"})]}),d&&u.jsx("div",{className:`p-2 bg-amber-500/20 border border-amber-500/30 rounded-lg 
                            text-amber-400 text-sm text-center`,children:d}),u.jsx("button",{type:"submit",className:`w-full py-3 px-4 bg-accent-primary hover:bg-accent-primary/80
                       text-white font-medium rounded-lg transition-colors`,children:"Go to Date"})]})]})]})}function ai({onSingleTap:t,onDoubleTap:r}){const a=y.useRef(null),i=y.useRef(null),d=y.useRef(null),f=y.useCallback((S,D,O)=>{S.button===0&&(a.current={startX:S.clientX,startY:S.clientY,habitId:D,date:O})},[]),p=y.useCallback(S=>{if(!a.current)return;const{startX:D,startY:O,habitId:R,date:M}=a.current,F=Math.abs(S.clientX-D),q=Math.abs(S.clientY-O);if(F>da||q>da){a.current=null;return}const I=Date.now(),z=i.current;z&&z.habitId===R&&z.date===M&&I-z.time<ua?(d.current&&(clearTimeout(d.current),d.current=null),i.current=null,r(R,M)):(i.current={habitId:R,date:M,time:I},d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{t(R,M),i.current=null,d.current=null},ua)),a.current=null},[t,r]),m=y.useCallback(()=>{a.current=null},[]);return{handlePointerDown:f,handlePointerUp:p,handlePointerCancel:m}}function si({todayIndex:t,viewportWidth:r}){const a=y.useRef(null),i=y.useRef(!1),d=y.useCallback(()=>t<0||r<=0?0:Math.max(0,t*Ae-r/2+Ae/2),[t,r]),f=y.useCallback(()=>{if(i.current)return null;try{const S=localStorage.getItem(tn.LAST_OPENED_DATE),D=rn();if(S!==D)return localStorage.setItem(tn.LAST_OPENED_DATE,D),{scrollLeft:d(),scrollTop:0};const O=localStorage.getItem(tn.SCROLL_LEFT),R=localStorage.getItem(tn.SCROLL_TOP);return O!==null&&R!==null?{scrollLeft:parseInt(O,10)||0,scrollTop:parseInt(R,10)||0}:{scrollLeft:d(),scrollTop:0}}catch(S){return console.warn("Failed to read viewport from localStorage:",S),{scrollLeft:d(),scrollTop:0}}},[d]),p=y.useCallback((S,D)=>{a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{try{localStorage.setItem(tn.SCROLL_LEFT,String(Math.round(S))),localStorage.setItem(tn.SCROLL_TOP,String(Math.round(D))),localStorage.setItem(tn.LAST_OPENED_DATE,rn())}catch(O){console.warn("Failed to save viewport to localStorage:",O)}},Gs)},[]),m=y.useCallback(()=>{i.current=!0},[]);return y.useEffect(()=>()=>{a.current&&clearTimeout(a.current)},[]),{getInitialPosition:f,savePosition:p,markRestored:m,getTodayScrollLeft:d}}function ii({habits:t,dates:r,getLog:a,onSingleTap:i,onDoubleTap:d,todayIndex:f}){const p=y.useRef(null),[m,S]=y.useState(0),[D,O]=y.useState(0),[R,M]=y.useState(0),[F,q]=y.useState(0),[I,z]=y.useState(!1),ne=r.length*Ae,B=t.length*Ae,{getInitialPosition:K,savePosition:Y,markRestored:X,getTodayScrollLeft:P}=si({todayIndex:f,viewportWidth:R}),{handlePointerDown:W,handlePointerUp:Q,handlePointerCancel:ae}=ai({onSingleTap:i,onDoubleTap:d});y.useEffect(()=>{const se=p.current;if(!se)return;const be=()=>{const de=se.getBoundingClientRect();M(de.width),q(de.height)};be();const Ce=new ResizeObserver(be);return Ce.observe(se),()=>Ce.disconnect()},[]),y.useEffect(()=>{if(R>0&&p.current&&f>=0){const se=K();se&&(p.current.scrollLeft=se.scrollLeft,p.current.scrollTop=se.scrollTop,S(se.scrollLeft),O(se.scrollTop),X())}},[R,f,K,X]);const le=y.useCallback(se=>{const be=se.currentTarget,Ce=be.scrollLeft,de=be.scrollTop;S(Ce),O(de),Y(Ce,de)},[Y]),pe=y.useMemo(()=>{if(f<0||R===0)return!0;const se=(m+R/2)/Ae;return Math.abs(se-f)<=Xs},[m,R,f]),we=y.useMemo(()=>{const se=Math.max(0,Math.floor(m/Ae)-gr),be=Math.min(r.length-1,Math.ceil((m+R)/Ae)+gr),Ce=Math.max(0,Math.floor(D/Ae)-gr),de=Math.min(t.length-1,Math.ceil((D+F)/Ae)+gr);return{startCol:se,endCol:be,startRow:Ce,endRow:de}},[m,D,R,F,r.length,t.length]),Se=y.useMemo(()=>{const se=[],{startCol:be,endCol:Ce,startRow:de,endRow:ke}=we;for(let Ke=de;Ke<=ke;Ke++){const Te=t[Ke];if(Te)for(let Ne=be;Ne<=Ce;Ne++){const Fe=r[Ne];if(!Fe)continue;const Qe=a(Te.id,Fe),ee=ni(Fe,Te.scheduleDays),me=ha(Fe);se.push(u.jsx(Js,{log:Qe,habitColor:Te.color,isScheduled:ee,isToday:me,style:{left:Ne*Ae,top:Ke*Ae},onPointerDown:dt=>W(dt,Te.id,Fe),onPointerUp:Q,onPointerCancel:ae},`${Te.id}:${Fe}`))}}return se},[we,t,r,a,W,Q,ae]),je=y.useMemo(()=>{const{startCol:se,endCol:be}=we,Ce=[];for(let de=se;de<=be;de++){const ke=r[de];if(!ke)continue;const{dayAbbrev:Ke,dayNum:Te,monthAbbrev:Ne,isFirstOfMonth:Fe}=fa(ke),Qe=ha(ke),ee=de>0?r[de-1]:null,me=Fe||de===se&&ee&&fa(ee).monthAbbrev!==Ne;Ce.push(u.jsxs("div",{className:"absolute flex flex-col items-center justify-center select-none",style:{left:de*Ae,width:Ae,height:pn,top:0},children:[me&&u.jsx("span",{className:"text-[9px] text-accent-primary font-medium -mt-1",children:Ne}),u.jsxs("div",{className:`
              flex flex-col items-center justify-center
              ${me?"mt-0":"mt-2"}
              ${Qe?"bg-accent-primary text-white font-bold rounded-lg px-1.5 py-0.5":"text-gray-400"}
            `,children:[u.jsx("span",{className:"text-[10px] opacity-70 leading-none",children:Ke}),u.jsx("span",{className:"text-xs font-medium leading-tight",children:Te})]})]},ke))}return Ce},[we,r]),rt=y.useMemo(()=>{if(f<0)return null;const{startCol:se,endCol:be}=we;return f<se||f>be?null:u.jsx("div",{className:"absolute pointer-events-none bg-accent-primary/5 border-l border-r border-accent-primary/20",style:{left:f*Ae,width:Ae,top:0,height:B}})},[f,we,B]),ut=y.useMemo(()=>{const{startRow:se,endRow:be}=we,Ce=[];for(let de=se;de<=be;de++){const ke=t[de];ke&&Ce.push(u.jsxs("div",{className:"absolute flex items-center gap-2 px-2 select-none",style:{top:de*Ae,height:Ae,width:Pn},children:[u.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center text-sm flex-shrink-0",style:{backgroundColor:`${ke.color}20`},children:ke.icon}),u.jsx("span",{className:"text-sm text-gray-200 truncate",children:ke.name})]},ke.id))}return Ce},[we,t]),Be=y.useCallback(()=>{if(p.current){const se=P();p.current.scrollTo({left:se,behavior:"smooth"})}},[P]),Je=y.useCallback(se=>{if(p.current){const be=ri(r,se),Ce=Math.max(0,be*Ae-R/2+Ae/2);p.current.scrollTo({left:Ce,behavior:"smooth"})}},[r,R]);return u.jsxs("div",{className:"relative w-full h-full overflow-hidden bg-dark-bg",children:[u.jsxs("div",{className:`absolute top-0 left-0 z-30 bg-dark-bg border-b border-r border-dark-border 
                   flex items-center justify-between px-2`,style:{width:Pn,height:pn},children:[u.jsx("span",{className:"text-gray-500 text-sm",children:"Habits"}),u.jsx("button",{onClick:()=>z(!0),className:`w-8 h-8 flex items-center justify-center text-gray-400 
                     hover:text-white hover:bg-dark-elevated rounded-lg transition-colors`,title:"Jump to date","aria-label":"Jump to date",children:"ðŸ“…"})]}),u.jsx("div",{className:"absolute top-0 z-20 bg-dark-bg border-b border-dark-border overflow-hidden",style:{left:Pn,right:0,height:pn},children:u.jsx("div",{className:"relative",style:{width:ne,height:pn,transform:`translateX(-${m}px)`},children:je})}),u.jsx("div",{className:"absolute left-0 z-20 bg-dark-bg border-r border-dark-border overflow-hidden",style:{top:pn,bottom:0,width:Pn},children:u.jsx("div",{className:"relative",style:{height:B,transform:`translateY(-${D}px)`},children:ut})}),u.jsx("div",{ref:p,className:"absolute overflow-auto",style:{top:pn,left:Pn,right:0,bottom:0,WebkitOverflowScrolling:"touch"},onScroll:le,children:u.jsxs("div",{className:"relative",style:{width:ne,height:B,minWidth:ne,minHeight:B},children:[rt,Se]})}),u.jsx("button",{onClick:Be,className:`
          absolute bottom-4 right-4 z-40 
          px-4 py-2 bg-accent-primary hover:bg-accent-primary/80
          text-white font-medium text-sm rounded-full
          shadow-lg shadow-accent-primary/30
          transition-all active:scale-95
          ${pe?"opacity-0 pointer-events-none scale-90":"opacity-100 scale-100"}
        `,children:"Today"}),u.jsx("div",{className:"absolute bottom-4 left-4 z-40 text-[10px] text-gray-500 select-none",children:"Tap = âœ“ Â· Double-tap = â€”"}),I&&u.jsx(oi,{onJump:Je,onClose:()=>z(!1)})]})}var La={exports:{}};(function(t,r){(function(a,i){t.exports=i()})(ca,function(){var a=function(e,n){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(o[c]=s[c])})(e,n)},i=function(){return(i=Object.assign||function(e){for(var n,o=1,s=arguments.length;o<s;o++)for(var c in n=arguments[o])Object.prototype.hasOwnProperty.call(n,c)&&(e[c]=n[c]);return e}).apply(this,arguments)};function d(e,n,o){for(var s,c=0,l=n.length;c<l;c++)!s&&c in n||((s=s||Array.prototype.slice.call(n,0,c))[c]=n[c]);return e.concat(s||Array.prototype.slice.call(n))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ca,p=Object.keys,m=Array.isArray;function S(e,n){return typeof n!="object"||p(n).forEach(function(o){e[o]=n[o]}),e}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var D=Object.getPrototypeOf,O={}.hasOwnProperty;function R(e,n){return O.call(e,n)}function M(e,n){typeof n=="function"&&(n=n(D(e))),(typeof Reflect>"u"?p:Reflect.ownKeys)(n).forEach(function(o){q(e,o,n[o])})}var F=Object.defineProperty;function q(e,n,o,s){F(e,n,S(o&&R(o,"get")&&typeof o.get=="function"?{get:o.get,set:o.set,configurable:!0}:{value:o,configurable:!0,writable:!0},s))}function I(e){return{from:function(n){return e.prototype=Object.create(n.prototype),q(e.prototype,"constructor",e),{extend:M.bind(null,e.prototype)}}}}var z=Object.getOwnPropertyDescriptor,ne=[].slice;function B(e,n,o){return ne.call(e,n,o)}function K(e,n){return n(e)}function Y(e){if(!e)throw new Error("Assertion Failed")}function X(e){f.setImmediate?setImmediate(e):setTimeout(e,0)}function P(e,n){if(typeof n=="string"&&R(e,n))return e[n];if(!n)return e;if(typeof n!="string"){for(var o=[],s=0,c=n.length;s<c;++s){var l=P(e,n[s]);o.push(l)}return o}var h=n.indexOf(".");if(h!==-1){var g=e[n.substr(0,h)];return g==null?void 0:P(g,n.substr(h+1))}}function W(e,n,o){if(e&&n!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof n!="string"&&"length"in n){Y(typeof o!="string"&&"length"in o);for(var s=0,c=n.length;s<c;++s)W(e,n[s],o[s])}else{var l,h,g=n.indexOf(".");g!==-1?(l=n.substr(0,g),(h=n.substr(g+1))===""?o===void 0?m(e)&&!isNaN(parseInt(l))?e.splice(l,1):delete e[l]:e[l]=o:W(g=!(g=e[l])||!R(e,l)?e[l]={}:g,h,o)):o===void 0?m(e)&&!isNaN(parseInt(n))?e.splice(n,1):delete e[n]:e[n]=o}}function Q(e){var n,o={};for(n in e)R(e,n)&&(o[n]=e[n]);return o}var ae=[].concat;function le(e){return ae.apply([],e)}var Ot="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(le([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(n){return n+e+"Array"})}))).filter(function(e){return f[e]}),pe=new Set(Ot.map(function(e){return f[e]})),we=null;function Se(e){return we=new WeakMap,e=function n(o){if(!o||typeof o!="object")return o;var s=we.get(o);if(s)return s;if(m(o)){s=[],we.set(o,s);for(var c=0,l=o.length;c<l;++c)s.push(n(o[c]))}else if(pe.has(o.constructor))s=o;else{var h,g=D(o);for(h in s=g===Object.prototype?{}:Object.create(g),we.set(o,s),o)R(o,h)&&(s[h]=n(o[h]))}return s}(e),we=null,e}var je={}.toString;function rt(e){return je.call(e).slice(8,-1)}var ut=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Be=typeof ut=="symbol"?function(e){var n;return e!=null&&(n=e[ut])&&n.apply(e)}:function(){return null};function Je(e,n){return n=e.indexOf(n),0<=n&&e.splice(n,1),0<=n}var se={};function be(e){var n,o,s,c;if(arguments.length===1){if(m(e))return e.slice();if(this===se&&typeof e=="string")return[e];if(c=Be(e)){for(o=[];!(s=c.next()).done;)o.push(s.value);return o}if(e==null)return[e];if(typeof(n=e.length)!="number")return[e];for(o=new Array(n);n--;)o[n]=e[n];return o}for(n=arguments.length,o=new Array(n);n--;)o[n]=arguments[n];return o}var Ce=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Wt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],gt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Wt),de={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ke(e,n){this.name=e,this.message=n}function Ke(e,n){return e+". Errors: "+Object.keys(n).map(function(o){return n[o].toString()}).filter(function(o,s,c){return c.indexOf(o)===s}).join(`
`)}function Te(e,n,o,s){this.failures=n,this.failedKeys=s,this.successCount=o,this.message=Ke(e,n)}function Ne(e,n){this.name="BulkError",this.failures=Object.keys(n).map(function(o){return n[o]}),this.failuresByPos=n,this.message=Ke(e,this.failures)}I(ke).from(Error).extend({toString:function(){return this.name+": "+this.message}}),I(Te).from(ke),I(Ne).from(ke);var Fe=gt.reduce(function(e,n){return e[n]=n+"Error",e},{}),Qe=ke,ee=gt.reduce(function(e,n){var o=n+"Error";function s(c,l){this.name=o,c?typeof c=="string"?(this.message="".concat(c).concat(l?`
 `+l:""),this.inner=l||null):typeof c=="object"&&(this.message="".concat(c.name," ").concat(c.message),this.inner=c):(this.message=de[n]||o,this.inner=null)}return I(s).from(Qe),e[n]=s,e},{});ee.Syntax=SyntaxError,ee.Type=TypeError,ee.Range=RangeError;var me=Wt.reduce(function(e,n){return e[n+"Error"]=ee[n],e},{}),dt=gt.reduce(function(e,n){return["Syntax","Type","Range"].indexOf(n)===-1&&(e[n+"Error"]=ee[n]),e},{});function fe(){}function ft(e){return e}function bt(e,n){return e==null||e===ft?n:function(o){return n(e(o))}}function Ze(e,n){return function(){e.apply(this,arguments),n.apply(this,arguments)}}function Pt(e,n){return e===fe?n:function(){var o=e.apply(this,arguments);o!==void 0&&(arguments[0]=o);var s=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var l=n.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Ze(s,this.onsuccess):s),c&&(this.onerror=this.onerror?Ze(c,this.onerror):c),l!==void 0?l:o}}function Xn(e,n){return e===fe?n:function(){e.apply(this,arguments);var o=this.onsuccess,s=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?Ze(o,this.onsuccess):o),s&&(this.onerror=this.onerror?Ze(s,this.onerror):s)}}function Gn(e,n){return e===fe?n:function(o){var s=e.apply(this,arguments);S(o,s);var c=this.onsuccess,l=this.onerror;return this.onsuccess=null,this.onerror=null,o=n.apply(this,arguments),c&&(this.onsuccess=this.onsuccess?Ze(c,this.onsuccess):c),l&&(this.onerror=this.onerror?Ze(l,this.onerror):l),s===void 0?o===void 0?void 0:o:S(s,o)}}function xn(e,n){return e===fe?n:function(){return n.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function ht(e,n){return e===fe?n:function(){var o=e.apply(this,arguments);if(o&&typeof o.then=="function"){for(var s=this,c=arguments.length,l=new Array(c);c--;)l[c]=arguments[c];return o.then(function(){return n.apply(s,l)})}return n.apply(this,arguments)}}dt.ModifyError=Te,dt.DexieError=ke,dt.BulkError=Ne;var Ve=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ut(e){Ve=e}var Mt={},wn=100,Ot=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,D(e),e];var n=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[n,D(n),e]}(),Wt=Ot[0],gt=Ot[1],Ot=Ot[2],gt=gt&&gt.then,et=Wt&&Wt.constructor,jt=!!Ot,xt=function(e,n){Vt.push([e,n]),ot&&(queueMicrotask(Ye),ot=!1)},on=!0,ot=!0,kt=[],an=[],jn=ft,pt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:fe,pgp:!1,env:{},finalize:fe},re=pt,Vt=[],St=0,sn=[];function Z(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var n=this._PSD=re;if(typeof e!="function"){if(e!==Mt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&$e(this,this._value))}this._state=null,this._value=null,++n.ref,function o(s,c){try{c(function(l){if(s._state===null){if(l===s)throw new TypeError("A promise cannot be resolved with itself.");var h=s._lib&&qe();l&&typeof l.then=="function"?o(s,function(g,b){l instanceof Z?l._then(g,b):l.then(g,b)}):(s._state=!0,s._value=l,He(s)),h&&at()}},$e.bind(null,s))}catch(l){$e(s,l)}}(this,e)}var kn={get:function(){var e=re,n=Nt;function o(s,c){var l=this,h=!e.global&&(e!==re||n!==Nt),g=h&&!Bt(),b=new Z(function(x,N){mt(l,new Ie(Ao(s,e,h,g),Ao(c,e,h,g),x,N,e))});return this._consoleTask&&(b._consoleTask=this._consoleTask),b}return o.prototype=Mt,o},set:function(e){q(this,"then",e&&e.prototype===Mt?kn:{get:function(){return e},set:kn.set})}};function Ie(e,n,o,s,c){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof n=="function"?n:null,this.resolve=o,this.reject=s,this.psd=c}function $e(e,n){var o,s;an.push(n),e._state===null&&(o=e._lib&&qe(),n=jn(n),e._state=!1,e._value=n,s=e,kt.some(function(c){return c._value===s._value})||kt.push(s),He(e),o&&at())}function He(e){var n=e._listeners;e._listeners=[];for(var o=0,s=n.length;o<s;++o)mt(e,n[o]);var c=e._PSD;--c.ref||c.finalize(),St===0&&(++St,xt(function(){--St==0&&Ee()},[]))}function mt(e,n){if(e._state!==null){var o=e._state?n.onFulfilled:n.onRejected;if(o===null)return(e._state?n.resolve:n.reject)(e._value);++n.psd.ref,++St,xt(tt,[o,e,n])}else e._listeners.push(n)}function tt(e,n,o){try{var s,c=n._value;!n._state&&an.length&&(an=[]),s=Ve&&n._consoleTask?n._consoleTask.run(function(){return e(c)}):e(c),n._state||an.indexOf(c)!==-1||function(l){for(var h=kt.length;h;)if(kt[--h]._value===l._value)return kt.splice(h,1)}(n),o.resolve(s)}catch(l){o.reject(l)}finally{--St==0&&Ee(),--o.psd.ref||o.psd.finalize()}}function Ye(){Xt(pt,function(){qe()&&at()})}function qe(){var e=on;return ot=on=!1,e}function at(){var e,n,o;do for(;0<Vt.length;)for(e=Vt,Vt=[],o=e.length,n=0;n<o;++n){var s=e[n];s[0].apply(null,s[1])}while(0<Vt.length);ot=on=!0}function Ee(){var e=kt;kt=[],e.forEach(function(s){s._PSD.onunhandled.call(null,s._value,s)});for(var n=sn.slice(0),o=n.length;o;)n[--o]()}function st(e){return new Z(Mt,!1,e)}function ge(e,n){var o=re;return function(){var s=qe(),c=re;try{return Kt(o,!0),e.apply(this,arguments)}catch(l){n&&n(l)}finally{Kt(c,!1),s&&at()}}}M(Z.prototype,{then:kn,_then:function(e,n){mt(this,new Ie(null,null,e,n,re))},catch:function(e){if(arguments.length===1)return this.then(null,e);var n=e,o=arguments[1];return typeof n=="function"?this.then(null,function(s){return(s instanceof n?o:st)(s)}):this.then(null,function(s){return(s&&s.name===n?o:st)(s)})},finally:function(e){return this.then(function(n){return Z.resolve(e()).then(function(){return n})},function(n){return Z.resolve(e()).then(function(){return st(n)})})},timeout:function(e,n){var o=this;return e<1/0?new Z(function(s,c){var l=setTimeout(function(){return c(new ee.Timeout(n))},e);o.then(s,c).finally(clearTimeout.bind(null,l))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&q(Z.prototype,Symbol.toStringTag,"Dexie.Promise"),pt.env=Oo(),M(Z,{all:function(){var e=be.apply(null,arguments).map(Jn);return new Z(function(n,o){e.length===0&&n([]);var s=e.length;e.forEach(function(c,l){return Z.resolve(c).then(function(h){e[l]=h,--s||n(e)},o)})})},resolve:function(e){return e instanceof Z?e:e&&typeof e.then=="function"?new Z(function(n,o){e.then(n,o)}):new Z(Mt,!0,e)},reject:st,race:function(){var e=be.apply(null,arguments).map(Jn);return new Z(function(n,o){e.map(function(s){return Z.resolve(s).then(n,o)})})},PSD:{get:function(){return re},set:function(e){return re=e}},totalEchoes:{get:function(){return Nt}},newPSD:Lt,usePSD:Xt,scheduler:{get:function(){return xt},set:function(e){xt=e}},rejectionMapper:{get:function(){return jn},set:function(e){jn=e}},follow:function(e,n){return new Z(function(o,s){return Lt(function(c,l){var h=re;h.unhandleds=[],h.onunhandled=l,h.finalize=Ze(function(){var g,b=this;g=function(){b.unhandleds.length===0?c():l(b.unhandleds[0])},sn.push(function x(){g(),sn.splice(sn.indexOf(x),1)}),++St,xt(function(){--St==0&&Ee()},[])},h.finalize),e()},n,o,s)})}}),et&&(et.allSettled&&q(Z,"allSettled",function(){var e=be.apply(null,arguments).map(Jn);return new Z(function(n){e.length===0&&n([]);var o=e.length,s=new Array(o);e.forEach(function(c,l){return Z.resolve(c).then(function(h){return s[l]={status:"fulfilled",value:h}},function(h){return s[l]={status:"rejected",reason:h}}).then(function(){return--o||n(s)})})})}),et.any&&typeof AggregateError<"u"&&q(Z,"any",function(){var e=be.apply(null,arguments).map(Jn);return new Z(function(n,o){e.length===0&&o(new AggregateError([]));var s=e.length,c=new Array(s);e.forEach(function(l,h){return Z.resolve(l).then(function(g){return n(g)},function(g){c[h]=g,--s||o(new AggregateError(c))})})})}),et.withResolvers&&(Z.withResolvers=et.withResolvers));var De={awaits:0,echoes:0,id:0},Yt=0,Dt=[],it=0,Nt=0,Sn=0;function Lt(e,n,o,s){var c=re,l=Object.create(c);return l.parent=c,l.ref=0,l.global=!1,l.id=++Sn,pt.env,l.env=jt?{Promise:Z,PromiseProp:{value:Z,configurable:!0,writable:!0},all:Z.all,race:Z.race,allSettled:Z.allSettled,any:Z.any,resolve:Z.resolve,reject:Z.reject}:{},n&&S(l,n),++c.ref,l.finalize=function(){--this.parent.ref||this.parent.finalize()},s=Xt(l,e,o,s),l.ref===0&&l.finalize(),s}function cn(){return De.id||(De.id=++Yt),++De.awaits,De.echoes+=wn,De.id}function Bt(){return!!De.awaits&&(--De.awaits==0&&(De.id=0),De.echoes=De.awaits*wn,!0)}function Jn(e){return De.echoes&&e&&e.constructor===et?(cn(),e.then(function(n){return Bt(),n},function(n){return Bt(),Re(n)})):e}function ds(){var e=Dt[Dt.length-1];Dt.pop(),Kt(e,!1)}function Kt(e,n){var o,s=re;(n?!De.echoes||it++&&e===re:!it||--it&&e===re)||queueMicrotask(n?(function(c){++Nt,De.echoes&&--De.echoes!=0||(De.echoes=De.awaits=De.id=0),Dt.push(re),Kt(c,!0)}).bind(null,e):ds),e!==re&&(re=e,s===pt&&(pt.env=Oo()),jt&&(o=pt.env.Promise,n=e.env,(s.global||e.global)&&(Object.defineProperty(f,"Promise",n.PromiseProp),o.all=n.all,o.race=n.race,o.resolve=n.resolve,o.reject=n.reject,n.allSettled&&(o.allSettled=n.allSettled),n.any&&(o.any=n.any))))}function Oo(){var e=f.Promise;return jt?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Xt(e,n,o,s,c){var l=re;try{return Kt(e,!0),n(o,s,c)}finally{Kt(l,!1)}}function Ao(e,n,o,s){return typeof e!="function"?e:function(){var c=re;o&&cn(),Kt(n,!0);try{return e.apply(this,arguments)}finally{Kt(c,!1),s&&queueMicrotask(Bt)}}}function Or(e){Promise===et&&De.echoes===0?it===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+gt).indexOf("[native code]")===-1&&(cn=Bt=fe);var Re=Z.reject,Gt="ï¿¿",At="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",To="String expected.",ln=[],Qn="__dbnames",Ar="readonly",Tr="readwrite";function Jt(e,n){return e?n?function(){return e.apply(this,arguments)&&n.apply(this,arguments)}:e:n}var Io={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Zn(e){return typeof e!="string"||/\./.test(e)?function(n){return n}:function(n){return n[e]===void 0&&e in n&&delete(n=Se(n))[e],n}}function Po(){throw ee.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ve(e,n){try{var o=Mo(e),s=Mo(n);if(o!==s)return o==="Array"?1:s==="Array"?-1:o==="binary"?1:s==="binary"?-1:o==="string"?1:s==="string"?-1:o==="Date"?1:s!=="Date"?NaN:-1;switch(o){case"number":case"Date":case"string":return n<e?1:e<n?-1:0;case"binary":return function(c,l){for(var h=c.length,g=l.length,b=h<g?h:g,x=0;x<b;++x)if(c[x]!==l[x])return c[x]<l[x]?-1:1;return h===g?0:h<g?-1:1}(Lo(e),Lo(n));case"Array":return function(c,l){for(var h=c.length,g=l.length,b=h<g?h:g,x=0;x<b;++x){var N=ve(c[x],l[x]);if(N!==0)return N}return h===g?0:h<g?-1:1}(e,n)}}catch{}return NaN}function Mo(e){var n=typeof e;return n!="object"?n:ArrayBuffer.isView(e)?"binary":(e=rt(e),e==="ArrayBuffer"?"binary":e)}function Lo(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function er(e,n,o){var s=e.schema.yProps;return s?(n&&0<o.numFailures&&(n=n.filter(function(c,l){return!o.failures[l]})),Promise.all(s.map(function(c){return c=c.updatesTable,n?e.db.table(c).where("k").anyOf(n).delete():e.db.table(c).clear()})).then(function(){return o})):o}var Dn=(Bo.prototype.execute=function(e){var n=this["@@propmod"];if(n.add!==void 0){var o=n.add;if(m(o))return d(d([],m(e)?e:[],!0),o).sort();if(typeof o=="number")return(Number(e)||0)+o;if(typeof o=="bigint")try{return BigInt(e)+o}catch{return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(n.remove!==void 0){var s=n.remove;if(m(s))return m(e)?e.filter(function(c){return!s.includes(c)}).sort():[];if(typeof s=="number")return Number(e)-s;if(typeof s=="bigint")try{return BigInt(e)-s}catch{return BigInt(0)-s}throw new TypeError("Invalid subtrahend ".concat(s))}return o=(o=n.replacePrefix)===null||o===void 0?void 0:o[0],o&&typeof e=="string"&&e.startsWith(o)?n.replacePrefix[1]+e.substring(o.length):e},Bo);function Bo(e){this["@@propmod"]=e}function Ko(e,n){for(var o=p(n),s=o.length,c=!1,l=0;l<s;++l){var h=o[l],g=n[h],b=P(e,h);g instanceof Dn?(W(e,h,g.execute(b)),c=!0):b!==g&&(W(e,h,g),c=!0)}return c}var Fo=(_e.prototype._trans=function(e,n,o){var s=this._tx||re.trans,c=this.name,l=Ve&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function h(x,N,v){if(!v.schema[c])throw new ee.NotFound("Table "+c+" not part of transaction");return n(v.idbtrans,v)}var g=qe();try{var b=s&&s.db._novip===this.db._novip?s===re.trans?s._promise(e,h,o):Lt(function(){return s._promise(e,h,o)},{trans:s,transless:re.transless||re}):function x(N,v,_,w){if(N.idbdb&&(N._state.openComplete||re.letThrough||N._vip)){var j=N._createTransaction(v,_,N._dbSchema);try{j.create(),N._state.PR1398_maxLoop=3}catch(k){return k.name===Fe.InvalidState&&N.isOpen()&&0<--N._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),N.close({disableAutoOpen:!1}),N.open().then(function(){return x(N,v,_,w)})):Re(k)}return j._promise(v,function(k,C){return Lt(function(){return re.trans=j,w(k,C,j)})}).then(function(k){if(v==="readwrite")try{j.idbtrans.commit()}catch{}return v==="readonly"?k:j._completion.then(function(){return k})})}if(N._state.openComplete)return Re(new ee.DatabaseClosed(N._state.dbOpenError));if(!N._state.isBeingOpened){if(!N._state.autoOpen)return Re(new ee.DatabaseClosed);N.open().catch(fe)}return N._state.dbReadyPromise.then(function(){return x(N,v,_,w)})}(this.db,e,[this.name],h);return l&&(b._consoleTask=l,b=b.catch(function(x){return console.trace(x),Re(x)})),b}finally{g&&at()}},_e.prototype.get=function(e,n){var o=this;return e&&e.constructor===Object?this.where(e).first(n):e==null?Re(new ee.Type("Invalid argument to Table.get()")):this._trans("readonly",function(s){return o.core.get({trans:s,key:e}).then(function(c){return o.hook.reading.fire(c)})}).then(n)},_e.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(m(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var n=p(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(g){if(g.compound&&n.every(function(x){return 0<=g.keyPath.indexOf(x)})){for(var b=0;b<n.length;++b)if(n.indexOf(g.keyPath[b])===-1)return!1;return!0}return!1}).sort(function(g,b){return g.keyPath.length-b.keyPath.length})[0];if(o&&this.db._maxKey!==Gt){var l=o.keyPath.slice(0,n.length);return this.where(l).equals(l.map(function(b){return e[b]}))}!o&&Ve&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(n.join("+"),"]"));var s=this.schema.idxByName;function c(g,b){return ve(g,b)===0}var h=n.reduce(function(v,b){var x=v[0],N=v[1],v=s[b],_=e[b];return[x||v,x||!v?Jt(N,v&&v.multi?function(w){return w=P(w,b),m(w)&&w.some(function(j){return c(_,j)})}:function(w){return c(_,P(w,b))}):N]},[null,null]),l=h[0],h=h[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(h):o?this.filter(h):this.where(n).equals("")},_e.prototype.filter=function(e){return this.toCollection().and(e)},_e.prototype.count=function(e){return this.toCollection().count(e)},_e.prototype.offset=function(e){return this.toCollection().offset(e)},_e.prototype.limit=function(e){return this.toCollection().limit(e)},_e.prototype.each=function(e){return this.toCollection().each(e)},_e.prototype.toArray=function(e){return this.toCollection().toArray(e)},_e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},_e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,m(e)?"[".concat(e.join("+"),"]"):e))},_e.prototype.reverse=function(){return this.toCollection().reverse()},_e.prototype.mapToClass=function(e){var n,o=this.db,s=this.name;function c(){return n!==null&&n.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Po&&(function(b,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function N(){this.constructor=b}a(b,x),b.prototype=x===null?Object.create(x):(N.prototype=x.prototype,new N)}(c,n=e),Object.defineProperty(c.prototype,"db",{get:function(){return o},enumerable:!1,configurable:!0}),c.prototype.table=function(){return s},e=c);for(var l=new Set,h=e.prototype;h;h=D(h))Object.getOwnPropertyNames(h).forEach(function(b){return l.add(b)});function g(b){if(!b)return b;var x,N=Object.create(e.prototype);for(x in b)if(!l.has(x))try{N[x]=b[x]}catch{}return N}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=g,this.hook("reading",g),e},_e.prototype.defineClass=function(){return this.mapToClass(function(e){S(this,e)})},_e.prototype.add=function(e,n){var o=this,s=this.schema.primKey,c=s.auto,l=s.keyPath,h=e;return l&&c&&(h=Zn(l)(e)),this._trans("readwrite",function(g){return o.core.mutate({trans:g,type:"add",keys:n!=null?[n]:null,values:[h]})}).then(function(g){return g.numFailures?Z.reject(g.failures[0]):g.lastResult}).then(function(g){if(l)try{W(e,l,g)}catch{}return g})},_e.prototype.upsert=function(e,n){var o=this,s=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return o.core.get({trans:c,key:e}).then(function(l){var h=l??{};return Ko(h,n),s&&W(h,s,e),o.core.mutate({trans:c,type:"put",values:[h],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[n]}}).then(function(g){return g.numFailures?Z.reject(g.failures[0]):!!l})})})},_e.prototype.update=function(e,n){return typeof e!="object"||m(e)?this.where(":id").equals(e).modify(n):(e=P(e,this.schema.primKey.keyPath),e===void 0?Re(new ee.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(n))},_e.prototype.put=function(e,n){var o=this,s=this.schema.primKey,c=s.auto,l=s.keyPath,h=e;return l&&c&&(h=Zn(l)(e)),this._trans("readwrite",function(g){return o.core.mutate({trans:g,type:"put",values:[h],keys:n!=null?[n]:null})}).then(function(g){return g.numFailures?Z.reject(g.failures[0]):g.lastResult}).then(function(g){if(l)try{W(e,l,g)}catch{}return g})},_e.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(o){return n.core.mutate({trans:o,type:"delete",keys:[e]}).then(function(s){return er(n,[e],s)}).then(function(s){return s.numFailures?Z.reject(s.failures[0]):void 0})})},_e.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:Io}).then(function(o){return er(e,null,o)})}).then(function(n){return n.numFailures?Z.reject(n.failures[0]):void 0})},_e.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(o){return n.core.getMany({keys:e,trans:o}).then(function(s){return s.map(function(c){return n.hook.reading.fire(c)})})})},_e.prototype.bulkAdd=function(e,n,o){var s=this,c=Array.isArray(n)?n:void 0,l=(o=o||(c?void 0:n))?o.allKeys:void 0;return this._trans("readwrite",function(h){var x=s.schema.primKey,g=x.auto,x=x.keyPath;if(x&&c)throw new ee.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==e.length)throw new ee.InvalidArgument("Arguments objects and keys must have the same length");var b=e.length,x=x&&g?e.map(Zn(x)):e;return s.core.mutate({trans:h,type:"add",keys:c,values:x,wantResults:l}).then(function(j){var v=j.numFailures,_=j.results,w=j.lastResult,j=j.failures;if(v===0)return l?_:w;throw new Ne("".concat(s.name,".bulkAdd(): ").concat(v," of ").concat(b," operations failed"),j)})})},_e.prototype.bulkPut=function(e,n,o){var s=this,c=Array.isArray(n)?n:void 0,l=(o=o||(c?void 0:n))?o.allKeys:void 0;return this._trans("readwrite",function(h){var x=s.schema.primKey,g=x.auto,x=x.keyPath;if(x&&c)throw new ee.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==e.length)throw new ee.InvalidArgument("Arguments objects and keys must have the same length");var b=e.length,x=x&&g?e.map(Zn(x)):e;return s.core.mutate({trans:h,type:"put",keys:c,values:x,wantResults:l}).then(function(j){var v=j.numFailures,_=j.results,w=j.lastResult,j=j.failures;if(v===0)return l?_:w;throw new Ne("".concat(s.name,".bulkPut(): ").concat(v," of ").concat(b," operations failed"),j)})})},_e.prototype.bulkUpdate=function(e){var n=this,o=this.core,s=e.map(function(h){return h.key}),c=e.map(function(h){return h.changes}),l=[];return this._trans("readwrite",function(h){return o.getMany({trans:h,keys:s,cache:"clone"}).then(function(g){var b=[],x=[];e.forEach(function(v,_){var w=v.key,j=v.changes,k=g[_];if(k){for(var C=0,E=Object.keys(j);C<E.length;C++){var A=E[C],T=j[A];if(A===n.schema.primKey.keyPath){if(ve(T,w)!==0)throw new ee.Constraint("Cannot update primary key in bulkUpdate()")}else W(k,A,T)}l.push(_),b.push(w),x.push(k)}});var N=b.length;return o.mutate({trans:h,type:"put",keys:b,values:x,updates:{keys:s,changeSpecs:c}}).then(function(v){var _=v.numFailures,w=v.failures;if(_===0)return N;for(var j=0,k=Object.keys(w);j<k.length;j++){var C,E=k[j],A=l[Number(E)];A!=null&&(C=w[E],delete w[E],w[A]=C)}throw new Ne("".concat(n.name,".bulkUpdate(): ").concat(_," of ").concat(N," operations failed"),w)})})})},_e.prototype.bulkDelete=function(e){var n=this,o=e.length;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"delete",keys:e}).then(function(c){return er(n,e,c)})}).then(function(h){var c=h.numFailures,l=h.lastResult,h=h.failures;if(c===0)return l;throw new Ne("".concat(n.name,".bulkDelete(): ").concat(c," of ").concat(o," operations failed"),h)})},_e);function _e(){}function Nn(e){function n(h,g){if(g){for(var b=arguments.length,x=new Array(b-1);--b;)x[b-1]=arguments[b];return o[h].subscribe.apply(null,x),e}if(typeof h=="string")return o[h]}var o={};n.addEventType=l;for(var s=1,c=arguments.length;s<c;++s)l(arguments[s]);return n;function l(h,g,b){if(typeof h!="object"){var x;g=g||xn;var N={subscribers:[],fire:b=b||fe,subscribe:function(v){N.subscribers.indexOf(v)===-1&&(N.subscribers.push(v),N.fire=g(N.fire,v))},unsubscribe:function(v){N.subscribers=N.subscribers.filter(function(_){return _!==v}),N.fire=N.subscribers.reduce(g,b)}};return o[h]=n[h]=N}p(x=h).forEach(function(v){var _=x[v];if(m(_))l(v,x[v][0],x[v][1]);else{if(_!=="asap")throw new ee.InvalidArgument("Invalid event config");var w=l(v,ft,function(){for(var j=arguments.length,k=new Array(j);j--;)k[j]=arguments[j];w.subscribers.forEach(function(C){X(function(){C.apply(null,k)})})})}})}}function Cn(e,n){return I(n).from({prototype:e}),n}function un(e,n){return!(e.filter||e.algorithm||e.or)&&(n?e.justLimit:!e.replayFilter)}function Ir(e,n){e.filter=Jt(e.filter,n)}function Pr(e,n,o){var s=e.replayFilter;e.replayFilter=s?function(){return Jt(s(),n())}:n,e.justLimit=o&&!s}function tr(e,n){if(e.isPrimKey)return n.primaryKey;var o=n.getIndexByKeyPath(e.index);if(!o)throw new ee.Schema("KeyPath "+e.index+" on object store "+n.name+" is not indexed");return o}function $o(e,n,o){var s=tr(e,n.schema);return n.openCursor({trans:o,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:s,range:e.range}})}function nr(e,n,o,s){var c=e.replayFilter?Jt(e.filter,e.replayFilter()):e.filter;if(e.or){var l={},h=function(g,b,x){var N,v;c&&!c(b,x,function(_){return b.stop(_)},function(_){return b.fail(_)})||((v=""+(N=b.primaryKey))=="[object ArrayBuffer]"&&(v=""+new Uint8Array(N)),R(l,v)||(l[v]=!0,n(g,b,x)))};return Promise.all([e.or._iterate(h,o),qo($o(e,s,o),e.algorithm,h,!e.keysOnly&&e.valueMapper)])}return qo($o(e,s,o),Jt(e.algorithm,c),n,!e.keysOnly&&e.valueMapper)}function qo(e,n,o,s){var c=ge(s?function(l,h,g){return o(s(l),h,g)}:o);return e.then(function(l){if(l)return l.start(function(){var h=function(){return l.continue()};n&&!n(l,function(g){return h=g},function(g){l.stop(g),h=fe},function(g){l.fail(g),h=fe})||c(l.value,l,function(g){return h=g}),h()})})}var fs=(xe.prototype._read=function(e,n){var o=this._ctx;return o.error?o.table._trans(null,Re.bind(null,o.error)):o.table._trans("readonly",e).then(n)},xe.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,Re.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},xe.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Jt(n.algorithm,e)},xe.prototype._iterate=function(e,n){return nr(this._ctx,e,n,this._ctx.table.core)},xe.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return e&&S(o,e),n._ctx=o,n},xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},xe.prototype.each=function(e){var n=this._ctx;return this._read(function(o){return nr(n,e,o,n.table.core)})},xe.prototype.count=function(e){var n=this;return this._read(function(o){var s=n._ctx,c=s.table.core;if(un(s,!0))return c.count({trans:o,query:{index:tr(s,c.schema),range:s.range}}).then(function(h){return Math.min(h,s.limit)});var l=0;return nr(s,function(){return++l,!1},o,c).then(function(){return l})}).then(e)},xe.prototype.sortBy=function(e,n){var o=e.split(".").reverse(),s=o[0],c=o.length-1;function l(b,x){return x?l(b[o[x]],x-1):b[s]}var h=this._ctx.dir==="next"?1:-1;function g(b,x){return ve(l(b,c),l(x,c))*h}return this.toArray(function(b){return b.sort(g)}).then(n)},xe.prototype.toArray=function(e){var n=this;return this._read(function(o){var s=n._ctx;if(s.dir==="next"&&un(s,!0)&&0<s.limit){var c=s.valueMapper,l=tr(s,s.table.core.schema);return s.table.core.query({trans:o,limit:s.limit,values:!0,query:{index:l,range:s.range}}).then(function(g){return g=g.result,c?g.map(c):g})}var h=[];return nr(s,function(g){return h.push(g)},o,s.table.core).then(function(){return h})},e)},xe.prototype.offset=function(e){var n=this._ctx;return e<=0||(n.offset+=e,un(n)?Pr(n,function(){var o=e;return function(s,c){return o===0||(o===1?--o:c(function(){s.advance(o),o=0}),!1)}}):Pr(n,function(){var o=e;return function(){return--o<0}})),this},xe.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Pr(this._ctx,function(){var n=e;return function(o,s,c){return--n<=0&&s(c),0<=n}},!0),this},xe.prototype.until=function(e,n){return Ir(this._ctx,function(o,s,c){return!e(o.value)||(s(c),n)}),this},xe.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},xe.prototype.last=function(e){return this.reverse().first(e)},xe.prototype.filter=function(e){var n;return Ir(this._ctx,function(o){return e(o.value)}),(n=this._ctx).isMatch=Jt(n.isMatch,e),this},xe.prototype.and=function(e){return this.filter(e)},xe.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},xe.prototype.desc=function(){return this.reverse()},xe.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(o,s){e(s.key,s)})},xe.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},xe.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(o,s){e(s.primaryKey,s)})},xe.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var o=[];return this.each(function(s,c){o.push(c.key)}).then(function(){return o}).then(e)},xe.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&un(n,!0)&&0<n.limit)return this._read(function(s){var c=tr(n,n.table.core.schema);return n.table.core.query({trans:s,values:!1,limit:n.limit,query:{index:c,range:n.range}})}).then(function(s){return s.result}).then(e);n.keysOnly=!n.isMatch;var o=[];return this.each(function(s,c){o.push(c.primaryKey)}).then(function(){return o}).then(e)},xe.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},xe.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},xe.prototype.lastKey=function(e){return this.reverse().firstKey(e)},xe.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var n={};return Ir(this._ctx,function(c){var s=c.primaryKey.toString(),c=R(n,s);return n[s]=!0,!c}),this},xe.prototype.modify=function(e){var n=this,o=this._ctx;return this._write(function(s){var c=typeof e=="function"?e:function(k){return Ko(k,e)},l=o.table.core,x=l.schema.primaryKey,h=x.outbound,g=x.extractKey,b=200,x=n.db._options.modifyChunkSize;x&&(b=typeof x=="object"?x[l.name]||x["*"]||200:x);function N(k,A){var E=A.failures,A=A.numFailures;_+=k-A;for(var T=0,L=p(E);T<L.length;T++){var H=L[T];v.push(E[H])}}var v=[],_=0,w=[],j=e===Ho;return n.clone().primaryKeys().then(function(k){function C(A){var T=Math.min(b,k.length-A),L=k.slice(A,A+T);return(j?Promise.resolve([]):l.getMany({trans:s,keys:L,cache:"immutable"})).then(function(H){var G=[],$=[],U=h?[]:null,J=j?L:[];if(!j)for(var V=0;V<T;++V){var te=H[V],ce={value:Se(te),primKey:k[A+V]};c.call(ce,ce.value,ce)!==!1&&(ce.value==null?J.push(k[A+V]):h||ve(g(te),g(ce.value))===0?($.push(ce.value),h&&U.push(k[A+V])):(J.push(k[A+V]),G.push(ce.value)))}return Promise.resolve(0<G.length&&l.mutate({trans:s,type:"add",values:G}).then(function(ue){for(var he in ue.failures)J.splice(parseInt(he),1);N(G.length,ue)})).then(function(){return(0<$.length||E&&typeof e=="object")&&l.mutate({trans:s,type:"put",keys:U,values:$,criteria:E,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<A}).then(function(ue){return N($.length,ue)})}).then(function(){return(0<J.length||E&&j)&&l.mutate({trans:s,type:"delete",keys:J,criteria:E,isAdditionalChunk:0<A}).then(function(ue){return er(o.table,J,ue)}).then(function(ue){return N(J.length,ue)})}).then(function(){return k.length>A+T&&C(A+b)})})}var E=un(o)&&o.limit===1/0&&(typeof e!="function"||j)&&{index:o.index,range:o.range};return C(0).then(function(){if(0<v.length)throw new Te("Error modifying one or more objects",v,_,w);return k.length})})})},xe.prototype.delete=function(){var e=this._ctx,n=e.range;return!un(e)||e.table.schema.yProps||!e.isPrimKey&&n.type!==3?this.modify(Ho):this._write(function(o){var s=e.table.core.schema.primaryKey,c=n;return e.table.core.count({trans:o,query:{index:s,range:c}}).then(function(l){return e.table.core.mutate({trans:o,type:"deleteRange",range:c}).then(function(b){var g=b.failures,b=b.numFailures;if(b)throw new Te("Could not delete some values",Object.keys(g).map(function(x){return g[x]}),l-b);return l-b})})})},xe);function xe(){}var Ho=function(e,n){return n.value=null};function hs(e,n){return e<n?-1:e===n?0:1}function ps(e,n){return n<e?-1:e===n?0:1}function ct(e,n,o){return e=e instanceof Uo?new e.Collection(e):e,e._ctx.error=new(o||TypeError)(n),e}function dn(e){return new e.Collection(e,function(){return zo("")}).limit(0)}function rr(e,n,o,s){var c,l,h,g,b,x,N,v=o.length;if(!o.every(function(j){return typeof j=="string"}))return ct(e,To);function _(j){c=j==="next"?function(C){return C.toUpperCase()}:function(C){return C.toLowerCase()},l=j==="next"?function(C){return C.toLowerCase()}:function(C){return C.toUpperCase()},h=j==="next"?hs:ps;var k=o.map(function(C){return{lower:l(C),upper:c(C)}}).sort(function(C,E){return h(C.lower,E.lower)});g=k.map(function(C){return C.upper}),b=k.map(function(C){return C.lower}),N=(x=j)==="next"?"":s}_("next"),e=new e.Collection(e,function(){return Ft(g[0],b[v-1]+s)}),e._ondirectionchange=function(j){_(j)};var w=0;return e._addAlgorithm(function(j,k,C){var E=j.key;if(typeof E!="string")return!1;var A=l(E);if(n(A,b,w))return!0;for(var T=null,L=w;L<v;++L){var H=function(G,$,U,J,V,te){for(var ce=Math.min(G.length,J.length),ue=-1,he=0;he<ce;++he){var lt=$[he];if(lt!==J[he])return V(G[he],U[he])<0?G.substr(0,he)+U[he]+U.substr(he+1):V(G[he],J[he])<0?G.substr(0,he)+J[he]+U.substr(he+1):0<=ue?G.substr(0,ue)+$[ue]+U.substr(ue+1):null;V(G[he],lt)<0&&(ue=he)}return ce<J.length&&te==="next"?G+U.substr(G.length):ce<G.length&&te==="prev"?G.substr(0,U.length):ue<0?null:G.substr(0,ue)+J[ue]+U.substr(ue+1)}(E,A,g[L],b[L],h,x);H===null&&T===null?w=L+1:(T===null||0<h(T,H))&&(T=H)}return k(T!==null?function(){j.continue(T+N)}:C),!1}),e}function Ft(e,n,o,s){return{type:2,lower:e,upper:n,lowerOpen:o,upperOpen:s}}function zo(e){return{type:1,lower:e,upper:e}}var Uo=(Object.defineProperty(Me.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Me.prototype.between=function(e,n,o,s){o=o!==!1,s=s===!0;try{return 0<this._cmp(e,n)||this._cmp(e,n)===0&&(o||s)&&(!o||!s)?dn(this):new this.Collection(this,function(){return Ft(e,n,!o,!s)})}catch{return ct(this,At)}},Me.prototype.equals=function(e){return e==null?ct(this,At):new this.Collection(this,function(){return zo(e)})},Me.prototype.above=function(e){return e==null?ct(this,At):new this.Collection(this,function(){return Ft(e,void 0,!0)})},Me.prototype.aboveOrEqual=function(e){return e==null?ct(this,At):new this.Collection(this,function(){return Ft(e,void 0,!1)})},Me.prototype.below=function(e){return e==null?ct(this,At):new this.Collection(this,function(){return Ft(void 0,e,!1,!0)})},Me.prototype.belowOrEqual=function(e){return e==null?ct(this,At):new this.Collection(this,function(){return Ft(void 0,e)})},Me.prototype.startsWith=function(e){return typeof e!="string"?ct(this,To):this.between(e,e+Gt,!0,!0)},Me.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):rr(this,function(n,o){return n.indexOf(o[0])===0},[e],Gt)},Me.prototype.equalsIgnoreCase=function(e){return rr(this,function(n,o){return n===o[0]},[e],"")},Me.prototype.anyOfIgnoreCase=function(){var e=be.apply(se,arguments);return e.length===0?dn(this):rr(this,function(n,o){return o.indexOf(n)!==-1},e,"")},Me.prototype.startsWithAnyOfIgnoreCase=function(){var e=be.apply(se,arguments);return e.length===0?dn(this):rr(this,function(n,o){return o.some(function(s){return n.indexOf(s)===0})},e,Gt)},Me.prototype.anyOf=function(){var e=this,n=be.apply(se,arguments),o=this._cmp;try{n.sort(o)}catch{return ct(this,At)}if(n.length===0)return dn(this);var s=new this.Collection(this,function(){return Ft(n[0],n[n.length-1])});s._ondirectionchange=function(l){o=l==="next"?e._ascending:e._descending,n.sort(o)};var c=0;return s._addAlgorithm(function(l,h,g){for(var b=l.key;0<o(b,n[c]);)if(++c===n.length)return h(g),!1;return o(b,n[c])===0||(h(function(){l.continue(n[c])}),!1)}),s},Me.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Me.prototype.noneOf=function(){var e=be.apply(se,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return ct(this,At)}var n=e.reduce(function(o,s){return o?o.concat([[o[o.length-1][1],s]]):[[-1/0,s]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},Me.prototype.inAnyRange=function(E,n){var o=this,s=this._cmp,c=this._ascending,l=this._descending,h=this._min,g=this._max;if(E.length===0)return dn(this);if(!E.every(function(A){return A[0]!==void 0&&A[1]!==void 0&&c(A[0],A[1])<=0}))return ct(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ee.InvalidArgument);var b=!n||n.includeLowers!==!1,x=n&&n.includeUppers===!0,N,v=c;function _(A,T){return v(A[0],T[0])}try{(N=E.reduce(function(A,T){for(var L=0,H=A.length;L<H;++L){var G=A[L];if(s(T[0],G[1])<0&&0<s(T[1],G[0])){G[0]=h(G[0],T[0]),G[1]=g(G[1],T[1]);break}}return L===H&&A.push(T),A},[])).sort(_)}catch{return ct(this,At)}var w=0,j=x?function(A){return 0<c(A,N[w][1])}:function(A){return 0<=c(A,N[w][1])},k=b?function(A){return 0<l(A,N[w][0])}:function(A){return 0<=l(A,N[w][0])},C=j,E=new this.Collection(this,function(){return Ft(N[0][0],N[N.length-1][1],!b,!x)});return E._ondirectionchange=function(A){v=A==="next"?(C=j,c):(C=k,l),N.sort(_)},E._addAlgorithm(function(A,T,L){for(var H,G=A.key;C(G);)if(++w===N.length)return T(L),!1;return!j(H=G)&&!k(H)||(o._cmp(G,N[w][1])===0||o._cmp(G,N[w][0])===0||T(function(){v===c?A.continue(N[w][0]):A.continue(N[w][1])}),!1)}),E},Me.prototype.startsWithAnyOf=function(){var e=be.apply(se,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?dn(this):this.inAnyRange(e.map(function(n){return[n,n+Gt]})):ct(this,"startsWithAnyOf() only works with strings")},Me);function Me(){}function Ct(e){return ge(function(n){return _n(n),e(n.target.error),!1})}function _n(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var En="storagemutated",Mr="x-storagemutated-1",$t=Nn(null,En),ms=(_t.prototype._lock=function(){return Y(!re.global),++this._reculock,this._reculock!==1||re.global||(re.lockOwnerFor=this),this},_t.prototype._unlock=function(){if(Y(!re.global),--this._reculock==0)for(re.global||(re.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Xt(e[1],e[0])}catch{}}return this},_t.prototype._locked=function(){return this._reculock&&re.lockOwnerFor!==this},_t.prototype.create=function(e){var n=this;if(!this.mode)return this;var o=this.db.idbdb,s=this.db._state.dbOpenError;if(Y(!this.idbtrans),!e&&!o)switch(s&&s.name){case"DatabaseClosedError":throw new ee.DatabaseClosed(s);case"MissingAPIError":throw new ee.MissingAPI(s.message,s);default:throw new ee.OpenFailed(s)}if(!this.active)throw new ee.TransactionInactive;return Y(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||o).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ge(function(c){_n(c),n._reject(e.error)}),e.onabort=ge(function(c){_n(c),n.active&&n._reject(new ee.Abort(e.error)),n.active=!1,n.on("abort").fire(c)}),e.oncomplete=ge(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&$t.storagemutated.fire(e.mutatedParts)}),this},_t.prototype._promise=function(e,n,o){var s=this;if(e==="readwrite"&&this.mode!=="readwrite")return Re(new ee.ReadOnly("Transaction is readonly"));if(!this.active)return Re(new ee.TransactionInactive);if(this._locked())return new Z(function(l,h){s._blockedFuncs.push([function(){s._promise(e,n,o).then(l,h)},re])});if(o)return Lt(function(){var l=new Z(function(h,g){s._lock();var b=n(h,g,s);b&&b.then&&b.then(h,g)});return l.finally(function(){return s._unlock()}),l._lib=!0,l});var c=new Z(function(l,h){var g=n(l,h,s);g&&g.then&&g.then(l,h)});return c._lib=!0,c},_t.prototype._root=function(){return this.parent?this.parent._root():this},_t.prototype.waitFor=function(e){var n,o=this._root(),s=Z.resolve(e);o._waitingFor?o._waitingFor=o._waitingFor.then(function(){return s}):(o._waitingFor=s,o._waitingQueue=[],n=o.idbtrans.objectStore(o.storeNames[0]),function l(){for(++o._spinCount;o._waitingQueue.length;)o._waitingQueue.shift()();o._waitingFor&&(n.get(-1/0).onsuccess=l)}());var c=o._waitingFor;return new Z(function(l,h){s.then(function(g){return o._waitingQueue.push(ge(l.bind(null,g)))},function(g){return o._waitingQueue.push(ge(h.bind(null,g)))}).finally(function(){o._waitingFor===c&&(o._waitingFor=null)})})},_t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ee.Abort))},_t.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(R(n,e))return n[e];var o=this.schema[e];if(!o)throw new ee.NotFound("Table "+e+" not part of transaction");return o=new this.db.Table(e,o,this),o.core=this.db.core.table(e),n[e]=o},_t);function _t(){}function Lr(e,n,o,s,c,l,h,g){return{name:e,keyPath:n,unique:o,multi:s,auto:c,compound:l,src:(o&&!h?"&":"")+(s?"*":"")+(c?"++":"")+Wo(n),type:g}}function Wo(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Br(e,n,o){return{name:e,primKey:n,indexes:o,mappedClass:null,idxByName:(s=function(c){return[c.name,c]},o.reduce(function(c,l,h){return h=s(l,h),h&&(c[h[0]]=h[1]),c},{}))};var s}var Rn=function(e){try{return e.only([[]]),Rn=function(){return[[]]},[[]]}catch{return Rn=function(){return Gt},Gt}};function Kr(e){return e==null?function(){}:typeof e=="string"?(n=e).split(".").length===1?function(o){return o[n]}:function(o){return P(o,n)}:function(o){return P(o,e)};var n}function Vo(e){return[].slice.call(e)}var gs=0;function On(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function vs(e,n,b){function s(C){if(C.type===3)return null;if(C.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var w=C.lower,j=C.upper,k=C.lowerOpen,C=C.upperOpen;return w===void 0?j===void 0?null:n.upperBound(j,!!C):j===void 0?n.lowerBound(w,!!k):n.bound(w,j,!!k,!!C)}function c(_){var w,j=_.name;return{name:j,schema:_,mutate:function(k){var C=k.trans,E=k.type,A=k.keys,T=k.values,L=k.range;return new Promise(function(H,G){H=ge(H);var $=C.objectStore(j),U=$.keyPath==null,J=E==="put"||E==="add";if(!J&&E!=="delete"&&E!=="deleteRange")throw new Error("Invalid operation type: "+E);var V,te=(A||T||{length:1}).length;if(A&&T&&A.length!==T.length)throw new Error("Given keys array must have same length as given values array.");if(te===0)return H({numFailures:0,failures:{},results:[],lastResult:void 0});function ce(Xe){++lt,_n(Xe)}var ue=[],he=[],lt=0;if(E==="deleteRange"){if(L.type===4)return H({numFailures:lt,failures:he,results:[],lastResult:void 0});L.type===3?ue.push(V=$.clear()):ue.push(V=$.delete(s(L)))}else{var U=J?U?[T,A]:[T,null]:[A,null],ie=U[0],Ue=U[1];if(J)for(var We=0;We<te;++We)ue.push(V=Ue&&Ue[We]!==void 0?$[E](ie[We],Ue[We]):$[E](ie[We])),V.onerror=ce;else for(We=0;We<te;++We)ue.push(V=$[E](ie[We])),V.onerror=ce}function mr(Xe){Xe=Xe.target.result,ue.forEach(function(en,ro){return en.error!=null&&(he[ro]=en.error)}),H({numFailures:lt,failures:he,results:E==="delete"?A:ue.map(function(en){return en.result}),lastResult:Xe})}V.onerror=function(Xe){ce(Xe),mr(Xe)},V.onsuccess=mr})},getMany:function(k){var C=k.trans,E=k.keys;return new Promise(function(A,T){A=ge(A);for(var L,H=C.objectStore(j),G=E.length,$=new Array(G),U=0,J=0,V=function(ue){ue=ue.target,$[ue._pos]=ue.result,++J===U&&A($)},te=Ct(T),ce=0;ce<G;++ce)E[ce]!=null&&((L=H.get(E[ce]))._pos=ce,L.onsuccess=V,L.onerror=te,++U);U===0&&A($)})},get:function(k){var C=k.trans,E=k.key;return new Promise(function(A,T){A=ge(A);var L=C.objectStore(j).get(E);L.onsuccess=function(H){return A(H.target.result)},L.onerror=Ct(T)})},query:(w=x,function(k){return new Promise(function(C,E){C=ge(C);var A,T,L,U=k.trans,H=k.values,G=k.limit,V=k.query,$=G===1/0?void 0:G,J=V.index,V=V.range,U=U.objectStore(j),J=J.isPrimaryKey?U:U.index(J.name),V=s(V);if(G===0)return C({result:[]});w?(($=H?J.getAll(V,$):J.getAllKeys(V,$)).onsuccess=function(te){return C({result:te.target.result})},$.onerror=Ct(E)):(A=0,T=!H&&"openKeyCursor"in J?J.openKeyCursor(V):J.openCursor(V),L=[],T.onsuccess=function(te){var ce=T.result;return ce?(L.push(H?ce.value:ce.primaryKey),++A===G?C({result:L}):void ce.continue()):C({result:L})},T.onerror=Ct(E))})}),openCursor:function(k){var C=k.trans,E=k.values,A=k.query,T=k.reverse,L=k.unique;return new Promise(function(H,G){H=ge(H);var J=A.index,$=A.range,U=C.objectStore(j),U=J.isPrimaryKey?U:U.index(J.name),J=T?L?"prevunique":"prev":L?"nextunique":"next",V=!E&&"openKeyCursor"in U?U.openKeyCursor(s($),J):U.openCursor(s($),J);V.onerror=Ct(G),V.onsuccess=ge(function(te){var ce,ue,he,lt,ie=V.result;ie?(ie.___id=++gs,ie.done=!1,ce=ie.continue.bind(ie),ue=(ue=ie.continuePrimaryKey)&&ue.bind(ie),he=ie.advance.bind(ie),lt=function(){throw new Error("Cursor not stopped")},ie.trans=C,ie.stop=ie.continue=ie.continuePrimaryKey=ie.advance=function(){throw new Error("Cursor not started")},ie.fail=ge(G),ie.next=function(){var Ue=this,We=1;return this.start(function(){return We--?Ue.continue():Ue.stop()}).then(function(){return Ue})},ie.start=function(Ue){function We(){if(V.result)try{Ue()}catch(Xe){ie.fail(Xe)}else ie.done=!0,ie.start=function(){throw new Error("Cursor behind last entry")},ie.stop()}var mr=new Promise(function(Xe,en){Xe=ge(Xe),V.onerror=Ct(en),ie.fail=en,ie.stop=function(ro){ie.stop=ie.continue=ie.continuePrimaryKey=ie.advance=lt,Xe(ro)}});return V.onsuccess=ge(function(Xe){V.onsuccess=We,We()}),ie.continue=ce,ie.continuePrimaryKey=ue,ie.advance=he,We(),mr},H(ie)):H(null)},G)})},count:function(k){var C=k.query,E=k.trans,A=C.index,T=C.range;return new Promise(function(L,H){var G=E.objectStore(j),$=A.isPrimaryKey?G:G.index(A.name),G=s(T),$=G?$.count(G):$.count();$.onsuccess=ge(function(U){return L(U.target.result)}),$.onerror=Ct(H)})}}}var l,h,g,N=(h=b,g=Vo((l=e).objectStoreNames),{schema:{name:l.name,tables:g.map(function(_){return h.objectStore(_)}).map(function(_){var w=_.keyPath,C=_.autoIncrement,j=m(w),k={},C={name:_.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:w==null,compound:j,keyPath:w,autoIncrement:C,unique:!0,extractKey:Kr(w)},indexes:Vo(_.indexNames).map(function(E){return _.index(E)}).map(function(L){var A=L.name,T=L.unique,H=L.multiEntry,L=L.keyPath,H={name:A,compound:m(L),keyPath:L,unique:T,multiEntry:H,extractKey:Kr(L)};return k[On(L)]=H}),getIndexByKeyPath:function(E){return k[On(E)]}};return k[":id"]=C.primaryKey,w!=null&&(k[On(w)]=C.primaryKey),C})},hasGetAll:0<g.length&&"getAll"in h.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),b=N.schema,x=N.hasGetAll,N=b.tables.map(c),v={};return N.forEach(function(_){return v[_.name]=_}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(_){if(!v[_])throw new Error("Table '".concat(_,"' not found"));return v[_]},MIN_KEY:-1/0,MAX_KEY:Rn(n),schema:b}}function ys(e,n,o,s){var c=o.IDBKeyRange;return o.indexedDB,{dbcore:(s=vs(n,c,s),e.dbcore.reduce(function(l,h){return h=h.create,i(i({},l),h(l))},s))}}function or(e,s){var o=s.db,s=ys(e._middlewares,o,e._deps,s);e.core=s.dbcore,e.tables.forEach(function(c){var l=c.name;e.core.schema.tables.some(function(h){return h.name===l})&&(c.core=e.core.table(l),e[l]instanceof e.Table&&(e[l].core=c.core))})}function ar(e,n,o,s){o.forEach(function(c){var l=s[c];n.forEach(function(h){var g=function b(x,N){return z(x,N)||(x=D(x))&&b(x,N)}(h,c);(!g||"value"in g&&g.value===void 0)&&(h===e.Transaction.prototype||h instanceof e.Transaction?q(h,c,{get:function(){return this.table(c)},set:function(b){F(this,c,{value:b,writable:!0,configurable:!0,enumerable:!0})}}):h[c]=new e.Table(c,l))})})}function Fr(e,n){n.forEach(function(o){for(var s in o)o[s]instanceof e.Table&&delete o[s]})}function bs(e,n){return e._cfg.version-n._cfg.version}function xs(e,n,o,s){var c=e._dbSchema;o.objectStoreNames.contains("$meta")&&!c.$meta&&(c.$meta=Br("$meta",Xo("")[0],[]),e._storeNames.push("$meta"));var l=e._createTransaction("readwrite",e._storeNames,c);l.create(o),l._completion.catch(s);var h=l._reject.bind(l),g=re.transless||re;Lt(function(){return re.trans=l,re.transless=g,n!==0?(or(e,o),x=n,((b=l).storeNames.includes("$meta")?b.table("$meta").get("version").then(function(N){return N??x}):Z.resolve(x)).then(function(N){return _=N,w=l,j=o,k=[],N=(v=e)._versions,C=v._dbSchema=ir(0,v.idbdb,j),(N=N.filter(function(E){return E._cfg.version>=_})).length!==0?(N.forEach(function(E){k.push(function(){var A=C,T=E._cfg.dbschema;cr(v,A,j),cr(v,T,j),C=v._dbSchema=T;var L=$r(A,T);L.add.forEach(function(J){qr(j,J[0],J[1].primKey,J[1].indexes)}),L.change.forEach(function(J){if(J.recreate)throw new ee.Upgrade("Not yet support for changing primary key");var V=j.objectStore(J.name);J.add.forEach(function(te){return sr(V,te)}),J.change.forEach(function(te){V.deleteIndex(te.name),sr(V,te)}),J.del.forEach(function(te){return V.deleteIndex(te)})});var H=E._cfg.contentUpgrade;if(H&&E._cfg.version>_){or(v,j),w._memoizedTables={};var G=Q(T);L.del.forEach(function(J){G[J]=A[J]}),Fr(v,[v.Transaction.prototype]),ar(v,[v.Transaction.prototype],p(G),G),w.schema=G;var $,U=Ce(H);return U&&cn(),L=Z.follow(function(){var J;($=H(w))&&U&&(J=Bt.bind(null,null),$.then(J,J))}),$&&typeof $.then=="function"?Z.resolve($):L.then(function(){return $})}}),k.push(function(A){var T,L,H=E._cfg.dbschema;T=H,L=A,[].slice.call(L.db.objectStoreNames).forEach(function(G){return T[G]==null&&L.db.deleteObjectStore(G)}),Fr(v,[v.Transaction.prototype]),ar(v,[v.Transaction.prototype],v._storeNames,v._dbSchema),w.schema=v._dbSchema}),k.push(function(A){v.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(v.idbdb.version/10)===E._cfg.version?(v.idbdb.deleteObjectStore("$meta"),delete v._dbSchema.$meta,v._storeNames=v._storeNames.filter(function(T){return T!=="$meta"})):A.objectStore("$meta").put(E._cfg.version,"version"))})}),function E(){return k.length?Z.resolve(k.shift()(w.idbtrans)).then(E):Z.resolve()}().then(function(){Yo(C,j)})):Z.resolve();var v,_,w,j,k,C}).catch(h)):(p(c).forEach(function(N){qr(o,N,c[N].primKey,c[N].indexes)}),or(e,o),void Z.follow(function(){return e.on.populate.fire(l)}).catch(h));var b,x})}function ws(e,n){Yo(e._dbSchema,n),n.db.version%10!=0||n.objectStoreNames.contains("$meta")||n.db.createObjectStore("$meta").add(Math.ceil(n.db.version/10-1),"version");var o=ir(0,e.idbdb,n);cr(e,e._dbSchema,n);for(var s=0,c=$r(o,e._dbSchema).change;s<c.length;s++){var l=function(h){if(h.change.length||h.recreate)return console.warn("Unable to patch indexes of table ".concat(h.name," because it has changes on the type of index or primary key.")),{value:void 0};var g=n.objectStore(h.name);h.add.forEach(function(b){Ve&&console.debug("Dexie upgrade patch: Creating missing index ".concat(h.name,".").concat(b.src)),sr(g,b)})}(c[s]);if(typeof l=="object")return l.value}}function $r(e,n){var o,s={del:[],add:[],change:[]};for(o in e)n[o]||s.del.push(o);for(o in n){var c=e[o],l=n[o];if(c){var h={name:o,def:l,recreate:!1,del:[],add:[],change:[]};if(""+(c.primKey.keyPath||"")!=""+(l.primKey.keyPath||"")||c.primKey.auto!==l.primKey.auto)h.recreate=!0,s.change.push(h);else{var g=c.idxByName,b=l.idxByName,x=void 0;for(x in g)b[x]||h.del.push(x);for(x in b){var N=g[x],v=b[x];N?N.src!==v.src&&h.change.push(v):h.add.push(v)}(0<h.del.length||0<h.add.length||0<h.change.length)&&s.change.push(h)}}else s.add.push([o,l])}return s}function qr(e,n,o,s){var c=e.db.createObjectStore(n,o.keyPath?{keyPath:o.keyPath,autoIncrement:o.auto}:{autoIncrement:o.auto});return s.forEach(function(l){return sr(c,l)}),c}function Yo(e,n){p(e).forEach(function(o){n.db.objectStoreNames.contains(o)||(Ve&&console.debug("Dexie: Creating missing table",o),qr(n,o,e[o].primKey,e[o].indexes))})}function sr(e,n){e.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function ir(e,n,o){var s={};return B(n.objectStoreNames,0).forEach(function(c){for(var l=o.objectStore(c),h=Lr(Wo(x=l.keyPath),x||"",!0,!1,!!l.autoIncrement,x&&typeof x!="string",!0),g=[],b=0;b<l.indexNames.length;++b){var N=l.index(l.indexNames[b]),x=N.keyPath,N=Lr(N.name,x,!!N.unique,!!N.multiEntry,!1,x&&typeof x!="string",!1);g.push(N)}s[c]=Br(c,h,g)}),s}function cr(e,n,o){for(var s=o.db.objectStoreNames,c=0;c<s.length;++c){var l=s[c],h=o.objectStore(l);e._hasGetAll="getAll"in h;for(var g=0;g<h.indexNames.length;++g){var b=h.indexNames[g],x=h.index(b).keyPath,N=typeof x=="string"?x:"["+B(x).join("+")+"]";!n[l]||(x=n[l].idxByName[N])&&(x.name=b,delete n[l].idxByName[N],n[l].idxByName[b]=x)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Xo(e){return e.split(",").map(function(n,o){var l=n.split(":"),s=(c=l[1])===null||c===void 0?void 0:c.trim(),c=(n=l[0].trim()).replace(/([&*]|\+\+)/g,""),l=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Lr(c,l||null,/\&/.test(n),/\*/.test(n),/\+\+/.test(n),m(l),o===0,s)})}var js=(fn.prototype._createTableSchema=Br,fn.prototype._parseIndexSyntax=Xo,fn.prototype._parseStoresSpec=function(e,n){var o=this;p(e).forEach(function(s){if(e[s]!==null){var c=o._parseIndexSyntax(e[s]),l=c.shift();if(!l)throw new ee.Schema("Invalid schema for table "+s+": "+e[s]);if(l.unique=!0,l.multi)throw new ee.Schema("Primary key cannot be multiEntry*");c.forEach(function(h){if(h.auto)throw new ee.Schema("Only primary key can be marked as autoIncrement (++)");if(!h.keyPath)throw new ee.Schema("Index must have a name and cannot be an empty string")}),c=o._createTableSchema(s,l,c),n[s]=c}})},fn.prototype.stores=function(o){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?S(this._cfg.storesSource,o):o;var o=n._versions,s={},c={};return o.forEach(function(l){S(s,l._cfg.storesSource),c=l._cfg.dbschema={},l._parseStoresSpec(s,c)}),n._dbSchema=c,Fr(n,[n._allTables,n,n.Transaction.prototype]),ar(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],p(c),c),n._storeNames=p(c),this},fn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=ht(this._cfg.contentUpgrade||fe,e),this},fn);function fn(){}function Hr(e,n){var o=e._dbNamesDB;return o||(o=e._dbNamesDB=new Tt(Qn,{addons:[],indexedDB:e,IDBKeyRange:n})).version(1).stores({dbnames:"name"}),o.table("dbnames")}function zr(e){return e&&typeof e.databases=="function"}function Ur(e){return Lt(function(){return re.letThrough=!0,e()})}function Wr(e){return!("from"in e)}var ze=function(e,n){if(!this){var o=new ze;return e&&"d"in e&&S(o,e),o}S(this,arguments.length?{d:1,from:e,to:1<arguments.length?n:e}:{d:0})};function An(e,n,o){var s=ve(n,o);if(!isNaN(s)){if(0<s)throw RangeError();if(Wr(e))return S(e,{from:n,to:o,d:1});var c=e.l,s=e.r;if(ve(o,e.from)<0)return c?An(c,n,o):e.l={from:n,to:o,d:1,l:null,r:null},Jo(e);if(0<ve(n,e.to))return s?An(s,n,o):e.r={from:n,to:o,d:1,l:null,r:null},Jo(e);ve(n,e.from)<0&&(e.from=n,e.l=null,e.d=s?s.d+1:1),0<ve(o,e.to)&&(e.to=o,e.r=null,e.d=e.l?e.l.d+1:1),o=!e.r,c&&!e.l&&Tn(e,c),s&&o&&Tn(e,s)}}function Tn(e,n){Wr(n)||function o(s,b){var l=b.from,h=b.to,g=b.l,b=b.r;An(s,l,h),g&&o(s,g),b&&o(s,b)}(e,n)}function Go(e,n){var o=lr(n),s=o.next();if(s.done)return!1;for(var c=s.value,l=lr(e),h=l.next(c.from),g=h.value;!s.done&&!h.done;){if(ve(g.from,c.to)<=0&&0<=ve(g.to,c.from))return!0;ve(c.from,g.from)<0?c=(s=o.next(g.from)).value:g=(h=l.next(c.from)).value}return!1}function lr(e){var n=Wr(e)?null:{s:0,n:e};return{next:function(o){for(var s=0<arguments.length;n;)switch(n.s){case 0:if(n.s=1,s)for(;n.n.l&&ve(o,n.n.from)<0;)n={up:n,n:n.n.l,s:1};else for(;n.n.l;)n={up:n,n:n.n.l,s:1};case 1:if(n.s=2,!s||ve(o,n.n.to)<=0)return{value:n.n,done:!1};case 2:if(n.n.r){n.s=3,n={up:n,n:n.n.r,s:0};continue}case 3:n=n.up}return{done:!0}}}}function Jo(e){var n,o,s=(((n=e.r)===null||n===void 0?void 0:n.d)||0)-(((o=e.l)===null||o===void 0?void 0:o.d)||0),c=1<s?"r":s<-1?"l":"";c&&(n=c=="r"?"l":"r",o=i({},e),s=e[c],e.from=s.from,e.to=s.to,e[c]=s[c],o[c]=s[n],(e[n]=o).d=Qo(o)),e.d=Qo(e)}function Qo(o){var n=o.r,o=o.l;return(n?o?Math.max(n.d,o.d):n.d:o?o.d:0)+1}function ur(e,n){return p(n).forEach(function(o){e[o]?Tn(e[o],n[o]):e[o]=function s(c){var l,h,g={};for(l in c)R(c,l)&&(h=c[l],g[l]=!h||typeof h!="object"||pe.has(h.constructor)?h:s(h));return g}(n[o])}),e}function Vr(e,n){return e.all||n.all||Object.keys(e).some(function(o){return n[o]&&Go(n[o],e[o])})}M(ze.prototype,((gt={add:function(e){return Tn(this,e),this},addKey:function(e){return An(this,e,e),this},addKeys:function(e){var n=this;return e.forEach(function(o){return An(n,o,o)}),this},hasKey:function(e){var n=lr(this).next(e).value;return n&&ve(n.from,e)<=0&&0<=ve(n.to,e)}})[ut]=function(){return lr(this)},gt));var Qt={},Yr={},Xr=!1;function dr(e){ur(Yr,e),Xr||(Xr=!0,setTimeout(function(){Xr=!1,Gr(Yr,!(Yr={}))},0))}function Gr(e,n){n===void 0&&(n=!1);var o=new Set;if(e.all)for(var s=0,c=Object.values(Qt);s<c.length;s++)Zo(h=c[s],e,o,n);else for(var l in e){var h,g=/^idb\:\/\/(.*)\/(.*)\//.exec(l);g&&(l=g[1],g=g[2],(h=Qt["idb://".concat(l,"/").concat(g)])&&Zo(h,e,o,n))}o.forEach(function(b){return b()})}function Zo(e,n,o,s){for(var c=[],l=0,h=Object.entries(e.queries.query);l<h.length;l++){for(var g=h[l],b=g[0],x=[],N=0,v=g[1];N<v.length;N++){var _=v[N];Vr(n,_.obsSet)?_.subscribers.forEach(function(C){return o.add(C)}):s&&x.push(_)}s&&c.push([b,x])}if(s)for(var w=0,j=c;w<j.length;w++){var k=j[w],b=k[0],x=k[1];e.queries.query[b]=x}}function ks(e){var n=e._state,o=e._deps.indexedDB;if(n.isBeingOpened||e.idbdb)return n.dbReadyPromise.then(function(){return n.dbOpenError?Re(n.dbOpenError):e});n.isBeingOpened=!0,n.dbOpenError=null,n.openComplete=!1;var s=n.openCanceller,c=Math.round(10*e.verno),l=!1;function h(){if(n.openCanceller!==s)throw new ee.DatabaseClosed("db.open() was cancelled")}function g(){return new Z(function(_,w){if(h(),!o)throw new ee.MissingAPI;var j=e.name,k=n.autoSchema||!c?o.open(j):o.open(j,c);if(!k)throw new ee.MissingAPI;k.onerror=Ct(w),k.onblocked=ge(e._fireOnBlocked),k.onupgradeneeded=ge(function(C){var E;N=k.transaction,n.autoSchema&&!e._options.allowEmptyDB?(k.onerror=_n,N.abort(),k.result.close(),(E=o.deleteDatabase(j)).onsuccess=E.onerror=ge(function(){w(new ee.NoSuchDatabase("Database ".concat(j," doesnt exist")))})):(N.onerror=Ct(w),C=C.oldVersion>Math.pow(2,62)?0:C.oldVersion,v=C<1,e.idbdb=k.result,l&&ws(e,N),xs(e,C/10,N,w))},w),k.onsuccess=ge(function(){N=null;var C,E,A,T,L,H=e.idbdb=k.result,G=B(H.objectStoreNames);if(0<G.length)try{var $=H.transaction((T=G).length===1?T[0]:T,"readonly");if(n.autoSchema)E=H,A=$,(C=e).verno=E.version/10,A=C._dbSchema=ir(0,E,A),C._storeNames=B(E.objectStoreNames,0),ar(C,[C._allTables],p(A),A);else if(cr(e,e._dbSchema,$),((L=$r(ir(0,(L=e).idbdb,$),L._dbSchema)).add.length||L.change.some(function(U){return U.add.length||U.change.length}))&&!l)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),H.close(),c=H.version+1,l=!0,_(g());or(e,$)}catch{}ln.push(e),H.onversionchange=ge(function(U){n.vcFired=!0,e.on("versionchange").fire(U)}),H.onclose=ge(function(){e.close({disableAutoOpen:!1})}),v&&(L=e._deps,$=j,H=L.indexedDB,L=L.IDBKeyRange,zr(H)||$===Qn||Hr(H,L).put({name:$}).catch(fe)),_()},w)}).catch(function(_){switch(_==null?void 0:_.name){case"UnknownError":if(0<n.PR1398_maxLoop)return n.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),g();break;case"VersionError":if(0<c)return c=0,g()}return Z.reject(_)})}var b,x=n.dbReadyResolve,N=null,v=!1;return Z.race([s,(typeof navigator>"u"?Z.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(_){function w(){return indexedDB.databases().finally(_)}b=setInterval(w,100),w()}).finally(function(){return clearInterval(b)}):Promise.resolve()).then(g)]).then(function(){return h(),n.onReadyBeingFired=[],Z.resolve(Ur(function(){return e.on.ready.fire(e.vip)})).then(function _(){if(0<n.onReadyBeingFired.length){var w=n.onReadyBeingFired.reduce(ht,fe);return n.onReadyBeingFired=[],Z.resolve(Ur(function(){return w(e.vip)})).then(_)}})}).finally(function(){n.openCanceller===s&&(n.onReadyBeingFired=null,n.isBeingOpened=!1)}).catch(function(_){n.dbOpenError=_;try{N&&N.abort()}catch{}return s===n.openCanceller&&e._close(),Re(_)}).finally(function(){n.openComplete=!0,x()}).then(function(){var _;return v&&(_={},e.tables.forEach(function(w){w.schema.indexes.forEach(function(j){j.name&&(_["idb://".concat(e.name,"/").concat(w.name,"/").concat(j.name)]=new ze(-1/0,[[[]]]))}),_["idb://".concat(e.name,"/").concat(w.name,"/")]=_["idb://".concat(e.name,"/").concat(w.name,"/:dels")]=new ze(-1/0,[[[]]])}),$t(En).fire(_),Gr(_,!0)),e})}function Jr(e){function n(l){return e.next(l)}var o=c(n),s=c(function(l){return e.throw(l)});function c(l){return function(b){var g=l(b),b=g.value;return g.done?b:b&&typeof b.then=="function"?b.then(o,s):m(b)?Promise.all(b).then(o,s):o(b)}}return c(n)()}function fr(e,n,o){for(var s=m(e)?e.slice():[e],c=0;c<o;++c)s.push(n);return s}var Ss={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return i(i({},e),{table:function(n){var o=e.table(n),s=o.schema,c={},l=[];function h(v,_,w){var j=On(v),k=c[j]=c[j]||[],C=v==null?0:typeof v=="string"?1:v.length,E=0<_,E=i(i({},w),{name:E?"".concat(j,"(virtual-from:").concat(w.name,")"):w.name,lowLevelIndex:w,isVirtual:E,keyTail:_,keyLength:C,extractKey:Kr(v),unique:!E&&w.unique});return k.push(E),E.isPrimaryKey||l.push(E),1<C&&h(C===2?v[0]:v.slice(0,C-1),_+1,w),k.sort(function(A,T){return A.keyTail-T.keyTail}),E}n=h(s.primaryKey.keyPath,0,s.primaryKey),c[":id"]=[n];for(var g=0,b=s.indexes;g<b.length;g++){var x=b[g];h(x.keyPath,0,x)}function N(v){var _,w=v.query.index;return w.isVirtual?i(i({},v),{query:{index:w.lowLevelIndex,range:(_=v.query.range,w=w.keyTail,{type:_.type===1?2:_.type,lower:fr(_.lower,_.lowerOpen?e.MAX_KEY:e.MIN_KEY,w),lowerOpen:!0,upper:fr(_.upper,_.upperOpen?e.MIN_KEY:e.MAX_KEY,w),upperOpen:!0})}}):v}return i(i({},o),{schema:i(i({},s),{primaryKey:n,indexes:l,getIndexByKeyPath:function(v){return(v=c[On(v)])&&v[0]}}),count:function(v){return o.count(N(v))},query:function(v){return o.query(N(v))},openCursor:function(v){var _=v.query.index,w=_.keyTail,j=_.isVirtual,k=_.keyLength;return j?o.openCursor(N(v)).then(function(E){return E&&C(E)}):o.openCursor(v);function C(E){return Object.create(E,{continue:{value:function(A){A!=null?E.continue(fr(A,v.reverse?e.MAX_KEY:e.MIN_KEY,w)):v.unique?E.continue(E.key.slice(0,k).concat(v.reverse?e.MIN_KEY:e.MAX_KEY,w)):E.continue()}},continuePrimaryKey:{value:function(A,T){E.continuePrimaryKey(fr(A,e.MAX_KEY,w),T)}},primaryKey:{get:function(){return E.primaryKey}},key:{get:function(){var A=E.key;return k===1?A[0]:A.slice(0,k)}},value:{get:function(){return E.value}}})}}})}})}};function Qr(e,n,o,s){return o=o||{},s=s||"",p(e).forEach(function(c){var l,h,g;R(n,c)?(l=e[c],h=n[c],typeof l=="object"&&typeof h=="object"&&l&&h?(g=rt(l))!==rt(h)?o[s+c]=n[c]:g==="Object"?Qr(l,h,o,s+c+"."):l!==h&&(o[s+c]=n[c]):l!==h&&(o[s+c]=n[c])):o[s+c]=void 0}),p(n).forEach(function(c){R(e,c)||(o[s+c]=n[c])}),o}function Zr(e,n){return n.type==="delete"?n.keys:n.keys||n.values.map(e.extractKey)}var Ds={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return i(i({},e),{table:function(n){var o=e.table(n),s=o.schema.primaryKey;return i(i({},o),{mutate:function(c){var l=re.trans,h=l.table(n).hook,g=h.deleting,b=h.creating,x=h.updating;switch(c.type){case"add":if(b.fire===fe)break;return l._promise("readwrite",function(){return N(c)},!0);case"put":if(b.fire===fe&&x.fire===fe)break;return l._promise("readwrite",function(){return N(c)},!0);case"delete":if(g.fire===fe)break;return l._promise("readwrite",function(){return N(c)},!0);case"deleteRange":if(g.fire===fe)break;return l._promise("readwrite",function(){return function v(_,w,j){return o.query({trans:_,values:!1,query:{index:s,range:w},limit:j}).then(function(k){var C=k.result;return N({type:"delete",keys:C,trans:_}).then(function(E){return 0<E.numFailures?Promise.reject(E.failures[0]):C.length<j?{failures:[],numFailures:0,lastResult:void 0}:v(_,i(i({},w),{lower:C[C.length-1],lowerOpen:!0}),j)})})}(c.trans,c.range,1e4)},!0)}return o.mutate(c);function N(v){var _,w,j,k=re.trans,C=v.keys||Zr(s,v);if(!C)throw new Error("Keys missing");return(v=v.type==="add"||v.type==="put"?i(i({},v),{keys:C}):i({},v)).type!=="delete"&&(v.values=d([],v.values)),v.keys&&(v.keys=d([],v.keys)),_=o,j=C,((w=v).type==="add"?Promise.resolve([]):_.getMany({trans:w.trans,keys:j,cache:"immutable"})).then(function(E){var A=C.map(function(T,L){var H,G,$,U=E[L],J={onerror:null,onsuccess:null};return v.type==="delete"?g.fire.call(J,T,U,k):v.type==="add"||U===void 0?(H=b.fire.call(J,T,v.values[L],k),T==null&&H!=null&&(v.keys[L]=T=H,s.outbound||W(v.values[L],s.keyPath,T))):(H=Qr(U,v.values[L]),(G=x.fire.call(J,H,T,U,k))&&($=v.values[L],Object.keys(G).forEach(function(V){R($,V)?$[V]=G[V]:W($,V,G[V])}))),J});return o.mutate(v).then(function(T){for(var L=T.failures,H=T.results,G=T.numFailures,T=T.lastResult,$=0;$<C.length;++$){var U=(H||C)[$],J=A[$];U==null?J.onerror&&J.onerror(L[$]):J.onsuccess&&J.onsuccess(v.type==="put"&&E[$]?v.values[$]:U)}return{failures:L,results:H,numFailures:G,lastResult:T}}).catch(function(T){return A.forEach(function(L){return L.onerror&&L.onerror(T)}),Promise.reject(T)})})}}})}})}};function ea(e,n,o){try{if(!n||n.keys.length<e.length)return null;for(var s=[],c=0,l=0;c<n.keys.length&&l<e.length;++c)ve(n.keys[c],e[l])===0&&(s.push(o?Se(n.values[c]):n.values[c]),++l);return s.length===e.length?s:null}catch{return null}}var Ns={stack:"dbcore",level:-1,create:function(e){return{table:function(n){var o=e.table(n);return i(i({},o),{getMany:function(s){if(!s.cache)return o.getMany(s);var c=ea(s.keys,s.trans._cache,s.cache==="clone");return c?Z.resolve(c):o.getMany(s).then(function(l){return s.trans._cache={keys:s.keys,values:s.cache==="clone"?Se(l):l},l})},mutate:function(s){return s.type!=="add"&&(s.trans._cache=null),o.mutate(s)}})}}}};function ta(e,n){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!n.schema.primaryKey.outbound}function na(e,n){switch(e){case"query":return n.values&&!n.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Cs={stack:"dbcore",level:0,name:"Observability",create:function(e){var n=e.schema.name,o=new ze(e.MIN_KEY,e.MAX_KEY);return i(i({},e),{transaction:function(s,c,l){if(re.subscr&&c!=="readonly")throw new ee.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(re.querier));return e.transaction(s,c,l)},table:function(s){var c=e.table(s),l=c.schema,h=l.primaryKey,v=l.indexes,g=h.extractKey,b=h.outbound,x=h.autoIncrement&&v.filter(function(w){return w.compound&&w.keyPath.includes(h.keyPath)}),N=i(i({},c),{mutate:function(w){function j(V){return V="idb://".concat(n,"/").concat(s,"/").concat(V),T[V]||(T[V]=new ze)}var k,C,E,A=w.trans,T=w.mutatedParts||(w.mutatedParts={}),L=j(""),H=j(":dels"),G=w.type,J=w.type==="deleteRange"?[w.range]:w.type==="delete"?[w.keys]:w.values.length<50?[Zr(h,w).filter(function(V){return V}),w.values]:[],$=J[0],U=J[1],J=w.trans._cache;return m($)?(L.addKeys($),(J=G==="delete"||$.length===U.length?ea($,J):null)||H.addKeys($),(J||U)&&(k=j,C=J,E=U,l.indexes.forEach(function(V){var te=k(V.name||"");function ce(he){return he!=null?V.extractKey(he):null}function ue(he){return V.multiEntry&&m(he)?he.forEach(function(lt){return te.addKey(lt)}):te.addKey(he)}(C||E).forEach(function(he,Ue){var ie=C&&ce(C[Ue]),Ue=E&&ce(E[Ue]);ve(ie,Ue)!==0&&(ie!=null&&ue(ie),Ue!=null&&ue(Ue))})}))):$?(U={from:(U=$.lower)!==null&&U!==void 0?U:e.MIN_KEY,to:(U=$.upper)!==null&&U!==void 0?U:e.MAX_KEY},H.add(U),L.add(U)):(L.add(o),H.add(o),l.indexes.forEach(function(V){return j(V.name).add(o)})),c.mutate(w).then(function(V){return!$||w.type!=="add"&&w.type!=="put"||(L.addKeys(V.results),x&&x.forEach(function(te){for(var ce=w.values.map(function(ie){return te.extractKey(ie)}),ue=te.keyPath.findIndex(function(ie){return ie===h.keyPath}),he=0,lt=V.results.length;he<lt;++he)ce[he][ue]=V.results[he];j(te.name).addKeys(ce)})),A.mutatedParts=ur(A.mutatedParts||{},T),V})}}),v=function(j){var k=j.query,j=k.index,k=k.range;return[j,new ze((j=k.lower)!==null&&j!==void 0?j:e.MIN_KEY,(k=k.upper)!==null&&k!==void 0?k:e.MAX_KEY)]},_={get:function(w){return[h,new ze(w.key)]},getMany:function(w){return[h,new ze().addKeys(w.keys)]},count:v,query:v,openCursor:v};return p(_).forEach(function(w){N[w]=function(j){var k=re.subscr,C=!!k,E=ta(re,c)&&na(w,j)?j.obsSet={}:k;if(C){var A=function(U){return U="idb://".concat(n,"/").concat(s,"/").concat(U),E[U]||(E[U]=new ze)},T=A(""),L=A(":dels"),k=_[w](j),C=k[0],k=k[1];if((w==="query"&&C.isPrimaryKey&&!j.values?L:A(C.name||"")).add(k),!C.isPrimaryKey){if(w!=="count"){var H=w==="query"&&b&&j.values&&c.query(i(i({},j),{values:!1}));return c[w].apply(this,arguments).then(function(U){if(w==="query"){if(b&&j.values)return H.then(function(ce){return ce=ce.result,T.addKeys(ce),U});var J=j.values?U.result.map(g):U.result;(j.values?T:L).addKeys(J)}else if(w==="openCursor"){var V=U,te=j.values;return V&&Object.create(V,{key:{get:function(){return L.addKey(V.primaryKey),V.key}},primaryKey:{get:function(){var ce=V.primaryKey;return L.addKey(ce),ce}},value:{get:function(){return te&&T.addKey(V.primaryKey),V.value}}})}return U})}L.add(o)}}return c[w].apply(this,arguments)}}),N}})}};function ra(e,n,o){if(o.numFailures===0)return n;if(n.type==="deleteRange")return null;var s=n.keys?n.keys.length:"values"in n&&n.values?n.values.length:1;return o.numFailures===s?null:(n=i({},n),m(n.keys)&&(n.keys=n.keys.filter(function(c,l){return!(l in o.failures)})),"values"in n&&m(n.values)&&(n.values=n.values.filter(function(c,l){return!(l in o.failures)})),n)}function eo(e,n){return o=e,((s=n).lower===void 0||(s.lowerOpen?0<ve(o,s.lower):0<=ve(o,s.lower)))&&(e=e,(n=n).upper===void 0||(n.upperOpen?ve(e,n.upper)<0:ve(e,n.upper)<=0));var o,s}function oa(e,n,_,s,c,l){if(!_||_.length===0)return e;var h=n.query.index,g=h.multiEntry,b=n.query.range,x=s.schema.primaryKey.extractKey,N=h.extractKey,v=(h.lowLevelIndex||h).extractKey,_=_.reduce(function(w,j){var k=w,C=[];if(j.type==="add"||j.type==="put")for(var E=new ze,A=j.values.length-1;0<=A;--A){var T,L=j.values[A],H=x(L);E.hasKey(H)||(T=N(L),(g&&m(T)?T.some(function(V){return eo(V,b)}):eo(T,b))&&(E.addKey(H),C.push(L)))}switch(j.type){case"add":var G=new ze().addKeys(n.values?w.map(function(te){return x(te)}):w),k=w.concat(n.values?C.filter(function(te){return te=x(te),!G.hasKey(te)&&(G.addKey(te),!0)}):C.map(function(te){return x(te)}).filter(function(te){return!G.hasKey(te)&&(G.addKey(te),!0)}));break;case"put":var $=new ze().addKeys(j.values.map(function(te){return x(te)}));k=w.filter(function(te){return!$.hasKey(n.values?x(te):te)}).concat(n.values?C:C.map(function(te){return x(te)}));break;case"delete":var U=new ze().addKeys(j.keys);k=w.filter(function(te){return!U.hasKey(n.values?x(te):te)});break;case"deleteRange":var J=j.range;k=w.filter(function(te){return!eo(x(te),J)})}return k},e);return _===e?e:(_.sort(function(w,j){return ve(v(w),v(j))||ve(x(w),x(j))}),n.limit&&n.limit<1/0&&(_.length>n.limit?_.length=n.limit:e.length===n.limit&&_.length<n.limit&&(c.dirty=!0)),l?Object.freeze(_):_)}function aa(e,n){return ve(e.lower,n.lower)===0&&ve(e.upper,n.upper)===0&&!!e.lowerOpen==!!n.lowerOpen&&!!e.upperOpen==!!n.upperOpen}function _s(e,n){return function(o,s,c,l){if(o===void 0)return s!==void 0?-1:0;if(s===void 0)return 1;if((s=ve(o,s))===0){if(c&&l)return 0;if(c)return 1;if(l)return-1}return s}(e.lower,n.lower,e.lowerOpen,n.lowerOpen)<=0&&0<=function(o,s,c,l){if(o===void 0)return s!==void 0?1:0;if(s===void 0)return-1;if((s=ve(o,s))===0){if(c&&l)return 0;if(c)return-1;if(l)return 1}return s}(e.upper,n.upper,e.upperOpen,n.upperOpen)}function Es(e,n,o,s){e.subscribers.add(o),s.addEventListener("abort",function(){var c,l;e.subscribers.delete(o),e.subscribers.size===0&&(c=e,l=n,setTimeout(function(){c.subscribers.size===0&&Je(l,c)},3e3))})}var Rs={stack:"dbcore",level:0,name:"Cache",create:function(e){var n=e.schema.name;return i(i({},e),{transaction:function(o,s,c){var l,h,g=e.transaction(o,s,c);return s==="readwrite"&&(h=(l=new AbortController).signal,c=function(b){return function(){if(l.abort(),s==="readwrite"){for(var x=new Set,N=0,v=o;N<v.length;N++){var _=v[N],w=Qt["idb://".concat(n,"/").concat(_)];if(w){var j=e.table(_),k=w.optimisticOps.filter(function(te){return te.trans===g});if(g._explicit&&b&&g.mutatedParts)for(var C=0,E=Object.values(w.queries.query);C<E.length;C++)for(var A=0,T=(G=E[C]).slice();A<T.length;A++)Vr(($=T[A]).obsSet,g.mutatedParts)&&(Je(G,$),$.subscribers.forEach(function(te){return x.add(te)}));else if(0<k.length){w.optimisticOps=w.optimisticOps.filter(function(te){return te.trans!==g});for(var L=0,H=Object.values(w.queries.query);L<H.length;L++)for(var G,$,U,J=0,V=(G=H[L]).slice();J<V.length;J++)($=V[J]).res!=null&&g.mutatedParts&&(b&&!$.dirty?(U=Object.isFrozen($.res),U=oa($.res,$.req,k,j,$,U),$.dirty?(Je(G,$),$.subscribers.forEach(function(te){return x.add(te)})):U!==$.res&&($.res=U,$.promise=Z.resolve({result:U}))):($.dirty&&Je(G,$),$.subscribers.forEach(function(te){return x.add(te)})))}}}x.forEach(function(te){return te()})}}},g.addEventListener("abort",c(!1),{signal:h}),g.addEventListener("error",c(!1),{signal:h}),g.addEventListener("complete",c(!0),{signal:h})),g},table:function(o){var s=e.table(o),c=s.schema.primaryKey;return i(i({},s),{mutate:function(l){var h=re.trans;if(c.outbound||h.db._options.cache==="disabled"||h.explicit||h.idbtrans.mode!=="readwrite")return s.mutate(l);var g=Qt["idb://".concat(n,"/").concat(o)];return g?(h=s.mutate(l),l.type!=="add"&&l.type!=="put"||!(50<=l.values.length||Zr(c,l).some(function(b){return b==null}))?(g.optimisticOps.push(l),l.mutatedParts&&dr(l.mutatedParts),h.then(function(b){0<b.numFailures&&(Je(g.optimisticOps,l),(b=ra(0,l,b))&&g.optimisticOps.push(b),l.mutatedParts&&dr(l.mutatedParts))}),h.catch(function(){Je(g.optimisticOps,l),l.mutatedParts&&dr(l.mutatedParts)})):h.then(function(b){var x=ra(0,i(i({},l),{values:l.values.map(function(N,v){var _;return b.failures[v]?N:(N=(_=c.keyPath)!==null&&_!==void 0&&_.includes(".")?Se(N):i({},N),W(N,c.keyPath,b.results[v]),N)})}),b);g.optimisticOps.push(x),queueMicrotask(function(){return l.mutatedParts&&dr(l.mutatedParts)})}),h):s.mutate(l)},query:function(l){if(!ta(re,s)||!na("query",l))return s.query(l);var h=((x=re.trans)===null||x===void 0?void 0:x.db._options.cache)==="immutable",v=re,g=v.requery,b=v.signal,x=function(j,k,C,E){var A=Qt["idb://".concat(j,"/").concat(k)];if(!A)return[];if(!(k=A.queries[C]))return[null,!1,A,null];var T=k[(E.query?E.query.index.name:null)||""];if(!T)return[null,!1,A,null];switch(C){case"query":var L=T.find(function(H){return H.req.limit===E.limit&&H.req.values===E.values&&aa(H.req.query.range,E.query.range)});return L?[L,!0,A,T]:[T.find(function(H){return("limit"in H.req?H.req.limit:1/0)>=E.limit&&(!E.values||H.req.values)&&_s(H.req.query.range,E.query.range)}),!1,A,T];case"count":return L=T.find(function(H){return aa(H.req.query.range,E.query.range)}),[L,!!L,A,T]}}(n,o,"query",l),N=x[0],v=x[1],_=x[2],w=x[3];return N&&v?N.obsSet=l.obsSet:(v=s.query(l).then(function(j){var k=j.result;if(N&&(N.res=k),h){for(var C=0,E=k.length;C<E;++C)Object.freeze(k[C]);Object.freeze(k)}else j.result=Se(k);return j}).catch(function(j){return w&&N&&Je(w,N),Promise.reject(j)}),N={obsSet:l.obsSet,promise:v,subscribers:new Set,type:"query",req:l,dirty:!1},w?w.push(N):(w=[N],(_=_||(Qt["idb://".concat(n,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[l.query.index.name||""]=w)),Es(N,w,g,b),N.promise.then(function(j){return{result:oa(j.result,l,_==null?void 0:_.optimisticOps,s,N,h)}})}})}})}};function hr(e,n){return new Proxy(e,{get:function(o,s,c){return s==="db"?n:Reflect.get(o,s,c)}})}var Tt=(Oe.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ee.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ee.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,o=n.filter(function(s){return s._cfg.version===e})[0];return o||(o=new this.Version(e),n.push(o),n.sort(bs),o.stores({}),this._state.autoSchema=!1,o)},Oe.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||re.letThrough||this._vip)?e():new Z(function(o,s){if(n._state.openComplete)return s(new ee.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen)return void s(new ee.DatabaseClosed);n.open().catch(fe)}n._state.dbReadyPromise.then(o,s)}).then(e)},Oe.prototype.use=function(e){var n=e.stack,o=e.create,s=e.level,c=e.name;return c&&this.unuse({stack:n,name:c}),e=this._middlewares[n]||(this._middlewares[n]=[]),e.push({stack:n,create:o,level:s??10,name:c}),e.sort(function(l,h){return l.level-h.level}),this},Oe.prototype.unuse=function(e){var n=e.stack,o=e.name,s=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(c){return s?c.create!==s:!!o&&c.name!==o})),this},Oe.prototype.open=function(){var e=this;return Xt(pt,function(){return ks(e)})},Oe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,n=ln.indexOf(this);if(0<=n&&ln.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Z(function(o){e.dbReadyResolve=o}),e.openCanceller=new Z(function(o,s){e.cancelOpen=s}))},Oe.prototype.close=function(o){var n=(o===void 0?{disableAutoOpen:!0}:o).disableAutoOpen,o=this._state;n?(o.isBeingOpened&&o.cancelOpen(new ee.DatabaseClosed),this._close(),o.autoOpen=!1,o.dbOpenError=new ee.DatabaseClosed):(this._close(),o.autoOpen=this._options.autoOpen||o.isBeingOpened,o.openComplete=!1,o.dbOpenError=null)},Oe.prototype.delete=function(e){var n=this;e===void 0&&(e={disableAutoOpen:!0});var o=0<arguments.length&&typeof arguments[0]!="object",s=this._state;return new Z(function(c,l){function h(){n.close(e);var g=n._deps.indexedDB.deleteDatabase(n.name);g.onsuccess=ge(function(){var b,x,N;b=n._deps,x=n.name,N=b.indexedDB,b=b.IDBKeyRange,zr(N)||x===Qn||Hr(N,b).delete(x).catch(fe),c()}),g.onerror=Ct(l),g.onblocked=n._fireOnBlocked}if(o)throw new ee.InvalidArgument("Invalid closeOptions argument to db.delete()");s.isBeingOpened?s.dbReadyPromise.then(h):h()})},Oe.prototype.backendDB=function(){return this.idbdb},Oe.prototype.isOpen=function(){return this.idbdb!==null},Oe.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Oe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Oe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Oe.prototype,"tables",{get:function(){var e=this;return p(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),Oe.prototype.transaction=function(){var e=(function(n,o,s){var c=arguments.length;if(c<2)throw new ee.InvalidArgument("Too few arguments");for(var l=new Array(c-1);--c;)l[c-1]=arguments[c];return s=l.pop(),[n,le(l),s]}).apply(this,arguments);return this._transaction.apply(this,e)},Oe.prototype._transaction=function(e,n,o){var s=this,c=re.trans;c&&c.db===this&&e.indexOf("!")===-1||(c=null);var l,h,g=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(h=n.map(function(x){if(x=x instanceof s.Table?x.name:x,typeof x!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return x}),e=="r"||e===Ar)l=Ar;else{if(e!="rw"&&e!=Tr)throw new ee.InvalidArgument("Invalid transaction mode: "+e);l=Tr}if(c){if(c.mode===Ar&&l===Tr){if(!g)throw new ee.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c=null}c&&h.forEach(function(x){if(c&&c.storeNames.indexOf(x)===-1){if(!g)throw new ee.SubTransaction("Table "+x+" not included in parent transaction.");c=null}}),g&&c&&!c.active&&(c=null)}}catch(x){return c?c._promise(null,function(N,v){v(x)}):Re(x)}var b=(function x(N,v,_,w,j){return Z.resolve().then(function(){var k=re.transless||re,C=N._createTransaction(v,_,N._dbSchema,w);if(C.explicit=!0,k={trans:C,transless:k},w)C.idbtrans=w.idbtrans;else try{C.create(),C.idbtrans._explicit=!0,N._state.PR1398_maxLoop=3}catch(T){return T.name===Fe.InvalidState&&N.isOpen()&&0<--N._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),N.close({disableAutoOpen:!1}),N.open().then(function(){return x(N,v,_,null,j)})):Re(T)}var E,A=Ce(j);return A&&cn(),k=Z.follow(function(){var T;(E=j.call(C,C))&&(A?(T=Bt.bind(null,null),E.then(T,T)):typeof E.next=="function"&&typeof E.throw=="function"&&(E=Jr(E)))},k),(E&&typeof E.then=="function"?Z.resolve(E).then(function(T){return C.active?T:Re(new ee.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):k.then(function(){return E})).then(function(T){return w&&C._resolve(),C._completion.then(function(){return T})}).catch(function(T){return C._reject(T),Re(T)})})}).bind(null,this,l,h,c,o);return c?c._promise(l,b,"lock"):re.trans?Xt(re.transless,function(){return s._whenReady(b)}):this._whenReady(b)},Oe.prototype.table=function(e){if(!R(this._allTables,e))throw new ee.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Oe);function Oe(e,n){var o=this;this._middlewares={},this.verno=0;var s=Oe.dependencies;this._options=n=i({addons:Oe.addons,autoOpen:!0,indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange},s=n.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var c,l,h,g,b,x={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:fe,dbReadyPromise:null,cancelOpen:fe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};x.dbReadyPromise=new Z(function(v){x.dbReadyResolve=v}),x.openCanceller=new Z(function(v,_){x.cancelOpen=_}),this._state=x,this.name=e,this.on=Nn(this,"populate","blocked","versionchange","close",{ready:[ht,fe]}),this.once=function(v,_){var w=function(){for(var j=[],k=0;k<arguments.length;k++)j[k]=arguments[k];o.on(v).unsubscribe(w),_.apply(o,j)};return o.on(v,w)},this.on.ready.subscribe=K(this.on.ready.subscribe,function(v){return function(_,w){Oe.vip(function(){var j,k=o._state;k.openComplete?(k.dbOpenError||Z.resolve().then(_),w&&v(_)):k.onReadyBeingFired?(k.onReadyBeingFired.push(_),w&&v(_)):(v(_),j=o,w||v(function C(){j.on.ready.unsubscribe(_),j.on.ready.unsubscribe(C)}))})}}),this.Collection=(c=this,Cn(fs.prototype,function(E,C){this.db=c;var w=Io,j=null;if(C)try{w=C()}catch(A){j=A}var k=E._ctx,C=k.table,E=C.hook.reading.fire;this._ctx={table:C,index:k.index,isPrimKey:!k.index||C.schema.primKey.keyPath&&k.index===C.schema.primKey.name,range:w,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:j,or:k.or,valueMapper:E!==ft?E:null}})),this.Table=(l=this,Cn(Fo.prototype,function(v,_,w){this.db=l,this._tx=w,this.name=v,this.schema=_,this.hook=l._allTables[v]?l._allTables[v].hook:Nn(null,{creating:[Pt,fe],reading:[bt,ft],updating:[Gn,fe],deleting:[Xn,fe]})})),this.Transaction=(h=this,Cn(ms.prototype,function(v,_,w,j,k){var C=this;v!=="readonly"&&_.forEach(function(E){E=(E=w[E])===null||E===void 0?void 0:E.yProps,E&&(_=_.concat(E.map(function(A){return A.updatesTable})))}),this.db=h,this.mode=v,this.storeNames=_,this.schema=w,this.chromeTransactionDurability=j,this.idbtrans=null,this.on=Nn(this,"complete","error","abort"),this.parent=k||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Z(function(E,A){C._resolve=E,C._reject=A}),this._completion.then(function(){C.active=!1,C.on.complete.fire()},function(E){var A=C.active;return C.active=!1,C.on.error.fire(E),C.parent?C.parent._reject(E):A&&C.idbtrans&&C.idbtrans.abort(),Re(E)})})),this.Version=(g=this,Cn(js.prototype,function(v){this.db=g,this._cfg={version:v,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(b=this,Cn(Uo.prototype,function(v,_,w){if(this.db=b,this._ctx={table:v,index:_===":id"?null:_,or:w},this._cmp=this._ascending=ve,this._descending=function(j,k){return ve(k,j)},this._max=function(j,k){return 0<ve(j,k)?j:k},this._min=function(j,k){return ve(j,k)<0?j:k},this._IDBKeyRange=b._deps.IDBKeyRange,!this._IDBKeyRange)throw new ee.MissingAPI})),this.on("versionchange",function(v){0<v.newVersion?console.warn("Another connection wants to upgrade database '".concat(o.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(o.name,"'. Closing db now to resume the delete request.")),o.close({disableAutoOpen:!1})}),this.on("blocked",function(v){!v.newVersion||v.newVersion<v.oldVersion?console.warn("Dexie.delete('".concat(o.name,"') was blocked")):console.warn("Upgrade '".concat(o.name,"' blocked by other connection holding version ").concat(v.oldVersion/10))}),this._maxKey=Rn(n.IDBKeyRange),this._createTransaction=function(v,_,w,j){return new o.Transaction(v,_,w,o._options.chromeTransactionDurability,j)},this._fireOnBlocked=function(v){o.on("blocked").fire(v),ln.filter(function(_){return _.name===o.name&&_!==o&&!_._state.vcFired}).map(function(_){return _.on("versionchange").fire(v)})},this.use(Ns),this.use(Rs),this.use(Cs),this.use(Ss),this.use(Ds);var N=new Proxy(this,{get:function(v,_,w){if(_==="_vip")return!0;if(_==="table")return function(k){return hr(o.table(k),N)};var j=Reflect.get(v,_,w);return j instanceof Fo?hr(j,N):_==="tables"?j.map(function(k){return hr(k,N)}):_==="_createTransaction"?function(){return hr(j.apply(this,arguments),N)}:j}});this.vip=N,s.forEach(function(v){return v(o)})}var pr,gt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Os=(to.prototype.subscribe=function(e,n,o){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:o})},to.prototype[gt]=function(){return this},to);function to(e){this._subscribe=e}try{pr={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{pr={indexedDB:null,IDBKeyRange:null}}function sa(e){var n,o=!1,s=new Os(function(c){var l=Ce(e),h,g=!1,b={},x={},N={get closed(){return g},unsubscribe:function(){g||(g=!0,h&&h.abort(),v&&$t.storagemutated.unsubscribe(w))}};c.start&&c.start(N);var v=!1,_=function(){return Or(j)},w=function(k){ur(b,k),Vr(x,b)&&_()},j=function(){var k,C,E;!g&&pr.indexedDB&&(b={},k={},h&&h.abort(),h=new AbortController,E=function(A){var T=qe();try{l&&cn();var L=Lt(e,A);return L=l?L.finally(Bt):L}finally{T&&at()}}(C={subscr:k,signal:h.signal,requery:_,querier:e,trans:null}),Promise.resolve(E).then(function(A){o=!0,n=A,g||C.signal.aborted||(b={},function(T){for(var L in T)if(R(T,L))return;return 1}(x=k)||v||($t(En,w),v=!0),Or(function(){return!g&&c.next&&c.next(A)}))},function(A){o=!1,["DatabaseClosedError","AbortError"].includes(A==null?void 0:A.name)||g||Or(function(){g||c.error&&c.error(A)})}))};return setTimeout(_,0),N});return s.hasValue=function(){return o},s.getValue=function(){return n},s}var Zt=Tt;function no(e){var n=qt;try{qt=!0,$t.storagemutated.fire(e),Gr(e,!0)}finally{qt=n}}M(Zt,i(i({},dt),{delete:function(e){return new Zt(e,{addons:[]}).delete()},exists:function(e){return new Zt(e,{addons:[]}).open().then(function(n){return n.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return n=Zt.dependencies,o=n.indexedDB,n=n.IDBKeyRange,(zr(o)?Promise.resolve(o.databases()).then(function(s){return s.map(function(c){return c.name}).filter(function(c){return c!==Qn})}):Hr(o,n).toCollection().primaryKeys()).then(e)}catch{return Re(new ee.MissingAPI)}var n,o},defineClass:function(){return function(e){S(this,e)}},ignoreTransaction:function(e){return re.trans?Xt(re.transless,e):e()},vip:Ur,async:function(e){return function(){try{var n=Jr(e.apply(this,arguments));return n&&typeof n.then=="function"?n:Z.resolve(n)}catch(o){return Re(o)}}},spawn:function(e,n,o){try{var s=Jr(e.apply(o,n||[]));return s&&typeof s.then=="function"?s:Z.resolve(s)}catch(c){return Re(c)}},currentTransaction:{get:function(){return re.trans||null}},waitFor:function(e,n){return n=Z.resolve(typeof e=="function"?Zt.ignoreTransaction(e):e).timeout(n||6e4),re.trans?re.trans.waitFor(n):n},Promise:Z,debug:{get:function(){return Ve},set:function(e){Ut(e)}},derive:I,extend:S,props:M,override:K,Events:Nn,on:$t,liveQuery:sa,extendObservabilitySet:ur,getByKeyPath:P,setByKeyPath:W,delByKeyPath:function(e,n){typeof n=="string"?W(e,n,void 0):"length"in n&&[].map.call(n,function(o){W(e,o,void 0)})},shallowClone:Q,deepClone:Se,getObjectDiff:Qr,cmp:ve,asap:X,minKey:-1/0,addons:[],connections:ln,errnames:Fe,dependencies:pr,cache:Qt,semVer:"4.2.1",version:"4.2.1".split(".").map(function(e){return parseInt(e)}).reduce(function(e,n,o){return e+n/Math.pow(10,2*o)})})),Zt.maxKey=Rn(Zt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&($t(En,function(e){qt||(e=new CustomEvent(Mr,{detail:e}),qt=!0,dispatchEvent(e),qt=!1)}),addEventListener(Mr,function(e){e=e.detail,qt||no(e)}));var hn,qt=!1,ia=function(){};return typeof BroadcastChannel<"u"&&((ia=function(){(hn=new BroadcastChannel(Mr)).onmessage=function(e){return e.data&&no(e.data)}})(),typeof hn.unref=="function"&&hn.unref(),$t(En,function(e){qt||hn.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Tt.disableBfCache&&e.persisted){Ve&&console.debug("Dexie: handling persisted pagehide"),hn!=null&&hn.close();for(var n=0,o=ln;n<o.length;n++)o[n].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Tt.disableBfCache&&e.persisted&&(Ve&&console.debug("Dexie: handling persisted pageshow"),ia(),no({all:new ze(-1/0,[[]])}))})),Z.rejectionMapper=function(e,n){return!e||e instanceof ke||e instanceof TypeError||e instanceof SyntaxError||!e.name||!me[e.name]?e:(n=new me[e.name](n||e.message,e),"stack"in e&&q(n,"stack",{get:function(){return this.inner.stack}}),n)},Ut(Ve),i(Tt,Object.freeze({__proto__:null,Dexie:Tt,liveQuery:sa,Entity:Po,cmp:ve,PropModification:Dn,replacePrefix:function(e,n){return new Dn({replacePrefix:[e,n]})},add:function(e){return new Dn({add:e})},remove:function(e){return new Dn({remove:e})},default:Tt,RangeSet:ze,mergeRanges:Tn,rangesOverlap:Go}),{default:Tt}),Tt})})(La);var ci=La.exports;const fo=Ms(ci),pa=Symbol.for("Dexie"),xr=globalThis[pa]||(globalThis[pa]=fo);if(fo.semVer!==xr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${fo.semVer} and ${xr.semVer}`);const{liveQuery:Fl,mergeRanges:$l,rangesOverlap:ql,RangeSet:Hl,cmp:zl,Entity:Ul,PropModification:Wl,replacePrefix:Vl,add:Yl,remove:Xl,DexieYProvider:Gl}=xr;class li extends xr{constructor(){super("HabitGridDB");oo(this,"habits");oo(this,"logs");this.version(1).stores({habits:"id, sortOrder, archivedAt, startDate",logs:"id, [habitId+date], habitId, date, status"})}}const oe=new li;function Ba(){return crypto.randomUUID()}function nn(){return new Date().toISOString()}const Et={async getAll(t=!1){let r=oe.habits.orderBy("sortOrder");return t||(r=r.filter(a=>a.archivedAt===null)),r.toArray()},async getById(t){return oe.habits.get(t)},async create(t){const r=await oe.habits.orderBy("sortOrder").last(),a=((r==null?void 0:r.sortOrder)??-1)+1,i=nn(),d={id:Ba(),...t,createdAt:i,updatedAt:i,sortOrder:a};return await oe.habits.add(d),d},async update(t,r){const a=await oe.habits.get(t);if(!a)return;const i={...a,...r,updatedAt:nn()};return await oe.habits.put(i),i},async archive(t){return await oe.habits.get(t)?(await oe.habits.update(t,{archivedAt:nn(),updatedAt:nn()}),!0):!1},async unarchive(t){return await oe.habits.get(t)?(await oe.habits.update(t,{archivedAt:null,updatedAt:nn()}),!0):!1},async delete(t){return await oe.habits.get(t)?(await oe.transaction("rw",[oe.habits,oe.logs],async()=>{await oe.logs.where("habitId").equals(t).delete(),await oe.habits.delete(t)}),!0):!1},async reorder(t){const r=nn();await oe.transaction("rw",oe.habits,async()=>{for(const{id:a,sortOrder:i}of t)await oe.habits.update(a,{sortOrder:i,updatedAt:r})})},async count(t=!1){return t?oe.habits.count():oe.habits.filter(r=>r.archivedAt===null).count()},async clear(){await oe.habits.clear()},async bulkCreate(t){await oe.habits.bulkAdd(t)}},It={async getByHabitAndDate(t,r){return oe.logs.where("[habitId+date]").equals([t,r]).first()},async getByDate(t){return oe.logs.where("date").equals(t).toArray()},async getByHabit(t){return oe.logs.where("habitId").equals(t).toArray()},async getByDateRange(t,r){return oe.logs.where("date").between(t,r,!0,!0).toArray()},async getByHabitAndDateRange(t,r,a){return oe.logs.where("habitId").equals(t).and(i=>i.date>=r&&i.date<=a).toArray()},async upsert(t){const r=await this.getByHabitAndDate(t.habitId,t.date),a=nn();if(r){const d={...r,status:t.status,updatedAt:a};return await oe.logs.put(d),d}const i={id:Ba(),...t,createdAt:a,updatedAt:a};return await oe.logs.add(i),i},async toggleComplete(t,r){const a=await this.getByHabitAndDate(t,r);return a?a.status==="completed"?(await this.delete(a.id),null):(await this.delete(a.id),null):this.upsert({habitId:t,date:r,status:"completed"})},async toggleSkip(t,r){const a=await this.getByHabitAndDate(t,r);return a?a.status==="skipped"?(await this.delete(a.id),null):a:this.upsert({habitId:t,date:r,status:"skipped"})},async delete(t){return await oe.logs.get(t)?(await oe.logs.delete(t),!0):!1},async deleteByHabitAndDate(t,r){return await oe.logs.where("[habitId+date]").equals([t,r]).delete()>0},async count(){return oe.logs.count()},async clear(){await oe.logs.clear()},async bulkCreate(t){await oe.logs.bulkAdd(t)},async getLogsMap(t,r,a){const i=await oe.logs.where("date").between(r,a,!0,!0).and(f=>t.includes(f.habitId)).toArray(),d=new Map;for(const f of i)d.has(f.habitId)||d.set(f.habitId,new Map),d.get(f.habitId).set(f.date,f);return d}};async function ui(){const[t,r,a]=await Promise.all([Et.count(!1),It.count(),oe.habits.filter(i=>i.archivedAt!==null).count()]);return{habitCount:t,logCount:r,archivedHabitCount:a}}function Mn(t,r){return`${t}:${r}`}function di(){const[t,r]=y.useState([]),[a,i]=y.useState([]),[d,f]=y.useState(new Map),[p,m]=y.useState(!0),[S,D]=y.useState(null),O=y.useRef(null),R=y.useCallback(async()=>{try{const B=await Et.getAll(!1);r(B);const K=Zs();return i(K),{habits:B,dates:K}}catch(B){return console.error("Failed to load habits:",B),D("Failed to load habits"),null}},[]),M=y.useCallback(async(B,K,Y)=>{if(B.length!==0)try{const X=await It.getByDateRange(K,Y);f(P=>{const W=new Map(P);for(const Q of X)W.set(Mn(Q.habitId,Q.date),Q);return W}),O.current={start:K,end:Y}}catch(X){console.error("Failed to load logs:",X)}},[]);y.useEffect(()=>{(async()=>{m(!0);const K=await R();if(K){const{habits:Y,dates:X}=K;X.length>0&&await M(Y,X[0],X[X.length-1])}m(!1)})()},[R,M]);const F=y.useCallback((B,K)=>d.get(Mn(B,K)),[d]),q=y.useCallback((B,K,Y)=>{f(X=>{const P=new Map(X),W=Mn(B,K);return Y?P.set(W,Y):P.delete(W),P})},[]),I=y.useCallback(async(B,K)=>{const Y=d.get(Mn(B,K));if(Y)if(Y.status==="completed"){q(B,K,null);try{await It.deleteByHabitAndDate(B,K)}catch(X){console.error("Failed to delete log:",X),q(B,K,Y)}}else{const X={...Y,status:"completed"};q(B,K,X);try{const P=await It.upsert({habitId:B,date:K,status:"completed"});q(B,K,P)}catch(P){console.error("Failed to update log:",P),q(B,K,Y)}}else{const X={id:"temp-"+Date.now(),habitId:B,date:K,status:"completed",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};q(B,K,X);try{const P=await It.upsert({habitId:B,date:K,status:"completed"});q(B,K,P)}catch(P){console.error("Failed to save log:",P),q(B,K,null)}}},[d,q]),z=y.useCallback(async(B,K)=>{const Y=d.get(Mn(B,K));if(Y)if(Y.status==="skipped"){q(B,K,null);try{await It.deleteByHabitAndDate(B,K)}catch(X){console.error("Failed to delete log:",X),q(B,K,Y)}}else{const X={...Y,status:"skipped"};q(B,K,X);try{const P=await It.upsert({habitId:B,date:K,status:"skipped"});q(B,K,P)}catch(P){console.error("Failed to update log:",P),q(B,K,Y)}}else{const X={id:"temp-"+Date.now(),habitId:B,date:K,status:"skipped",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};q(B,K,X);try{const P=await It.upsert({habitId:B,date:K,status:"skipped"});q(B,K,P)}catch(P){console.error("Failed to save log:",P),q(B,K,null)}}},[d,q]),ne=y.useCallback(async()=>{m(!0);const B=await R();if(B){const{habits:K,dates:Y}=B;f(new Map),Y.length>0&&await M(K,Y[0],Y[Y.length-1])}m(!1)},[R,M]);return{habits:t,dates:a,loading:p,error:S,getLog:F,handleSingleTap:I,handleDoubleTap:z,refresh:ne,todayIndex:ei(a),today:rn()}}function fi(){const{habits:t,dates:r,loading:a,error:i,getLog:d,handleSingleTap:f,handleDoubleTap:p,todayIndex:m}=di();return a?u.jsx("div",{className:"page-container flex items-center justify-center",children:u.jsx("div",{className:"text-gray-400",children:"Loading grid..."})}):i?u.jsx("div",{className:"page-container flex items-center justify-center p-4",children:u.jsxs("div",{className:"card text-center",children:[u.jsx("span",{className:"text-3xl mb-3 block",children:"âš ï¸"}),u.jsx("p",{className:"text-accent-error mb-2",children:i}),u.jsx("button",{onClick:()=>window.location.reload(),className:"text-accent-primary hover:underline",children:"Refresh page"})]})}):t.length===0?u.jsx("div",{className:"page-container flex items-center justify-center p-4",children:u.jsxs("div",{className:"card text-center max-w-sm",children:[u.jsx("span",{className:"text-4xl mb-4 block",children:"ðŸ“"}),u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"No habits yet"}),u.jsx("p",{className:"text-gray-400 mb-4",children:"Add some habits to start tracking your progress."}),u.jsx("a",{href:"/habits",className:`inline-block px-4 py-2 bg-accent-primary hover:bg-accent-primary/80
                       text-white font-medium rounded-lg transition-colors`,children:"Add Habits"})]})}):u.jsx("div",{className:"page-container-grid",children:u.jsx(ii,{habits:t,dates:r,getLog:d,onSingleTap:f,onDoubleTap:p,todayIndex:m})})}function hi(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return y.useMemo(()=>i=>{r.forEach(d=>d(i))},r)}const Cr=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function vn(t){const r=Object.prototype.toString.call(t);return r==="[object Window]"||r==="[object global]"}function bo(t){return"nodeType"in t}function nt(t){var r,a;return t?vn(t)?t:bo(t)&&(r=(a=t.ownerDocument)==null?void 0:a.defaultView)!=null?r:window:window}function xo(t){const{Document:r}=nt(t);return t instanceof r}function Wn(t){return vn(t)?!1:t instanceof nt(t).HTMLElement}function Ka(t){return t instanceof nt(t).SVGElement}function yn(t){return t?vn(t)?t.document:bo(t)?xo(t)?t:Wn(t)||Ka(t)?t.ownerDocument:document:document:document}const Rt=Cr?y.useLayoutEffect:y.useEffect;function wo(t){const r=y.useRef(t);return Rt(()=>{r.current=t}),y.useCallback(function(){for(var a=arguments.length,i=new Array(a),d=0;d<a;d++)i[d]=arguments[d];return r.current==null?void 0:r.current(...i)},[])}function pi(){const t=y.useRef(null),r=y.useCallback((i,d)=>{t.current=setInterval(i,d)},[]),a=y.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[r,a]}function $n(t,r){r===void 0&&(r=[t]);const a=y.useRef(t);return Rt(()=>{a.current!==t&&(a.current=t)},r),a}function Vn(t,r){const a=y.useRef();return y.useMemo(()=>{const i=t(a.current);return a.current=i,i},[...r])}function wr(t){const r=wo(t),a=y.useRef(null),i=y.useCallback(d=>{d!==a.current&&(r==null||r(d,a.current)),a.current=d},[]);return[a,i]}function ho(t){const r=y.useRef();return y.useEffect(()=>{r.current=t},[t]),r.current}let ao={};function Yn(t,r){return y.useMemo(()=>{if(r)return r;const a=ao[t]==null?0:ao[t]+1;return ao[t]=a,t+"-"+a},[t,r])}function Fa(t){return function(r){for(var a=arguments.length,i=new Array(a>1?a-1:0),d=1;d<a;d++)i[d-1]=arguments[d];return i.reduce((f,p)=>{const m=Object.entries(p);for(const[S,D]of m){const O=f[S];O!=null&&(f[S]=O+t*D)}return f},{...r})}}const gn=Fa(1),qn=Fa(-1);function mi(t){return"clientX"in t&&"clientY"in t}function jo(t){if(!t)return!1;const{KeyboardEvent:r}=nt(t.target);return r&&t instanceof r}function gi(t){if(!t)return!1;const{TouchEvent:r}=nt(t.target);return r&&t instanceof r}function po(t){if(gi(t)){if(t.touches&&t.touches.length){const{clientX:r,clientY:a}=t.touches[0];return{x:r,y:a}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:r,clientY:a}=t.changedTouches[0];return{x:r,y:a}}}return mi(t)?{x:t.clientX,y:t.clientY}:null}const Hn=Object.freeze({Translate:{toString(t){if(!t)return;const{x:r,y:a}=t;return"translate3d("+(r?Math.round(r):0)+"px, "+(a?Math.round(a):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:r,scaleY:a}=t;return"scaleX("+r+") scaleY("+a+")"}},Transform:{toString(t){if(t)return[Hn.Translate.toString(t),Hn.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:r,duration:a,easing:i}=t;return r+" "+a+"ms "+i}}}),ma="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function vi(t){return t.matches(ma)?t:t.querySelector(ma)}const yi={display:"none"};function bi(t){let{id:r,value:a}=t;return Ge.createElement("div",{id:r,style:yi},a)}function xi(t){let{id:r,announcement:a,ariaLiveType:i="assertive"}=t;const d={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Ge.createElement("div",{id:r,style:d,role:"status","aria-live":i,"aria-atomic":!0},a)}function wi(){const[t,r]=y.useState("");return{announce:y.useCallback(i=>{i!=null&&r(i)},[]),announcement:t}}const $a=y.createContext(null);function ji(t){const r=y.useContext($a);y.useEffect(()=>{if(!r)throw new Error("useDndMonitor must be used within a children of <DndContext>");return r(t)},[t,r])}function ki(){const[t]=y.useState(()=>new Set),r=y.useCallback(i=>(t.add(i),()=>t.delete(i)),[t]);return[y.useCallback(i=>{let{type:d,event:f}=i;t.forEach(p=>{var m;return(m=p[d])==null?void 0:m.call(p,f)})},[t]),r]}const Si={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Di={onDragStart(t){let{active:r}=t;return"Picked up draggable item "+r.id+"."},onDragOver(t){let{active:r,over:a}=t;return a?"Draggable item "+r.id+" was moved over droppable area "+a.id+".":"Draggable item "+r.id+" is no longer over a droppable area."},onDragEnd(t){let{active:r,over:a}=t;return a?"Draggable item "+r.id+" was dropped over droppable area "+a.id:"Draggable item "+r.id+" was dropped."},onDragCancel(t){let{active:r}=t;return"Dragging was cancelled. Draggable item "+r.id+" was dropped."}};function Ni(t){let{announcements:r=Di,container:a,hiddenTextDescribedById:i,screenReaderInstructions:d=Si}=t;const{announce:f,announcement:p}=wi(),m=Yn("DndLiveRegion"),[S,D]=y.useState(!1);if(y.useEffect(()=>{D(!0)},[]),ji(y.useMemo(()=>({onDragStart(R){let{active:M}=R;f(r.onDragStart({active:M}))},onDragMove(R){let{active:M,over:F}=R;r.onDragMove&&f(r.onDragMove({active:M,over:F}))},onDragOver(R){let{active:M,over:F}=R;f(r.onDragOver({active:M,over:F}))},onDragEnd(R){let{active:M,over:F}=R;f(r.onDragEnd({active:M,over:F}))},onDragCancel(R){let{active:M,over:F}=R;f(r.onDragCancel({active:M,over:F}))}}),[f,r])),!S)return null;const O=Ge.createElement(Ge.Fragment,null,Ge.createElement(bi,{id:i,value:d.draggable}),Ge.createElement(xi,{id:m,announcement:p}));return a?mn.createPortal(O,a):O}var Pe;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Pe||(Pe={}));function jr(){}function so(t,r){return y.useMemo(()=>({sensor:t,options:r??{}}),[t,r])}function Ci(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return y.useMemo(()=>[...r].filter(i=>i!=null),[...r])}const wt=Object.freeze({x:0,y:0});function qa(t,r){return Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2))}function Ha(t,r){let{data:{value:a}}=t,{data:{value:i}}=r;return a-i}function _i(t,r){let{data:{value:a}}=t,{data:{value:i}}=r;return i-a}function ga(t){let{left:r,top:a,height:i,width:d}=t;return[{x:r,y:a},{x:r+d,y:a},{x:r,y:a+i},{x:r+d,y:a+i}]}function za(t,r){if(!t||t.length===0)return null;const[a]=t;return a[r]}function va(t,r,a){return r===void 0&&(r=t.left),a===void 0&&(a=t.top),{x:r+t.width*.5,y:a+t.height*.5}}const Ei=t=>{let{collisionRect:r,droppableRects:a,droppableContainers:i}=t;const d=va(r,r.left,r.top),f=[];for(const p of i){const{id:m}=p,S=a.get(m);if(S){const D=qa(va(S),d);f.push({id:m,data:{droppableContainer:p,value:D}})}}return f.sort(Ha)},Ri=t=>{let{collisionRect:r,droppableRects:a,droppableContainers:i}=t;const d=ga(r),f=[];for(const p of i){const{id:m}=p,S=a.get(m);if(S){const D=ga(S),O=d.reduce((M,F,q)=>M+qa(D[q],F),0),R=Number((O/4).toFixed(4));f.push({id:m,data:{droppableContainer:p,value:R}})}}return f.sort(Ha)};function Oi(t,r){const a=Math.max(r.top,t.top),i=Math.max(r.left,t.left),d=Math.min(r.left+r.width,t.left+t.width),f=Math.min(r.top+r.height,t.top+t.height),p=d-i,m=f-a;if(i<d&&a<f){const S=r.width*r.height,D=t.width*t.height,O=p*m,R=O/(S+D-O);return Number(R.toFixed(4))}return 0}const Ai=t=>{let{collisionRect:r,droppableRects:a,droppableContainers:i}=t;const d=[];for(const f of i){const{id:p}=f,m=a.get(p);if(m){const S=Oi(m,r);S>0&&d.push({id:p,data:{droppableContainer:f,value:S}})}}return d.sort(_i)};function Ti(t,r,a){return{...t,scaleX:r&&a?r.width/a.width:1,scaleY:r&&a?r.height/a.height:1}}function Ua(t,r){return t&&r?{x:t.left-r.left,y:t.top-r.top}:wt}function Ii(t){return function(a){for(var i=arguments.length,d=new Array(i>1?i-1:0),f=1;f<i;f++)d[f-1]=arguments[f];return d.reduce((p,m)=>({...p,top:p.top+t*m.y,bottom:p.bottom+t*m.y,left:p.left+t*m.x,right:p.right+t*m.x}),{...a})}}const Pi=Ii(1);function Mi(t){if(t.startsWith("matrix3d(")){const r=t.slice(9,-1).split(/, /);return{x:+r[12],y:+r[13],scaleX:+r[0],scaleY:+r[5]}}else if(t.startsWith("matrix(")){const r=t.slice(7,-1).split(/, /);return{x:+r[4],y:+r[5],scaleX:+r[0],scaleY:+r[3]}}return null}function Li(t,r,a){const i=Mi(r);if(!i)return t;const{scaleX:d,scaleY:f,x:p,y:m}=i,S=t.left-p-(1-d)*parseFloat(a),D=t.top-m-(1-f)*parseFloat(a.slice(a.indexOf(" ")+1)),O=d?t.width/d:t.width,R=f?t.height/f:t.height;return{width:O,height:R,top:D,right:S+O,bottom:D+R,left:S}}const Bi={ignoreTransform:!1};function bn(t,r){r===void 0&&(r=Bi);let a=t.getBoundingClientRect();if(r.ignoreTransform){const{transform:D,transformOrigin:O}=nt(t).getComputedStyle(t);D&&(a=Li(a,D,O))}const{top:i,left:d,width:f,height:p,bottom:m,right:S}=a;return{top:i,left:d,width:f,height:p,bottom:m,right:S}}function ya(t){return bn(t,{ignoreTransform:!0})}function Ki(t){const r=t.innerWidth,a=t.innerHeight;return{top:0,left:0,right:r,bottom:a,width:r,height:a}}function Fi(t,r){return r===void 0&&(r=nt(t).getComputedStyle(t)),r.position==="fixed"}function $i(t,r){r===void 0&&(r=nt(t).getComputedStyle(t));const a=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(d=>{const f=r[d];return typeof f=="string"?a.test(f):!1})}function _r(t,r){const a=[];function i(d){if(r!=null&&a.length>=r||!d)return a;if(xo(d)&&d.scrollingElement!=null&&!a.includes(d.scrollingElement))return a.push(d.scrollingElement),a;if(!Wn(d)||Ka(d)||a.includes(d))return a;const f=nt(t).getComputedStyle(d);return d!==t&&$i(d,f)&&a.push(d),Fi(d,f)?a:i(d.parentNode)}return t?i(t):a}function Wa(t){const[r]=_r(t,1);return r??null}function io(t){return!Cr||!t?null:vn(t)?t:bo(t)?xo(t)||t===yn(t).scrollingElement?window:Wn(t)?t:null:null}function Va(t){return vn(t)?t.scrollX:t.scrollLeft}function Ya(t){return vn(t)?t.scrollY:t.scrollTop}function mo(t){return{x:Va(t),y:Ya(t)}}var Le;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Le||(Le={}));function Xa(t){return!Cr||!t?!1:t===document.scrollingElement}function Ga(t){const r={x:0,y:0},a=Xa(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},i={x:t.scrollWidth-a.width,y:t.scrollHeight-a.height},d=t.scrollTop<=r.y,f=t.scrollLeft<=r.x,p=t.scrollTop>=i.y,m=t.scrollLeft>=i.x;return{isTop:d,isLeft:f,isBottom:p,isRight:m,maxScroll:i,minScroll:r}}const qi={x:.2,y:.2};function Hi(t,r,a,i,d){let{top:f,left:p,right:m,bottom:S}=a;i===void 0&&(i=10),d===void 0&&(d=qi);const{isTop:D,isBottom:O,isLeft:R,isRight:M}=Ga(t),F={x:0,y:0},q={x:0,y:0},I={height:r.height*d.y,width:r.width*d.x};return!D&&f<=r.top+I.height?(F.y=Le.Backward,q.y=i*Math.abs((r.top+I.height-f)/I.height)):!O&&S>=r.bottom-I.height&&(F.y=Le.Forward,q.y=i*Math.abs((r.bottom-I.height-S)/I.height)),!M&&m>=r.right-I.width?(F.x=Le.Forward,q.x=i*Math.abs((r.right-I.width-m)/I.width)):!R&&p<=r.left+I.width&&(F.x=Le.Backward,q.x=i*Math.abs((r.left+I.width-p)/I.width)),{direction:F,speed:q}}function zi(t){if(t===document.scrollingElement){const{innerWidth:f,innerHeight:p}=window;return{top:0,left:0,right:f,bottom:p,width:f,height:p}}const{top:r,left:a,right:i,bottom:d}=t.getBoundingClientRect();return{top:r,left:a,right:i,bottom:d,width:t.clientWidth,height:t.clientHeight}}function Ja(t){return t.reduce((r,a)=>gn(r,mo(a)),wt)}function Ui(t){return t.reduce((r,a)=>r+Va(a),0)}function Wi(t){return t.reduce((r,a)=>r+Ya(a),0)}function Vi(t,r){if(r===void 0&&(r=bn),!t)return;const{top:a,left:i,bottom:d,right:f}=r(t);Wa(t)&&(d<=0||f<=0||a>=window.innerHeight||i>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const Yi=[["x",["left","right"],Ui],["y",["top","bottom"],Wi]];class ko{constructor(r,a){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const i=_r(a),d=Ja(i);this.rect={...r},this.width=r.width,this.height=r.height;for(const[f,p,m]of Yi)for(const S of p)Object.defineProperty(this,S,{get:()=>{const D=m(i),O=d[f]-D;return this.rect[S]+O},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ln{constructor(r){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(a=>{var i;return(i=this.target)==null?void 0:i.removeEventListener(...a)})},this.target=r}add(r,a,i){var d;(d=this.target)==null||d.addEventListener(r,a,i),this.listeners.push([r,a,i])}}function Xi(t){const{EventTarget:r}=nt(t);return t instanceof r?t:yn(t)}function co(t,r){const a=Math.abs(t.x),i=Math.abs(t.y);return typeof r=="number"?Math.sqrt(a**2+i**2)>r:"x"in r&&"y"in r?a>r.x&&i>r.y:"x"in r?a>r.x:"y"in r?i>r.y:!1}var vt;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(vt||(vt={}));function ba(t){t.preventDefault()}function Gi(t){t.stopPropagation()}var ye;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(ye||(ye={}));const Qa={start:[ye.Space,ye.Enter],cancel:[ye.Esc],end:[ye.Space,ye.Enter,ye.Tab]},Ji=(t,r)=>{let{currentCoordinates:a}=r;switch(t.code){case ye.Right:return{...a,x:a.x+25};case ye.Left:return{...a,x:a.x-25};case ye.Down:return{...a,y:a.y+25};case ye.Up:return{...a,y:a.y-25}}};class So{constructor(r){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=r;const{event:{target:a}}=r;this.props=r,this.listeners=new Ln(yn(a)),this.windowListeners=new Ln(nt(a)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(vt.Resize,this.handleCancel),this.windowListeners.add(vt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(vt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:r,onStart:a}=this.props,i=r.node.current;i&&Vi(i),a(wt)}handleKeyDown(r){if(jo(r)){const{active:a,context:i,options:d}=this.props,{keyboardCodes:f=Qa,coordinateGetter:p=Ji,scrollBehavior:m="smooth"}=d,{code:S}=r;if(f.end.includes(S)){this.handleEnd(r);return}if(f.cancel.includes(S)){this.handleCancel(r);return}const{collisionRect:D}=i.current,O=D?{x:D.left,y:D.top}:wt;this.referenceCoordinates||(this.referenceCoordinates=O);const R=p(r,{active:a,context:i.current,currentCoordinates:O});if(R){const M=qn(R,O),F={x:0,y:0},{scrollableAncestors:q}=i.current;for(const I of q){const z=r.code,{isTop:ne,isRight:B,isLeft:K,isBottom:Y,maxScroll:X,minScroll:P}=Ga(I),W=zi(I),Q={x:Math.min(z===ye.Right?W.right-W.width/2:W.right,Math.max(z===ye.Right?W.left:W.left+W.width/2,R.x)),y:Math.min(z===ye.Down?W.bottom-W.height/2:W.bottom,Math.max(z===ye.Down?W.top:W.top+W.height/2,R.y))},ae=z===ye.Right&&!B||z===ye.Left&&!K,le=z===ye.Down&&!Y||z===ye.Up&&!ne;if(ae&&Q.x!==R.x){const pe=I.scrollLeft+M.x,we=z===ye.Right&&pe<=X.x||z===ye.Left&&pe>=P.x;if(we&&!M.y){I.scrollTo({left:pe,behavior:m});return}we?F.x=I.scrollLeft-pe:F.x=z===ye.Right?I.scrollLeft-X.x:I.scrollLeft-P.x,F.x&&I.scrollBy({left:-F.x,behavior:m});break}else if(le&&Q.y!==R.y){const pe=I.scrollTop+M.y,we=z===ye.Down&&pe<=X.y||z===ye.Up&&pe>=P.y;if(we&&!M.x){I.scrollTo({top:pe,behavior:m});return}we?F.y=I.scrollTop-pe:F.y=z===ye.Down?I.scrollTop-X.y:I.scrollTop-P.y,F.y&&I.scrollBy({top:-F.y,behavior:m});break}}this.handleMove(r,gn(qn(R,this.referenceCoordinates),F))}}}handleMove(r,a){const{onMove:i}=this.props;r.preventDefault(),i(a)}handleEnd(r){const{onEnd:a}=this.props;r.preventDefault(),this.detach(),a()}handleCancel(r){const{onCancel:a}=this.props;r.preventDefault(),this.detach(),a()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}So.activators=[{eventName:"onKeyDown",handler:(t,r,a)=>{let{keyboardCodes:i=Qa,onActivation:d}=r,{active:f}=a;const{code:p}=t.nativeEvent;if(i.start.includes(p)){const m=f.activatorNode.current;return m&&t.target!==m?!1:(t.preventDefault(),d==null||d({event:t.nativeEvent}),!0)}return!1}}];function xa(t){return!!(t&&"distance"in t)}function wa(t){return!!(t&&"delay"in t)}class Do{constructor(r,a,i){var d;i===void 0&&(i=Xi(r.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=r,this.events=a;const{event:f}=r,{target:p}=f;this.props=r,this.events=a,this.document=yn(p),this.documentListeners=new Ln(this.document),this.listeners=new Ln(i),this.windowListeners=new Ln(nt(p)),this.initialCoordinates=(d=po(f))!=null?d:wt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:r,props:{options:{activationConstraint:a,bypassActivationConstraint:i}}}=this;if(this.listeners.add(r.move.name,this.handleMove,{passive:!1}),this.listeners.add(r.end.name,this.handleEnd),r.cancel&&this.listeners.add(r.cancel.name,this.handleCancel),this.windowListeners.add(vt.Resize,this.handleCancel),this.windowListeners.add(vt.DragStart,ba),this.windowListeners.add(vt.VisibilityChange,this.handleCancel),this.windowListeners.add(vt.ContextMenu,ba),this.documentListeners.add(vt.Keydown,this.handleKeydown),a){if(i!=null&&i({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(wa(a)){this.timeoutId=setTimeout(this.handleStart,a.delay),this.handlePending(a);return}if(xa(a)){this.handlePending(a);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(r,a){const{active:i,onPending:d}=this.props;d(i,r,this.initialCoordinates,a)}handleStart(){const{initialCoordinates:r}=this,{onStart:a}=this.props;r&&(this.activated=!0,this.documentListeners.add(vt.Click,Gi,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(vt.SelectionChange,this.removeTextSelection),a(r))}handleMove(r){var a;const{activated:i,initialCoordinates:d,props:f}=this,{onMove:p,options:{activationConstraint:m}}=f;if(!d)return;const S=(a=po(r))!=null?a:wt,D=qn(d,S);if(!i&&m){if(xa(m)){if(m.tolerance!=null&&co(D,m.tolerance))return this.handleCancel();if(co(D,m.distance))return this.handleStart()}if(wa(m)&&co(D,m.tolerance))return this.handleCancel();this.handlePending(m,D);return}r.cancelable&&r.preventDefault(),p(S)}handleEnd(){const{onAbort:r,onEnd:a}=this.props;this.detach(),this.activated||r(this.props.active),a()}handleCancel(){const{onAbort:r,onCancel:a}=this.props;this.detach(),this.activated||r(this.props.active),a()}handleKeydown(r){r.code===ye.Esc&&this.handleCancel()}removeTextSelection(){var r;(r=this.document.getSelection())==null||r.removeAllRanges()}}const Qi={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class No extends Do{constructor(r){const{event:a}=r,i=yn(a.target);super(r,Qi,i)}}No.activators=[{eventName:"onPointerDown",handler:(t,r)=>{let{nativeEvent:a}=t,{onActivation:i}=r;return!a.isPrimary||a.button!==0?!1:(i==null||i({event:a}),!0)}}];const Zi={move:{name:"mousemove"},end:{name:"mouseup"}};var go;(function(t){t[t.RightClick=2]="RightClick"})(go||(go={}));class ec extends Do{constructor(r){super(r,Zi,yn(r.event.target))}}ec.activators=[{eventName:"onMouseDown",handler:(t,r)=>{let{nativeEvent:a}=t,{onActivation:i}=r;return a.button===go.RightClick?!1:(i==null||i({event:a}),!0)}}];const lo={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Za extends Do{constructor(r){super(r,lo)}static setup(){return window.addEventListener(lo.move.name,r,{capture:!1,passive:!1}),function(){window.removeEventListener(lo.move.name,r)};function r(){}}}Za.activators=[{eventName:"onTouchStart",handler:(t,r)=>{let{nativeEvent:a}=t,{onActivation:i}=r;const{touches:d}=a;return d.length>1?!1:(i==null||i({event:a}),!0)}}];var Bn;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Bn||(Bn={}));var kr;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(kr||(kr={}));function tc(t){let{acceleration:r,activator:a=Bn.Pointer,canScroll:i,draggingRect:d,enabled:f,interval:p=5,order:m=kr.TreeOrder,pointerCoordinates:S,scrollableAncestors:D,scrollableAncestorRects:O,delta:R,threshold:M}=t;const F=rc({delta:R,disabled:!f}),[q,I]=pi(),z=y.useRef({x:0,y:0}),ne=y.useRef({x:0,y:0}),B=y.useMemo(()=>{switch(a){case Bn.Pointer:return S?{top:S.y,bottom:S.y,left:S.x,right:S.x}:null;case Bn.DraggableRect:return d}},[a,d,S]),K=y.useRef(null),Y=y.useCallback(()=>{const P=K.current;if(!P)return;const W=z.current.x*ne.current.x,Q=z.current.y*ne.current.y;P.scrollBy(W,Q)},[]),X=y.useMemo(()=>m===kr.TreeOrder?[...D].reverse():D,[m,D]);y.useEffect(()=>{if(!f||!D.length||!B){I();return}for(const P of X){if((i==null?void 0:i(P))===!1)continue;const W=D.indexOf(P),Q=O[W];if(!Q)continue;const{direction:ae,speed:le}=Hi(P,Q,B,r,M);for(const pe of["x","y"])F[pe][ae[pe]]||(le[pe]=0,ae[pe]=0);if(le.x>0||le.y>0){I(),K.current=P,q(Y,p),z.current=le,ne.current=ae;return}}z.current={x:0,y:0},ne.current={x:0,y:0},I()},[r,Y,i,I,f,p,JSON.stringify(B),JSON.stringify(F),q,D,X,O,JSON.stringify(M)])}const nc={x:{[Le.Backward]:!1,[Le.Forward]:!1},y:{[Le.Backward]:!1,[Le.Forward]:!1}};function rc(t){let{delta:r,disabled:a}=t;const i=ho(r);return Vn(d=>{if(a||!i||!d)return nc;const f={x:Math.sign(r.x-i.x),y:Math.sign(r.y-i.y)};return{x:{[Le.Backward]:d.x[Le.Backward]||f.x===-1,[Le.Forward]:d.x[Le.Forward]||f.x===1},y:{[Le.Backward]:d.y[Le.Backward]||f.y===-1,[Le.Forward]:d.y[Le.Forward]||f.y===1}}},[a,r,i])}function oc(t,r){const a=r!=null?t.get(r):void 0,i=a?a.node.current:null;return Vn(d=>{var f;return r==null?null:(f=i??d)!=null?f:null},[i,r])}function ac(t,r){return y.useMemo(()=>t.reduce((a,i)=>{const{sensor:d}=i,f=d.activators.map(p=>({eventName:p.eventName,handler:r(p.handler,i)}));return[...a,...f]},[]),[t,r])}var zn;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(zn||(zn={}));var vo;(function(t){t.Optimized="optimized"})(vo||(vo={}));const ja=new Map;function sc(t,r){let{dragging:a,dependencies:i,config:d}=r;const[f,p]=y.useState(null),{frequency:m,measure:S,strategy:D}=d,O=y.useRef(t),R=z(),M=$n(R),F=y.useCallback(function(ne){ne===void 0&&(ne=[]),!M.current&&p(B=>B===null?ne:B.concat(ne.filter(K=>!B.includes(K))))},[M]),q=y.useRef(null),I=Vn(ne=>{if(R&&!a)return ja;if(!ne||ne===ja||O.current!==t||f!=null){const B=new Map;for(let K of t){if(!K)continue;if(f&&f.length>0&&!f.includes(K.id)&&K.rect.current){B.set(K.id,K.rect.current);continue}const Y=K.node.current,X=Y?new ko(S(Y),Y):null;K.rect.current=X,X&&B.set(K.id,X)}return B}return ne},[t,f,a,R,S]);return y.useEffect(()=>{O.current=t},[t]),y.useEffect(()=>{R||F()},[a,R]),y.useEffect(()=>{f&&f.length>0&&p(null)},[JSON.stringify(f)]),y.useEffect(()=>{R||typeof m!="number"||q.current!==null||(q.current=setTimeout(()=>{F(),q.current=null},m))},[m,R,F,...i]),{droppableRects:I,measureDroppableContainers:F,measuringScheduled:f!=null};function z(){switch(D){case zn.Always:return!1;case zn.BeforeDragging:return a;default:return!a}}}function es(t,r){return Vn(a=>t?a||(typeof r=="function"?r(t):t):null,[r,t])}function ic(t,r){return es(t,r)}function cc(t){let{callback:r,disabled:a}=t;const i=wo(r),d=y.useMemo(()=>{if(a||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:f}=window;return new f(i)},[i,a]);return y.useEffect(()=>()=>d==null?void 0:d.disconnect(),[d]),d}function Er(t){let{callback:r,disabled:a}=t;const i=wo(r),d=y.useMemo(()=>{if(a||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:f}=window;return new f(i)},[a]);return y.useEffect(()=>()=>d==null?void 0:d.disconnect(),[d]),d}function lc(t){return new ko(bn(t),t)}function ka(t,r,a){r===void 0&&(r=lc);const[i,d]=y.useState(null);function f(){d(S=>{if(!t)return null;if(t.isConnected===!1){var D;return(D=S??a)!=null?D:null}const O=r(t);return JSON.stringify(S)===JSON.stringify(O)?S:O})}const p=cc({callback(S){if(t)for(const D of S){const{type:O,target:R}=D;if(O==="childList"&&R instanceof HTMLElement&&R.contains(t)){f();break}}}}),m=Er({callback:f});return Rt(()=>{f(),t?(m==null||m.observe(t),p==null||p.observe(document.body,{childList:!0,subtree:!0})):(m==null||m.disconnect(),p==null||p.disconnect())},[t]),i}function uc(t){const r=es(t);return Ua(t,r)}const Sa=[];function dc(t){const r=y.useRef(t),a=Vn(i=>t?i&&i!==Sa&&t&&r.current&&t.parentNode===r.current.parentNode?i:_r(t):Sa,[t]);return y.useEffect(()=>{r.current=t},[t]),a}function fc(t){const[r,a]=y.useState(null),i=y.useRef(t),d=y.useCallback(f=>{const p=io(f.target);p&&a(m=>m?(m.set(p,mo(p)),new Map(m)):null)},[]);return y.useEffect(()=>{const f=i.current;if(t!==f){p(f);const m=t.map(S=>{const D=io(S);return D?(D.addEventListener("scroll",d,{passive:!0}),[D,mo(D)]):null}).filter(S=>S!=null);a(m.length?new Map(m):null),i.current=t}return()=>{p(t),p(f)};function p(m){m.forEach(S=>{const D=io(S);D==null||D.removeEventListener("scroll",d)})}},[d,t]),y.useMemo(()=>t.length?r?Array.from(r.values()).reduce((f,p)=>gn(f,p),wt):Ja(t):wt,[t,r])}function Da(t,r){r===void 0&&(r=[]);const a=y.useRef(null);return y.useEffect(()=>{a.current=null},r),y.useEffect(()=>{const i=t!==wt;i&&!a.current&&(a.current=t),!i&&a.current&&(a.current=null)},[t]),a.current?qn(t,a.current):wt}function hc(t){y.useEffect(()=>{if(!Cr)return;const r=t.map(a=>{let{sensor:i}=a;return i.setup==null?void 0:i.setup()});return()=>{for(const a of r)a==null||a()}},t.map(r=>{let{sensor:a}=r;return a}))}function pc(t,r){return y.useMemo(()=>t.reduce((a,i)=>{let{eventName:d,handler:f}=i;return a[d]=p=>{f(p,r)},a},{}),[t,r])}function ts(t){return y.useMemo(()=>t?Ki(t):null,[t])}const Na=[];function mc(t,r){r===void 0&&(r=bn);const[a]=t,i=ts(a?nt(a):null),[d,f]=y.useState(Na);function p(){f(()=>t.length?t.map(S=>Xa(S)?i:new ko(r(S),S)):Na)}const m=Er({callback:p});return Rt(()=>{m==null||m.disconnect(),p(),t.forEach(S=>m==null?void 0:m.observe(S))},[t]),d}function gc(t){if(!t)return null;if(t.children.length>1)return t;const r=t.children[0];return Wn(r)?r:t}function vc(t){let{measure:r}=t;const[a,i]=y.useState(null),d=y.useCallback(D=>{for(const{target:O}of D)if(Wn(O)){i(R=>{const M=r(O);return R?{...R,width:M.width,height:M.height}:M});break}},[r]),f=Er({callback:d}),p=y.useCallback(D=>{const O=gc(D);f==null||f.disconnect(),O&&(f==null||f.observe(O)),i(O?r(O):null)},[r,f]),[m,S]=wr(p);return y.useMemo(()=>({nodeRef:m,rect:a,setRef:S}),[a,m,S])}const yc=[{sensor:No,options:{}},{sensor:So,options:{}}],bc={current:{}},br={draggable:{measure:ya},droppable:{measure:ya,strategy:zn.WhileDragging,frequency:vo.Optimized},dragOverlay:{measure:bn}};class Kn extends Map{get(r){var a;return r!=null&&(a=super.get(r))!=null?a:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(r=>{let{disabled:a}=r;return!a})}getNodeFor(r){var a,i;return(a=(i=this.get(r))==null?void 0:i.node.current)!=null?a:void 0}}const xc={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Kn,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:jr},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:br,measureDroppableContainers:jr,windowRect:null,measuringScheduled:!1},wc={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:jr,draggableNodes:new Map,over:null,measureDroppableContainers:jr},Rr=y.createContext(wc),ns=y.createContext(xc);function jc(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Kn}}}function kc(t,r){switch(r.type){case Pe.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:r.initialCoordinates,active:r.active}};case Pe.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:r.coordinates.x-t.draggable.initialCoordinates.x,y:r.coordinates.y-t.draggable.initialCoordinates.y}}};case Pe.DragEnd:case Pe.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Pe.RegisterDroppable:{const{element:a}=r,{id:i}=a,d=new Kn(t.droppable.containers);return d.set(i,a),{...t,droppable:{...t.droppable,containers:d}}}case Pe.SetDroppableDisabled:{const{id:a,key:i,disabled:d}=r,f=t.droppable.containers.get(a);if(!f||i!==f.key)return t;const p=new Kn(t.droppable.containers);return p.set(a,{...f,disabled:d}),{...t,droppable:{...t.droppable,containers:p}}}case Pe.UnregisterDroppable:{const{id:a,key:i}=r,d=t.droppable.containers.get(a);if(!d||i!==d.key)return t;const f=new Kn(t.droppable.containers);return f.delete(a),{...t,droppable:{...t.droppable,containers:f}}}default:return t}}function Sc(t){let{disabled:r}=t;const{active:a,activatorEvent:i,draggableNodes:d}=y.useContext(Rr),f=ho(i),p=ho(a==null?void 0:a.id);return y.useEffect(()=>{if(!r&&!i&&f&&p!=null){if(!jo(f)||document.activeElement===f.target)return;const m=d.get(p);if(!m)return;const{activatorNode:S,node:D}=m;if(!S.current&&!D.current)return;requestAnimationFrame(()=>{for(const O of[S.current,D.current]){if(!O)continue;const R=vi(O);if(R){R.focus();break}}})}},[i,r,d,p,f]),null}function Dc(t,r){let{transform:a,...i}=r;return t!=null&&t.length?t.reduce((d,f)=>f({transform:d,...i}),a):a}function Nc(t){return y.useMemo(()=>({draggable:{...br.draggable,...t==null?void 0:t.draggable},droppable:{...br.droppable,...t==null?void 0:t.droppable},dragOverlay:{...br.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function Cc(t){let{activeNode:r,measure:a,initialRect:i,config:d=!0}=t;const f=y.useRef(!1),{x:p,y:m}=typeof d=="boolean"?{x:d,y:d}:d;Rt(()=>{if(!p&&!m||!r){f.current=!1;return}if(f.current||!i)return;const D=r==null?void 0:r.node.current;if(!D||D.isConnected===!1)return;const O=a(D),R=Ua(O,i);if(p||(R.x=0),m||(R.y=0),f.current=!0,Math.abs(R.x)>0||Math.abs(R.y)>0){const M=Wa(D);M&&M.scrollBy({top:R.y,left:R.x})}},[r,p,m,i,a])}const rs=y.createContext({...wt,scaleX:1,scaleY:1});var Ht;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Ht||(Ht={}));const _c=y.memo(function(r){var a,i,d,f;let{id:p,accessibility:m,autoScroll:S=!0,children:D,sensors:O=yc,collisionDetection:R=Ai,measuring:M,modifiers:F,...q}=r;const I=y.useReducer(kc,void 0,jc),[z,ne]=I,[B,K]=ki(),[Y,X]=y.useState(Ht.Uninitialized),P=Y===Ht.Initialized,{draggable:{active:W,nodes:Q,translate:ae},droppable:{containers:le}}=z,pe=W!=null?Q.get(W):null,we=y.useRef({initial:null,translated:null}),Se=y.useMemo(()=>{var Ie;return W!=null?{id:W,data:(Ie=pe==null?void 0:pe.data)!=null?Ie:bc,rect:we}:null},[W,pe]),je=y.useRef(null),[rt,ut]=y.useState(null),[Be,Je]=y.useState(null),se=$n(q,Object.values(q)),be=Yn("DndDescribedBy",p),Ce=y.useMemo(()=>le.getEnabled(),[le]),de=Nc(M),{droppableRects:ke,measureDroppableContainers:Ke,measuringScheduled:Te}=sc(Ce,{dragging:P,dependencies:[ae.x,ae.y],config:de.droppable}),Ne=oc(Q,W),Fe=y.useMemo(()=>Be?po(Be):null,[Be]),Qe=kn(),ee=ic(Ne,de.draggable.measure);Cc({activeNode:W!=null?Q.get(W):null,config:Qe.layoutShiftCompensation,initialRect:ee,measure:de.draggable.measure});const me=ka(Ne,de.draggable.measure,ee),dt=ka(Ne?Ne.parentElement:null),fe=y.useRef({activatorEvent:null,active:null,activeNode:Ne,collisionRect:null,collisions:null,droppableRects:ke,draggableNodes:Q,draggingNode:null,draggingNodeRect:null,droppableContainers:le,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ft=le.getNodeFor((a=fe.current.over)==null?void 0:a.id),bt=vc({measure:de.dragOverlay.measure}),Ze=(i=bt.nodeRef.current)!=null?i:Ne,Pt=P?(d=bt.rect)!=null?d:me:null,Xn=!!(bt.nodeRef.current&&bt.rect),Gn=uc(Xn?null:me),xn=ts(Ze?nt(Ze):null),ht=dc(P?ft??Ne:null),Ve=mc(ht),Ut=Dc(F,{transform:{x:ae.x-Gn.x,y:ae.y-Gn.y,scaleX:1,scaleY:1},activatorEvent:Be,active:Se,activeNodeRect:me,containerNodeRect:dt,draggingNodeRect:Pt,over:fe.current.over,overlayNodeRect:bt.rect,scrollableAncestors:ht,scrollableAncestorRects:Ve,windowRect:xn}),Mt=Fe?gn(Fe,ae):null,wn=fc(ht),Wt=Da(wn),Ot=Da(wn,[me]),et=gn(Ut,Wt),jt=Pt?Pi(Pt,Ut):null,xt=Se&&jt?R({active:Se,collisionRect:jt,droppableRects:ke,droppableContainers:Ce,pointerCoordinates:Mt}):null,on=za(xt,"id"),[ot,kt]=y.useState(null),an=Xn?Ut:gn(Ut,Ot),jn=Ti(an,(f=ot==null?void 0:ot.rect)!=null?f:null,me),pt=y.useRef(null),re=y.useCallback((Ie,$e)=>{let{sensor:He,options:mt}=$e;if(je.current==null)return;const tt=Q.get(je.current);if(!tt)return;const Ye=Ie.nativeEvent,qe=new He({active:je.current,activeNode:tt,event:Ye,options:mt,context:fe,onAbort(Ee){if(!Q.get(Ee))return;const{onDragAbort:ge}=se.current,De={id:Ee};ge==null||ge(De),B({type:"onDragAbort",event:De})},onPending(Ee,st,ge,De){if(!Q.get(Ee))return;const{onDragPending:Dt}=se.current,it={id:Ee,constraint:st,initialCoordinates:ge,offset:De};Dt==null||Dt(it),B({type:"onDragPending",event:it})},onStart(Ee){const st=je.current;if(st==null)return;const ge=Q.get(st);if(!ge)return;const{onDragStart:De}=se.current,Yt={activatorEvent:Ye,active:{id:st,data:ge.data,rect:we}};mn.unstable_batchedUpdates(()=>{De==null||De(Yt),X(Ht.Initializing),ne({type:Pe.DragStart,initialCoordinates:Ee,active:st}),B({type:"onDragStart",event:Yt}),ut(pt.current),Je(Ye)})},onMove(Ee){ne({type:Pe.DragMove,coordinates:Ee})},onEnd:at(Pe.DragEnd),onCancel:at(Pe.DragCancel)});pt.current=qe;function at(Ee){return async function(){const{active:ge,collisions:De,over:Yt,scrollAdjustedTranslate:Dt}=fe.current;let it=null;if(ge&&Dt){const{cancelDrop:Nt}=se.current;it={activatorEvent:Ye,active:ge,collisions:De,delta:Dt,over:Yt},Ee===Pe.DragEnd&&typeof Nt=="function"&&await Promise.resolve(Nt(it))&&(Ee=Pe.DragCancel)}je.current=null,mn.unstable_batchedUpdates(()=>{ne({type:Ee}),X(Ht.Uninitialized),kt(null),ut(null),Je(null),pt.current=null;const Nt=Ee===Pe.DragEnd?"onDragEnd":"onDragCancel";if(it){const Sn=se.current[Nt];Sn==null||Sn(it),B({type:Nt,event:it})}})}}},[Q]),Vt=y.useCallback((Ie,$e)=>(He,mt)=>{const tt=He.nativeEvent,Ye=Q.get(mt);if(je.current!==null||!Ye||tt.dndKit||tt.defaultPrevented)return;const qe={active:Ye};Ie(He,$e.options,qe)===!0&&(tt.dndKit={capturedBy:$e.sensor},je.current=mt,re(He,$e))},[Q,re]),St=ac(O,Vt);hc(O),Rt(()=>{me&&Y===Ht.Initializing&&X(Ht.Initialized)},[me,Y]),y.useEffect(()=>{const{onDragMove:Ie}=se.current,{active:$e,activatorEvent:He,collisions:mt,over:tt}=fe.current;if(!$e||!He)return;const Ye={active:$e,activatorEvent:He,collisions:mt,delta:{x:et.x,y:et.y},over:tt};mn.unstable_batchedUpdates(()=>{Ie==null||Ie(Ye),B({type:"onDragMove",event:Ye})})},[et.x,et.y]),y.useEffect(()=>{const{active:Ie,activatorEvent:$e,collisions:He,droppableContainers:mt,scrollAdjustedTranslate:tt}=fe.current;if(!Ie||je.current==null||!$e||!tt)return;const{onDragOver:Ye}=se.current,qe=mt.get(on),at=qe&&qe.rect.current?{id:qe.id,rect:qe.rect.current,data:qe.data,disabled:qe.disabled}:null,Ee={active:Ie,activatorEvent:$e,collisions:He,delta:{x:tt.x,y:tt.y},over:at};mn.unstable_batchedUpdates(()=>{kt(at),Ye==null||Ye(Ee),B({type:"onDragOver",event:Ee})})},[on]),Rt(()=>{fe.current={activatorEvent:Be,active:Se,activeNode:Ne,collisionRect:jt,collisions:xt,droppableRects:ke,draggableNodes:Q,draggingNode:Ze,draggingNodeRect:Pt,droppableContainers:le,over:ot,scrollableAncestors:ht,scrollAdjustedTranslate:et},we.current={initial:Pt,translated:jt}},[Se,Ne,xt,jt,Q,Ze,Pt,ke,le,ot,ht,et]),tc({...Qe,delta:ae,draggingRect:jt,pointerCoordinates:Mt,scrollableAncestors:ht,scrollableAncestorRects:Ve});const sn=y.useMemo(()=>({active:Se,activeNode:Ne,activeNodeRect:me,activatorEvent:Be,collisions:xt,containerNodeRect:dt,dragOverlay:bt,draggableNodes:Q,droppableContainers:le,droppableRects:ke,over:ot,measureDroppableContainers:Ke,scrollableAncestors:ht,scrollableAncestorRects:Ve,measuringConfiguration:de,measuringScheduled:Te,windowRect:xn}),[Se,Ne,me,Be,xt,dt,bt,Q,le,ke,ot,Ke,ht,Ve,de,Te,xn]),Z=y.useMemo(()=>({activatorEvent:Be,activators:St,active:Se,activeNodeRect:me,ariaDescribedById:{draggable:be},dispatch:ne,draggableNodes:Q,over:ot,measureDroppableContainers:Ke}),[Be,St,Se,me,ne,be,Q,ot,Ke]);return Ge.createElement($a.Provider,{value:K},Ge.createElement(Rr.Provider,{value:Z},Ge.createElement(ns.Provider,{value:sn},Ge.createElement(rs.Provider,{value:jn},D)),Ge.createElement(Sc,{disabled:(m==null?void 0:m.restoreFocus)===!1})),Ge.createElement(Ni,{...m,hiddenTextDescribedById:be}));function kn(){const Ie=(rt==null?void 0:rt.autoScrollEnabled)===!1,$e=typeof S=="object"?S.enabled===!1:S===!1,He=P&&!Ie&&!$e;return typeof S=="object"?{...S,enabled:He}:{enabled:He}}}),Ec=y.createContext(null),Ca="button",Rc="Draggable";function Oc(t){let{id:r,data:a,disabled:i=!1,attributes:d}=t;const f=Yn(Rc),{activators:p,activatorEvent:m,active:S,activeNodeRect:D,ariaDescribedById:O,draggableNodes:R,over:M}=y.useContext(Rr),{role:F=Ca,roleDescription:q="draggable",tabIndex:I=0}=d??{},z=(S==null?void 0:S.id)===r,ne=y.useContext(z?rs:Ec),[B,K]=wr(),[Y,X]=wr(),P=pc(p,r),W=$n(a);Rt(()=>(R.set(r,{id:r,key:f,node:B,activatorNode:Y,data:W}),()=>{const ae=R.get(r);ae&&ae.key===f&&R.delete(r)}),[R,r]);const Q=y.useMemo(()=>({role:F,tabIndex:I,"aria-disabled":i,"aria-pressed":z&&F===Ca?!0:void 0,"aria-roledescription":q,"aria-describedby":O.draggable}),[i,F,I,z,q,O.draggable]);return{active:S,activatorEvent:m,activeNodeRect:D,attributes:Q,isDragging:z,listeners:i?void 0:P,node:B,over:M,setNodeRef:K,setActivatorNodeRef:X,transform:ne}}function Ac(){return y.useContext(ns)}const Tc="Droppable",Ic={timeout:25};function Pc(t){let{data:r,disabled:a=!1,id:i,resizeObserverConfig:d}=t;const f=Yn(Tc),{active:p,dispatch:m,over:S,measureDroppableContainers:D}=y.useContext(Rr),O=y.useRef({disabled:a}),R=y.useRef(!1),M=y.useRef(null),F=y.useRef(null),{disabled:q,updateMeasurementsFor:I,timeout:z}={...Ic,...d},ne=$n(I??i),B=y.useCallback(()=>{if(!R.current){R.current=!0;return}F.current!=null&&clearTimeout(F.current),F.current=setTimeout(()=>{D(Array.isArray(ne.current)?ne.current:[ne.current]),F.current=null},z)},[z]),K=Er({callback:B,disabled:q||!p}),Y=y.useCallback((Q,ae)=>{K&&(ae&&(K.unobserve(ae),R.current=!1),Q&&K.observe(Q))},[K]),[X,P]=wr(Y),W=$n(r);return y.useEffect(()=>{!K||!X.current||(K.disconnect(),R.current=!1,K.observe(X.current))},[X,K]),y.useEffect(()=>(m({type:Pe.RegisterDroppable,element:{id:i,key:f,disabled:a,node:X,rect:M,data:W}}),()=>m({type:Pe.UnregisterDroppable,key:f,id:i})),[i]),y.useEffect(()=>{a!==O.current.disabled&&(m({type:Pe.SetDroppableDisabled,id:i,key:f,disabled:a}),O.current.disabled=a)},[i,f,a,m]),{active:p,rect:M,isOver:(S==null?void 0:S.id)===i,node:X,over:S,setNodeRef:P}}function Co(t,r,a){const i=t.slice();return i.splice(a<0?i.length+a:a,0,i.splice(r,1)[0]),i}function Mc(t,r){return t.reduce((a,i,d)=>{const f=r.get(i);return f&&(a[d]=f),a},Array(t.length))}function vr(t){return t!==null&&t>=0}function Lc(t,r){if(t===r)return!0;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a]!==r[a])return!1;return!0}function Bc(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const os=t=>{let{rects:r,activeIndex:a,overIndex:i,index:d}=t;const f=Co(r,i,a),p=r[d],m=f[d];return!m||!p?null:{x:m.left-p.left,y:m.top-p.top,scaleX:m.width/p.width,scaleY:m.height/p.height}},yr={scaleX:1,scaleY:1},Kc=t=>{var r;let{activeIndex:a,activeNodeRect:i,index:d,rects:f,overIndex:p}=t;const m=(r=f[a])!=null?r:i;if(!m)return null;if(d===a){const D=f[p];return D?{x:0,y:a<p?D.top+D.height-(m.top+m.height):D.top-m.top,...yr}:null}const S=Fc(f,d,a);return d>a&&d<=p?{x:0,y:-m.height-S,...yr}:d<a&&d>=p?{x:0,y:m.height+S,...yr}:{x:0,y:0,...yr}};function Fc(t,r,a){const i=t[r],d=t[r-1],f=t[r+1];return i?a<r?d?i.top-(d.top+d.height):f?f.top-(i.top+i.height):0:f?f.top-(i.top+i.height):d?i.top-(d.top+d.height):0:0}const as="Sortable",ss=Ge.createContext({activeIndex:-1,containerId:as,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:os,disabled:{draggable:!1,droppable:!1}});function $c(t){let{children:r,id:a,items:i,strategy:d=os,disabled:f=!1}=t;const{active:p,dragOverlay:m,droppableRects:S,over:D,measureDroppableContainers:O}=Ac(),R=Yn(as,a),M=m.rect!==null,F=y.useMemo(()=>i.map(P=>typeof P=="object"&&"id"in P?P.id:P),[i]),q=p!=null,I=p?F.indexOf(p.id):-1,z=D?F.indexOf(D.id):-1,ne=y.useRef(F),B=!Lc(F,ne.current),K=z!==-1&&I===-1||B,Y=Bc(f);Rt(()=>{B&&q&&O(F)},[B,F,q,O]),y.useEffect(()=>{ne.current=F},[F]);const X=y.useMemo(()=>({activeIndex:I,containerId:R,disabled:Y,disableTransforms:K,items:F,overIndex:z,useDragOverlay:M,sortedRects:Mc(F,S),strategy:d}),[I,R,Y.draggable,Y.droppable,K,F,z,S,M,d]);return Ge.createElement(ss.Provider,{value:X},r)}const qc=t=>{let{id:r,items:a,activeIndex:i,overIndex:d}=t;return Co(a,i,d).indexOf(r)},Hc=t=>{let{containerId:r,isSorting:a,wasDragging:i,index:d,items:f,newIndex:p,previousItems:m,previousContainerId:S,transition:D}=t;return!D||!i||m!==f&&d===p?!1:a?!0:p!==d&&r===S},zc={duration:200,easing:"ease"},is="transform",Uc=Hn.Transition.toString({property:is,duration:0,easing:"linear"}),Wc={roleDescription:"sortable"};function Vc(t){let{disabled:r,index:a,node:i,rect:d}=t;const[f,p]=y.useState(null),m=y.useRef(a);return Rt(()=>{if(!r&&a!==m.current&&i.current){const S=d.current;if(S){const D=bn(i.current,{ignoreTransform:!0}),O={x:S.left-D.left,y:S.top-D.top,scaleX:S.width/D.width,scaleY:S.height/D.height};(O.x||O.y)&&p(O)}}a!==m.current&&(m.current=a)},[r,a,i,d]),y.useEffect(()=>{f&&p(null)},[f]),f}function Yc(t){let{animateLayoutChanges:r=Hc,attributes:a,disabled:i,data:d,getNewIndex:f=qc,id:p,strategy:m,resizeObserverConfig:S,transition:D=zc}=t;const{items:O,containerId:R,activeIndex:M,disabled:F,disableTransforms:q,sortedRects:I,overIndex:z,useDragOverlay:ne,strategy:B}=y.useContext(ss),K=Xc(i,F),Y=O.indexOf(p),X=y.useMemo(()=>({sortable:{containerId:R,index:Y,items:O},...d}),[R,d,Y,O]),P=y.useMemo(()=>O.slice(O.indexOf(p)),[O,p]),{rect:W,node:Q,isOver:ae,setNodeRef:le}=Pc({id:p,data:X,disabled:K.droppable,resizeObserverConfig:{updateMeasurementsFor:P,...S}}),{active:pe,activatorEvent:we,activeNodeRect:Se,attributes:je,setNodeRef:rt,listeners:ut,isDragging:Be,over:Je,setActivatorNodeRef:se,transform:be}=Oc({id:p,data:X,attributes:{...Wc,...a},disabled:K.draggable}),Ce=hi(le,rt),de=!!pe,ke=de&&!q&&vr(M)&&vr(z),Ke=!ne&&Be,Te=Ke&&ke?be:null,Fe=ke?Te??(m??B)({rects:I,activeNodeRect:Se,activeIndex:M,overIndex:z,index:Y}):null,Qe=vr(M)&&vr(z)?f({id:p,items:O,activeIndex:M,overIndex:z}):Y,ee=pe==null?void 0:pe.id,me=y.useRef({activeId:ee,items:O,newIndex:Qe,containerId:R}),dt=O!==me.current.items,fe=r({active:pe,containerId:R,isDragging:Be,isSorting:de,id:p,index:Y,items:O,newIndex:me.current.newIndex,previousItems:me.current.items,previousContainerId:me.current.containerId,transition:D,wasDragging:me.current.activeId!=null}),ft=Vc({disabled:!fe,index:Y,node:Q,rect:W});return y.useEffect(()=>{de&&me.current.newIndex!==Qe&&(me.current.newIndex=Qe),R!==me.current.containerId&&(me.current.containerId=R),O!==me.current.items&&(me.current.items=O)},[de,Qe,R,O]),y.useEffect(()=>{if(ee===me.current.activeId)return;if(ee!=null&&me.current.activeId==null){me.current.activeId=ee;return}const Ze=setTimeout(()=>{me.current.activeId=ee},50);return()=>clearTimeout(Ze)},[ee]),{active:pe,activeIndex:M,attributes:je,data:X,rect:W,index:Y,newIndex:Qe,items:O,isOver:ae,isSorting:de,isDragging:Be,listeners:ut,node:Q,overIndex:z,over:Je,setNodeRef:Ce,setActivatorNodeRef:se,setDroppableNodeRef:le,setDraggableNodeRef:rt,transform:ft??Fe,transition:bt()};function bt(){if(ft||dt&&me.current.newIndex===Y)return Uc;if(!(Ke&&!jo(we)||!D)&&(de||fe))return Hn.Transition.toString({...D,property:is})}}function Xc(t,r){var a,i;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(a=t==null?void 0:t.draggable)!=null?a:r.draggable,droppable:(i=t==null?void 0:t.droppable)!=null?i:r.droppable}}function Sr(t){if(!t)return!1;const r=t.data.current;return!!(r&&"sortable"in r&&typeof r.sortable=="object"&&"containerId"in r.sortable&&"items"in r.sortable&&"index"in r.sortable)}const Gc=[ye.Down,ye.Right,ye.Up,ye.Left],Jc=(t,r)=>{let{context:{active:a,collisionRect:i,droppableRects:d,droppableContainers:f,over:p,scrollableAncestors:m}}=r;if(Gc.includes(t.code)){if(t.preventDefault(),!a||!i)return;const S=[];f.getEnabled().forEach(R=>{if(!R||R!=null&&R.disabled)return;const M=d.get(R.id);if(M)switch(t.code){case ye.Down:i.top<M.top&&S.push(R);break;case ye.Up:i.top>M.top&&S.push(R);break;case ye.Left:i.left>M.left&&S.push(R);break;case ye.Right:i.left<M.left&&S.push(R);break}});const D=Ri({collisionRect:i,droppableRects:d,droppableContainers:S});let O=za(D,"id");if(O===(p==null?void 0:p.id)&&D.length>1&&(O=D[1].id),O!=null){const R=f.get(a.id),M=f.get(O),F=M?d.get(M.id):null,q=M==null?void 0:M.node.current;if(q&&F&&R&&M){const z=_r(q).some((P,W)=>m[W]!==P),ne=cs(R,M),B=Qc(R,M),K=z||!ne?{x:0,y:0}:{x:B?i.width-F.width:0,y:B?i.height-F.height:0},Y={x:F.left,y:F.top};return K.x&&K.y?Y:qn(Y,K)}}}};function cs(t,r){return!Sr(t)||!Sr(r)?!1:t.data.current.sortable.containerId===r.data.current.sortable.containerId}function Qc(t,r){return!Sr(t)||!Sr(r)||!cs(t,r)?!1:t.data.current.sortable.index<r.data.current.sortable.index}const ls=[{id:"green",hex:"#22c55e",name:"Green"},{id:"emerald",hex:"#10b981",name:"Emerald"},{id:"teal",hex:"#14b8a6",name:"Teal"},{id:"cyan",hex:"#06b6d4",name:"Cyan"},{id:"blue",hex:"#3b82f6",name:"Blue"},{id:"indigo",hex:"#6366f1",name:"Indigo"},{id:"purple",hex:"#8b5cf6",name:"Purple"},{id:"pink",hex:"#ec4899",name:"Pink"},{id:"orange",hex:"#f97316",name:"Orange"},{id:"amber",hex:"#f59e0b",name:"Amber"}],Zc=[{id:0,short:"S",name:"Sunday"},{id:1,short:"M",name:"Monday"},{id:2,short:"T",name:"Tuesday"},{id:3,short:"W",name:"Wednesday"},{id:4,short:"T",name:"Thursday"},{id:5,short:"F",name:"Friday"},{id:6,short:"S",name:"Saturday"}],_a="2025-12-17",el=["ðŸ‹ï¸","ðŸ§˜","ðŸ“š","ðŸ’§","ðŸ’Š","âœï¸","ðŸš¶","ðŸŽ¸","ðŸ¥—","ðŸ§¹","ðŸ’¤","ðŸŒ…","ðŸ§ ","ðŸ’ª","ðŸƒ","ðŸš´","ðŸ§˜â€â™€ï¸","ðŸ“","ðŸŽ¯","âœ…"];function tl(t){if(t==="everyday")return"Daily";if(t.length===0)return"No days";if(t.length===7)return"Daily";const r=[1,2,3,4,5];if(t.length===5&&r.every(f=>t.includes(f)))return"Weekdays";const a=[0,6];if(t.length===2&&a.every(f=>t.includes(f)))return"Weekends";const i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return[...t].sort((f,p)=>f-p).map(f=>i[f]).join(" ")}function nl({value:t,onChange:r}){return u.jsx("div",{className:"flex flex-wrap gap-2",children:ls.map(a=>u.jsx("button",{type:"button",onClick:()=>r(a.hex),className:`
            w-10 h-10 rounded-full transition-all duration-150
            ${t===a.hex?"ring-2 ring-white ring-offset-2 ring-offset-dark-bg scale-110":"hover:scale-105"}
          `,style:{backgroundColor:a.hex},title:a.name,"aria-label":`Select ${a.name} color`},a.id))})}function rl({value:t,onChange:r}){const a=t==="everyday",i=a?[0,1,2,3,4,5,6]:t,d=p=>{if(a)r([0,1,2,3,4,5,6].filter(m=>m!==p));else{const m=i.includes(p)?i.filter(S=>S!==p):[...i,p].sort((S,D)=>S-D);m.length===7?r("everyday"):r(m)}},f=()=>{r(a?[]:"everyday")};return u.jsxs("div",{className:"space-y-3",children:[u.jsx("button",{type:"button",onClick:f,className:`
          w-full py-2.5 px-4 rounded-lg font-medium text-sm transition-all
          ${a?"bg-accent-primary text-white":"bg-dark-elevated border border-dark-border text-gray-400 hover:border-gray-500"}
        `,children:"Every Day"}),u.jsx("div",{className:"flex justify-between gap-1",children:Zc.map(p=>{const m=i.includes(p.id);return u.jsx("button",{type:"button",onClick:()=>d(p.id),className:`
                flex-1 py-2.5 rounded-lg font-medium text-sm transition-all
                min-w-[40px] min-h-[44px]
                ${m?"bg-accent-primary/20 text-accent-primary border border-accent-primary/50":"bg-dark-elevated border border-dark-border text-gray-500 hover:border-gray-500"}
              `,title:p.name,"aria-label":p.name,children:p.short},p.id)})})]})}function ol({value:t,onChange:r}){const[a,i]=y.useState(!1);return u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:`w-14 h-14 rounded-xl bg-dark-elevated border border-dark-border 
                     flex items-center justify-center text-3xl`,children:t||"â“"}),u.jsx("input",{type:"text",value:t,onChange:d=>{const f=d.target.value;if(f.length>0){const p=[...f],m=p[p.length-1];r(m||"")}else r("")},placeholder:"Type or paste emoji",className:`flex-1 px-4 py-3 bg-dark-elevated border border-dark-border rounded-lg
                     text-white placeholder-gray-500 focus:border-accent-primary focus:outline-none`})]}),u.jsx("button",{type:"button",onClick:()=>i(!a),className:"text-sm text-gray-400 hover:text-white transition-colors",children:a?"â–² Hide suggestions":"â–¼ Show suggestions"}),a&&u.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-dark-elevated rounded-lg border border-dark-border",children:el.map(d=>u.jsx("button",{type:"button",onClick:()=>{r(d),i(!1)},className:`
                w-10 h-10 rounded-lg text-xl flex items-center justify-center
                transition-all hover:bg-dark-border
                ${t===d?"bg-accent-primary/20 ring-1 ring-accent-primary":""}
              `,children:d},d))})]})}function al({habit:t,onSave:r,onClose:a}){const i=!!t,[d,f]=y.useState((t==null?void 0:t.name)||""),[p,m]=y.useState((t==null?void 0:t.icon)||""),[S,D]=y.useState((t==null?void 0:t.color)||ls[0].hex),[O,R]=y.useState((t==null?void 0:t.scheduleDays)||"everyday"),[M,F]=y.useState((t==null?void 0:t.startDate)||_a),[q,I]=y.useState(!1),[z,ne]=y.useState(null);y.useEffect(()=>{const X=P=>{P.key==="Escape"&&a()};return window.addEventListener("keydown",X),()=>window.removeEventListener("keydown",X)},[a]);const B=()=>d.trim()?p?S?O!=="everyday"&&O.length===0?'Select at least one day or choose "Every Day"':null:"Color is required":"Icon is required":"Name is required",K=async X=>{X.preventDefault();const P=B();if(P){ne(P);return}I(!0),ne(null);try{await r({name:d.trim(),icon:p,color:S,scheduleDays:O,startDate:M,archivedAt:(t==null?void 0:t.archivedAt)||null}),a()}catch(W){console.error("Failed to save habit:",W),ne("Failed to save habit. Please try again.")}finally{I(!1)}},Y=new Date().toISOString().split("T")[0];return u.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",onClick:a,children:[u.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),u.jsxs("div",{className:`relative w-full max-w-lg max-h-[90vh] overflow-y-auto
                   bg-dark-surface border-t sm:border border-dark-border 
                   sm:rounded-2xl rounded-t-2xl p-5 pb-safe`,onClick:X=>X.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-xl font-semibold",children:i?"Edit Habit":"New Habit"}),u.jsx("button",{type:"button",onClick:a,className:`w-10 h-10 rounded-full bg-dark-elevated flex items-center justify-center
                       text-gray-400 hover:text-white transition-colors`,"aria-label":"Close",children:"âœ•"})]}),u.jsxs("form",{onSubmit:K,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Habit Name *"}),u.jsx("input",{type:"text",value:d,onChange:X=>f(X.target.value),placeholder:"e.g., Morning Workout",className:`w-full px-4 py-3 bg-dark-elevated border border-dark-border rounded-lg
                         text-white placeholder-gray-500 focus:border-accent-primary focus:outline-none`,autoFocus:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Icon *"}),u.jsx(ol,{value:p,onChange:m})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Color *"}),u.jsx(nl,{value:S,onChange:D})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Schedule *"}),u.jsx(rl,{value:O,onChange:R})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),u.jsx("input",{type:"date",value:M,onChange:X=>F(X.target.value),min:_a,max:Y,className:`w-full px-4 py-3 bg-dark-elevated border border-dark-border rounded-lg
                         text-white focus:border-accent-primary focus:outline-none
                         [color-scheme:dark]`}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Habits are tracked from this date onwards"})]}),z&&u.jsx("div",{className:"p-3 bg-accent-error/20 border border-accent-error/30 rounded-lg text-accent-error text-sm",children:z}),u.jsxs("div",{className:"flex gap-3 pt-2",children:[u.jsx("button",{type:"button",onClick:a,disabled:q,className:`flex-1 py-3 px-4 bg-dark-elevated border border-dark-border
                         text-gray-300 font-medium rounded-lg hover:bg-dark-border transition-colors`,children:"Cancel"}),u.jsx("button",{type:"submit",disabled:q,className:`flex-1 py-3 px-4 bg-accent-primary hover:bg-accent-primary/80
                         disabled:opacity-50 disabled:cursor-not-allowed
                         text-white font-medium rounded-lg transition-colors`,children:q?"Saving...":i?"Save Changes":"Create Habit"})]})]})]})]})}function us({habit:t,isArchived:r=!1,isDragging:a=!1,dragHandleProps:i,onEdit:d,onArchive:f,onUnarchive:p}){const[m,S]=y.useState(!1),D=tl(t.scheduleDays);return u.jsxs("div",{className:`
        group flex items-center gap-3 p-3 rounded-xl
        bg-dark-surface border border-dark-border
        transition-all duration-150
        ${a?"opacity-50 scale-[1.02] shadow-xl border-accent-primary/50":""}
        ${r?"opacity-60":"hover:border-gray-600"}
      `,children:[!r&&i&&u.jsx("button",{type:"button",...i,className:`w-8 h-10 flex items-center justify-center text-gray-500 
                     hover:text-white cursor-grab active:cursor-grabbing
                     touch-none select-none transition-colors`,"aria-label":"Drag to reorder",children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",className:"pointer-events-none",children:[u.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),u.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),u.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),u.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),u.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),u.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),r&&u.jsx("div",{className:"w-8"}),u.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center text-xl flex-shrink-0",style:{backgroundColor:`${t.color}20`},children:t.icon}),u.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:()=>d(t),children:[u.jsx("div",{className:"font-medium text-white truncate",children:t.name}),u.jsx("div",{className:"text-sm text-gray-400 flex items-center gap-2",children:u.jsx("span",{children:D})})]}),u.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:t.color},title:t.color}),u.jsxs("div",{className:"relative",children:[u.jsx("button",{type:"button",onClick:()=>S(!m),className:`w-10 h-10 flex items-center justify-center text-gray-400 
                     hover:text-white hover:bg-dark-elevated rounded-lg transition-colors`,"aria-label":"More actions",children:"â‹®"}),m&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>S(!1)}),u.jsxs("div",{className:`absolute right-0 top-full mt-1 z-20 
                            bg-dark-elevated border border-dark-border rounded-lg
                            shadow-xl min-w-[140px] py-1`,children:[u.jsx("button",{type:"button",onClick:()=>{d(t),S(!1)},className:`w-full px-4 py-2.5 text-left text-sm text-gray-300 
                           hover:bg-dark-border hover:text-white transition-colors`,children:"âœï¸ Edit"}),r?u.jsx("button",{type:"button",onClick:()=>{p(t.id),S(!1)},className:`w-full px-4 py-2.5 text-left text-sm text-gray-300 
                             hover:bg-dark-border hover:text-white transition-colors`,children:"ðŸ“¤ Unarchive"}):u.jsx("button",{type:"button",onClick:()=>{f(t.id),S(!1)},className:`w-full px-4 py-2.5 text-left text-sm text-accent-error
                             hover:bg-accent-error/10 transition-colors`,children:"ðŸ“¦ Archive"})]})]})]})]})}function sl({habit:t,onEdit:r,onArchive:a,onUnarchive:i}){const{attributes:d,listeners:f,setNodeRef:p,transform:m,transition:S,isDragging:D}=Yc({id:t.id}),O={transform:Hn.Transform.toString(m),transition:S,zIndex:D?10:void 0};return u.jsx("div",{ref:p,style:O,children:u.jsx(us,{habit:t,isDragging:D,dragHandleProps:{...d,...f},onEdit:r,onArchive:a,onUnarchive:i})})}function il(){const[t,r]=y.useState([]),[a,i]=y.useState([]),[d,f]=y.useState(!1),[p,m]=y.useState(!0),[S,D]=y.useState(null),[O,R]=y.useState(!1),[M,F]=y.useState(void 0),q=Ci(so(No,{activationConstraint:{distance:8}}),so(Za,{activationConstraint:{delay:200,tolerance:5}}),so(So,{coordinateGetter:Jc})),I=y.useCallback(async()=>{try{D(null);const[Q,ae]=await Promise.all([Et.getAll(!1),Et.getAll(!0)]);r(Q),i(ae.filter(le=>le.archivedAt!==null))}catch(Q){console.error("Failed to load habits:",Q),D("Failed to load habits. Please refresh the page.")}finally{m(!1)}},[]);y.useEffect(()=>{I()},[I]);const z=async Q=>{const{active:ae,over:le}=Q;if(!le||ae.id===le.id)return;const pe=t.findIndex(je=>je.id===ae.id),we=t.findIndex(je=>je.id===le.id);if(pe===-1||we===-1)return;const Se=Co(t,pe,we);r(Se);try{const je=Se.map((rt,ut)=>({id:rt.id,sortOrder:ut}));await Et.reorder(je)}catch(je){console.error("Failed to persist reorder:",je),D("Failed to save new order. Please try again."),await I()}},ne=async Q=>{await Et.create(Q),await I()},B=async Q=>{M&&(await Et.update(M.id,Q),await I())},K=async Q=>{try{await Et.archive(Q),await I()}catch(ae){console.error("Failed to archive habit:",ae),D("Failed to archive habit.")}},Y=async Q=>{try{const ae=t.length>0?Math.max(...t.map(le=>le.sortOrder)):-1;await Et.update(Q,{archivedAt:null,sortOrder:ae+1}),await I()}catch(ae){console.error("Failed to unarchive habit:",ae),D("Failed to unarchive habit.")}},X=Q=>{F(Q),R(!0)},P=()=>{F(void 0),R(!0)},W=()=>{R(!1),F(void 0)};return p?u.jsx("div",{className:"page-container p-4 flex items-center justify-center",children:u.jsx("div",{className:"text-gray-400",children:"Loading habits..."})}):u.jsxs("div",{className:"page-container p-4 space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-xl font-semibold",children:"Manage Habits"}),u.jsxs("button",{onClick:P,className:`px-4 py-2.5 bg-accent-primary hover:bg-accent-primary/80
                     text-white font-medium rounded-lg transition-colors
                     flex items-center gap-2`,children:[u.jsx("span",{className:"text-lg",children:"+"}),u.jsx("span",{children:"Add Habit"})]})]}),S&&u.jsxs("div",{className:`p-3 bg-accent-error/20 border border-accent-error/30 rounded-lg 
                        text-accent-error text-sm flex items-center justify-between`,children:[u.jsx("span",{children:S}),u.jsx("button",{onClick:()=>D(null),className:"text-accent-error hover:text-white",children:"âœ•"})]}),u.jsx("div",{className:"space-y-2",children:t.length===0?u.jsxs("div",{className:"card text-center py-8",children:[u.jsx("span",{className:"text-4xl mb-3 block",children:"ðŸ“"}),u.jsx("p",{className:"text-gray-400 mb-4",children:"No habits yet"}),u.jsx("button",{onClick:P,className:"text-accent-primary hover:underline",children:"Create your first habit"})]}):u.jsx(_c,{sensors:q,collisionDetection:Ei,onDragEnd:z,children:u.jsx($c,{items:t.map(Q=>Q.id),strategy:Kc,children:u.jsx("div",{className:"space-y-2",children:t.map(Q=>u.jsx(sl,{habit:Q,onEdit:X,onArchive:K,onUnarchive:Y},Q.id))})})})}),t.length>1&&u.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Drag the â‹®â‹® handle to reorder habits"}),a.length>0&&u.jsxs("div",{className:"pt-4",children:[u.jsxs("button",{onClick:()=>f(!d),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[u.jsx("span",{children:d?"â–¼":"â–¶"}),u.jsxs("span",{children:["Archived (",a.length,")"]})]}),d&&u.jsx("div",{className:"mt-3 space-y-2",children:a.map(Q=>u.jsx(us,{habit:Q,isArchived:!0,onEdit:X,onArchive:K,onUnarchive:Y},Q.id))})]}),O&&u.jsx(al,{habit:M,onSave:M?B:ne,onClose:W})]})}function _o(t){const r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}function zt(){return _o(new Date)}function yt(t,r){const a=r?new Date(r+"T00:00:00"):new Date;return a.setDate(a.getDate()-t),_o(a)}function Dr(t,r){const a=[],i=new Date(t+"T00:00:00"),d=new Date(r+"T00:00:00"),f=new Date(i);for(;f<=d;)a.push(_o(f)),f.setDate(f.getDate()+1);return a}function cl(t){return new Date(t+"T00:00:00").getDay()}function Un(t,r){return r==="everyday"?!0:r.includes(cl(t))}function Eo(t,r,a,i){return Dr(t,r).filter(f=>f>=i&&Un(f,a))}function ll(t){const r=new Map;for(const a of t)r.set(`${a.habitId}:${a.date}`,a.status);return r}function Ro(t,r,a){return t.get(`${r}:${a}`)??null}function Fn(t,r,a,i){const d=Eo(a,i,t.scheduleDays,t.startDate),f=d.length;if(f===0)return{rate:0,scheduledDays:0,completed:0};let p=0;for(const m of d)Ro(r,t.id,m)==="completed"&&p++;return{rate:p/f,scheduledDays:f,completed:p}}function ul(t,r,a=zt()){const i=Fn(t,r,yt(6,a),a),d=Fn(t,r,yt(29,a),a),f=Fn(t,r,yt(89,a),a);return{rate7:i.rate,rate30:d.rate,rate90:f.rate,scheduledDays7:i.scheduledDays,scheduledDays30:d.scheduledDays,scheduledDays90:f.scheduledDays,completedCount7:i.completed,completedCount30:d.completed,completedCount90:f.completed}}function dl(t,r,a=zt()){const i=yt(365,a),d=Eo(i,a,t.scheduleDays,t.startDate).reverse();if(d.length===0)return 0;let f=0,p=!1;for(const m of d){const S=Ro(r,t.id,m);if(S==="completed")p=!0,f++;else if(S==="skipped"){if(p)break;break}else{if(m===a)continue;if(p)break;break}}return f}function fl(t,r,a,i){const d=Eo(a,i,t.scheduleDays,t.startDate);if(d.length===0)return 0;let f=0,p=0;for(const m of d)Ro(r,t.id,m)==="completed"?(p++,f=Math.max(f,p)):p=0;return f}function hl(t,r,a=zt()){const i=a,d=yt(13,a),f=yt(14,a),p=yt(27,a),m=Fn(t,r,d,i),S=Fn(t,r,p,f);if(m.scheduledDays===0&&S.scheduledDays===0)return{trend:"stable",delta:0};const D=m.rate-S.rate;let O="stable";return D>=.2?O="improving":D<=-.2&&(O="slipping"),{trend:O,delta:D}}function pl(t,r,a=zt()){const i=ul(t,r,a),d=dl(t,r,a),f=fl(t,r,yt(365,a),a),{trend:p,delta:m}=hl(t,r,a);return{habitId:t.id,currentStreak:d,longestStreak:f,...i,trend:p,trendDelta:m}}function ml(t,r,a,i=zt()){let d=0,f=0,p=0,m=0;for(const I of r.values())d+=I.scheduledDays7,f+=I.completedCount7,p+=I.scheduledDays30,m+=I.completedCount30;const S=d>0?f/d:0,D=p>0?m/p:0;let O=0,R=0;for(const I of t)Un(i,I.scheduleDays)&&i>=I.startDate&&(R++,a.get(`${I.id}:${i}`)==="completed"&&O++);const M=R>0?O/R:0,F=t.filter(I=>{const z=r.get(I.id);return z&&z.scheduledDays30>=6}).map(I=>{const z=r.get(I.id);return{habitId:I.id,name:I.name,icon:I.icon,color:I.color,value:z.rate30}}).sort((I,z)=>z.value-I.value).slice(0,3),q=t.filter(I=>{const z=r.get(I.id);return z&&z.scheduledDays30>=6&&z.trendDelta<0}).map(I=>{const z=r.get(I.id);return{habitId:I.id,name:I.name,icon:I.icon,color:I.color,value:z.trendDelta}}).sort((I,z)=>I.value-z.value).slice(0,3);return{overallRate7:S,overallRate30:D,todayCompleted:O,todayScheduled:R,todayScore:M,mostConsistent:F,slipping:q}}function gl(t,r,a=zt()){if(t.length<2)return[];const i=yt(29,a),d=Dr(i,a),f=[];for(let p=0;p<t.length;p++)for(let m=0;m<t.length;m++){if(p===m)continue;const S=t[p],D=t[m];let O=0,R=0,M=0,F=0;for(const ne of d){const B=Un(ne,S.scheduleDays)&&ne>=S.startDate,K=Un(ne,D.scheduleDays)&&ne>=D.startDate;if(!B||!K)continue;const Y=r.get(`${S.id}:${ne}`),X=r.get(`${D.id}:${ne}`);Y==="completed"?(O++,X==="completed"&&R++):(M++,X==="completed"&&F++)}if(O<10||M<5)continue;const q=R/O,I=F/M,z=q-I;z>=.15&&f.push({habitAId:S.id,habitAName:S.name,habitAIcon:S.icon,habitBId:D.id,habitBName:D.name,habitBIcon:D.icon,lift:z,pWithA:q,pWithoutA:I})}return f.sort((p,m)=>m.lift-p.lift).slice(0,3)}function vl({overview:t}){const r=a=>`${Math.round(a*100)}%`;return u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"card bg-gradient-to-br from-accent-primary/20 to-accent-primary/5 border-accent-primary/30",children:u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-4xl font-bold text-accent-primary",children:[t.todayCompleted,"/",t.todayScheduled]}),u.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:["Today's Progress (",r(t.todayScore),")"]})]})}),u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{className:"card text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-white",children:r(t.overallRate7)}),u.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Last 7 Days"})]}),u.jsxs("div",{className:"card text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-white",children:r(t.overallRate30)}),u.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Last 30 Days"})]})]}),t.mostConsistent.length>0&&u.jsxs("div",{className:"card",children:[u.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-3 flex items-center gap-2",children:[u.jsx("span",{children:"ðŸ†"})," Most Consistent"]}),u.jsx("div",{className:"space-y-2",children:t.mostConsistent.map((a,i)=>u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("span",{className:"text-xs text-gray-500 w-4",children:[i+1,"."]}),u.jsx("span",{children:a.icon}),u.jsx("span",{className:"flex-1 text-sm text-gray-200 truncate",children:a.name}),u.jsx("span",{className:"text-sm font-medium text-accent-success",children:r(a.value)})]},a.habitId))})]}),t.slipping.length>0&&u.jsxs("div",{className:"card border-accent-error/30 bg-accent-error/5",children:[u.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-3 flex items-center gap-2",children:[u.jsx("span",{children:"ðŸ“‰"})," Needs Attention"]}),u.jsx("div",{className:"space-y-2",children:t.slipping.map((a,i)=>u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("span",{className:"text-xs text-gray-500 w-4",children:[i+1,"."]}),u.jsx("span",{children:a.icon}),u.jsx("span",{className:"flex-1 text-sm text-gray-200 truncate",children:a.name}),u.jsxs("span",{className:"text-sm font-medium text-accent-error",children:[Math.round(a.value*100),"%"]})]},a.habitId))})]})]})}function yl({trend:t,delta:r}){const i={improving:{bg:"bg-accent-success/20",text:"text-accent-success",label:"Improving",icon:"â†‘"},slipping:{bg:"bg-accent-error/20",text:"text-accent-error",label:"Slipping",icon:"â†“"},stable:{bg:"bg-gray-700/50",text:"text-gray-400",label:"Stable",icon:"â†’"}}[t],d=Math.round(Math.abs(r)*100);return u.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${i.bg} ${i.text}`,children:[u.jsx("span",{children:i.icon}),u.jsx("span",{children:i.label}),d>0&&u.jsxs("span",{children:["(",d,"%)"]})]})}function bl({habit:t,stats:r,onClick:a}){const i=d=>`${Math.round(d*100)}%`;return u.jsxs("div",{className:`card hover:border-gray-600 transition-colors ${a?"cursor-pointer":""}`,onClick:a,children:[u.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-lg",style:{backgroundColor:`${t.color}20`},children:t.icon}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"font-medium text-white truncate",children:t.name}),u.jsx(yl,{trend:r.trend,delta:r.trendDelta})]}),u.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:t.color}})]}),u.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[u.jsxs("div",{className:"bg-dark-elevated rounded-lg py-2 px-1",children:[u.jsx("div",{className:"text-lg font-bold text-accent-primary",children:r.currentStreak}),u.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:"Streak"})]}),u.jsxs("div",{className:"bg-dark-elevated rounded-lg py-2 px-1",children:[u.jsx("div",{className:"text-lg font-bold text-gray-300",children:r.longestStreak}),u.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:"Best"})]}),u.jsxs("div",{className:"bg-dark-elevated rounded-lg py-2 px-1",children:[u.jsx("div",{className:"text-lg font-bold text-gray-300",children:r.scheduledDays7>0?i(r.rate7):"â€”"}),u.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:"7d"})]}),u.jsxs("div",{className:"bg-dark-elevated rounded-lg py-2 px-1",children:[u.jsx("div",{className:"text-lg font-bold text-gray-300",children:r.scheduledDays30>0?i(r.rate30):"â€”"}),u.jsx("div",{className:"text-[10px] text-gray-500 leading-tight",children:"30d"})]})]}),a&&u.jsx("div",{className:"mt-2 text-[10px] text-gray-600 text-center",children:"Tap for details"})]})}function xl({connections:t}){return t.length===0?null:u.jsxs("div",{className:"card",children:[u.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-3 flex items-center gap-2",children:[u.jsx("span",{children:"ðŸ”—"})," Habit Connections"]}),u.jsx("div",{className:"space-y-3",children:t.map(r=>u.jsxs("div",{className:"p-3 bg-dark-elevated rounded-lg",children:[u.jsxs("div",{className:"text-sm text-gray-200",children:[u.jsx("span",{className:"text-lg",children:r.habitAIcon}),u.jsx("span",{className:"mx-2 text-gray-500",children:"â†’"}),u.jsx("span",{className:"text-lg",children:r.habitBIcon})]}),u.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["On days you complete ",u.jsx("span",{className:"text-white",children:r.habitAName}),", you complete ",u.jsx("span",{className:"text-white",children:r.habitBName})," ",u.jsxs("span",{className:"text-accent-success font-medium",children:[Math.round(r.lift*100),"% more"]})," often"]})]},`${r.habitAId}-${r.habitBId}`))}),u.jsx("div",{className:"mt-3 text-[10px] text-gray-600 text-center",children:"Based on the last 30 days"})]})}function wl({habit:t,stats:r,logsMap:a,onClose:i}){const d=zt(),f=D=>`${Math.round(D*100)}%`;y.useEffect(()=>{const D=O=>{O.key==="Escape"&&i()};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[i]);const p=y.useMemo(()=>Dr(yt(89,d),d).map(O=>{const R=a.get(`${t.id}:${O}`),M=Un(O,t.scheduleDays)&&O>=t.startDate;return{date:O,status:R,isScheduled:M}}),[t,a,d]),m=y.useMemo(()=>{const D=[],O=Dr(yt(30,d),d).reverse();for(const R of O){const M=a.get(`${t.id}:${R}`);if(M&&(D.push({date:R,status:M}),D.length>=10))break}return D},[t.id,a,d]),S=t.scheduleDays==="everyday"?"Every day":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].filter((D,O)=>t.scheduleDays.includes(O)).join(", ");return u.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",onClick:i,children:[u.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),u.jsxs("div",{className:`relative w-full max-w-lg max-h-[85vh] overflow-y-auto
                   bg-dark-surface border-t sm:border border-dark-border 
                   sm:rounded-2xl rounded-t-2xl p-5`,onClick:D=>D.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:`${t.color}20`},children:t.icon}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h2",{className:"text-lg font-semibold",children:t.name}),u.jsx("div",{className:"text-sm text-gray-400",children:S})]}),u.jsx("button",{type:"button",onClick:i,className:`w-8 h-8 rounded-full bg-dark-elevated flex items-center justify-center
                       text-gray-400 hover:text-white transition-colors`,"aria-label":"Close",children:"âœ•"})]}),u.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[u.jsxs("div",{className:"bg-dark-elevated rounded-lg py-2 text-center",children:[u.jsx("div",{className:"text-xl font-bold text-accent-primary",children:r.currentStreak}),u.jsx("div",{className:"text-[10px] text-gray-500",children:"Current"})]}),u.jsxs("div",{className:"bg-dark-elevated rounded-lg py-2 text-center",children:[u.jsx("div",{className:"text-xl font-bold text-gray-300",children:r.longestStreak}),u.jsx("div",{className:"text-[10px] text-gray-500",children:"Longest"})]}),u.jsxs("div",{className:"bg-dark-elevated rounded-lg py-2 text-center",children:[u.jsx("div",{className:"text-xl font-bold text-gray-300",children:r.scheduledDays30>0?f(r.rate30):"â€”"}),u.jsx("div",{className:"text-[10px] text-gray-500",children:"30d Rate"})]}),u.jsxs("div",{className:"bg-dark-elevated rounded-lg py-2 text-center",children:[u.jsx("div",{className:"text-xl font-bold text-gray-300",children:r.scheduledDays90>0?f(r.rate90):"â€”"}),u.jsx("div",{className:"text-[10px] text-gray-500",children:"90d Rate"})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"Last 90 Days"}),u.jsx("div",{className:"flex flex-wrap gap-[2px]",children:p.map(({date:D,status:O,isScheduled:R})=>{let M="bg-dark-border/50";return O==="completed"?M="":O==="skipped"?M="bg-gray-600":R||(M="bg-dark-border/20"),u.jsx("div",{className:`w-2 h-2 rounded-sm ${M}`,style:O==="completed"?{backgroundColor:t.color}:void 0,title:`${D}: ${O||(R?"empty":"off-schedule")}`},D)})}),u.jsxs("div",{className:"flex justify-between mt-1 text-[9px] text-gray-600",children:[u.jsx("span",{children:"90 days ago"}),u.jsx("span",{children:"Today"})]})]}),m.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"Recent Activity"}),u.jsx("div",{className:"space-y-1",children:m.map(({date:D,status:O})=>{const M=new Date(D+"T00:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"});return u.jsxs("div",{className:`flex items-center justify-between py-1.5 px-2 
                               bg-dark-elevated rounded-lg text-sm`,children:[u.jsx("span",{className:"text-gray-400",children:M}),u.jsx("span",{className:O==="completed"?"text-accent-success":"text-gray-500",children:O==="completed"?"âœ“ Completed":"â€” Skipped"})]},D)})})]})]})]})}function jl(){const[t,r]=y.useState(!0),[a,i]=y.useState(null),[d,f]=y.useState([]),[p,m]=y.useState(new Map),[S,D]=y.useState(null),[O,R]=y.useState([]),[M,F]=y.useState(new Map),[q,I]=y.useState(!1),[z,ne]=y.useState("default"),[B,K]=y.useState(null),Y=y.useCallback(async()=>{try{r(!0),i(null);const P=zt(),W=await Et.getAll(q);if(f(W),W.length===0){m(new Map),D(null),R([]),F(new Map),r(!1);return}const Q=yt(120,P),ae=await It.getByDateRange(Q,P),le=ll(ae);F(le);const pe=new Map;for(const je of W)pe.set(je.id,pl(je,le,P));m(pe);const we=ml(W,pe,le,P);D(we);const Se=W.filter(je=>je.archivedAt===null);if(Se.length>=2&&Se.length<=15){const je=gl(Se,le,P);R(je)}else R([])}catch(P){console.error("Analytics error:",P),i("Failed to load analytics")}finally{r(!1)}},[q]);y.useEffect(()=>{Y()},[Y]);const X=[...d].sort((P,W)=>{const Q=p.get(P.id),ae=p.get(W.id);if(!Q||!ae)return 0;switch(z){case"streak":return ae.currentStreak-Q.currentStreak;case"rate30":return ae.rate30-Q.rate30;case"slipping":return Q.trendDelta-ae.trendDelta;default:return P.sortOrder-W.sortOrder}});return t?u.jsx("div",{className:"page-container flex items-center justify-center",children:u.jsx("div",{className:"text-gray-400",children:"Loading analytics..."})}):a?u.jsx("div",{className:"page-container p-4",children:u.jsxs("div",{className:"card text-center py-8",children:[u.jsx("span",{className:"text-3xl mb-3 block",children:"âš ï¸"}),u.jsx("p",{className:"text-accent-error mb-4",children:a}),u.jsx("button",{onClick:Y,className:"text-accent-primary hover:underline",children:"Try again"})]})}):d.length===0?u.jsx("div",{className:"page-container p-4",children:u.jsxs("div",{className:"card text-center py-8",children:[u.jsx("span",{className:"text-4xl mb-4 block",children:"ðŸ“Š"}),u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"No Data Yet"}),u.jsx("p",{className:"text-gray-400 mb-4",children:"Add some habits and log your progress to see analytics."}),u.jsx("a",{href:"/habits",className:`inline-block px-4 py-2 bg-accent-primary hover:bg-accent-primary/80
                       text-white font-medium rounded-lg transition-colors`,children:"Add Habits"})]})}):u.jsxs("div",{className:"page-container p-4 space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-xl font-semibold",children:"Analytics"}),u.jsx("button",{onClick:Y,className:"text-sm text-gray-400 hover:text-white transition-colors",title:"Refresh",children:"ðŸ”„ Refresh"})]}),S&&u.jsx(vl,{overview:S}),O.length>0&&u.jsx(xl,{connections:O}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("h2",{className:"text-sm font-medium text-gray-300",children:"All Habits"}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("select",{value:z,onChange:P=>ne(P.target.value),className:`text-xs bg-dark-elevated border border-dark-border rounded-lg 
                         px-2 py-1 text-gray-300 focus:outline-none focus:border-accent-primary`,children:[u.jsx("option",{value:"default",children:"Default"}),u.jsx("option",{value:"streak",children:"By Streak"}),u.jsx("option",{value:"rate30",children:"By 30d Rate"}),u.jsx("option",{value:"slipping",children:"Needs Work"})]})})]}),u.jsxs("label",{className:"flex items-center gap-2 mb-3 text-sm text-gray-400 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:q,onChange:P=>I(P.target.checked),className:`w-4 h-4 rounded bg-dark-elevated border-dark-border 
                       text-accent-primary focus:ring-accent-primary focus:ring-offset-0`}),u.jsx("span",{children:"Include archived"})]}),u.jsx("div",{className:"space-y-3",children:X.map(P=>{const W=p.get(P.id);return W?u.jsx(bl,{habit:P,stats:W,onClick:()=>K(P)},P.id):null})})]}),B&&p.get(B.id)&&u.jsx(wl,{habit:B,stats:p.get(B.id),logsMap:M,onClose:()=>K(null)})]})}const kl=1,Ea=[1];async function Sl(){const t=await oe.habits.orderBy("sortOrder").toArray(),r=await oe.logs.toArray();return{schemaVersion:kl,exportedAt:new Date().toISOString(),appName:"Daily",habits:t,logs:r}}function Dl(){return`daily-export-${new Date().toISOString().split("T")[0]}.json`}function Nl(t,r){const a=JSON.stringify(t,null,2),i=new Blob([a],{type:"application/json"}),d=URL.createObjectURL(i),f=document.createElement("a");f.href=d,f.download=r,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(d)}async function Cl(){try{const t=await Sl(),r=Dl();return Nl(t,r),{success:!0,filename:r}}catch(t){throw console.error("Export failed:",t),t}}function _l(t){return new Promise((r,a)=>{const i=new FileReader;i.onload=()=>r(i.result),i.onerror=()=>a(new Error("Failed to read file")),i.readAsText(t)})}function Ra(t,r){const a=[],i=t;return!i||typeof i!="object"?(a.push(`Habit ${r}: not a valid object`),a):((!i.id||typeof i.id!="string")&&a.push(`Habit ${r}: missing or invalid 'id'`),(!i.name||typeof i.name!="string")&&a.push(`Habit ${r}: missing or invalid 'name'`),(i.sortOrder===void 0||typeof i.sortOrder!="number")&&a.push(`Habit ${r}: missing or invalid 'sortOrder'`),(!i.startDate||typeof i.startDate!="string")&&a.push(`Habit ${r}: missing or invalid 'startDate'`),i.scheduleDays?i.scheduleDays!=="everyday"&&!Array.isArray(i.scheduleDays)&&a.push(`Habit ${r}: 'scheduleDays' must be 'everyday' or an array`):a.push(`Habit ${r}: missing 'scheduleDays'`),a)}function Oa(t,r){const a=[],i=t;return!i||typeof i!="object"?(a.push(`Log ${r}: not a valid object`),a):((!i.habitId||typeof i.habitId!="string")&&a.push(`Log ${r}: missing or invalid 'habitId'`),(!i.date||typeof i.date!="string")&&a.push(`Log ${r}: missing or invalid 'date'`),(!i.status||!["completed","skipped"].includes(i.status))&&a.push(`Log ${r}: invalid 'status' (must be 'completed' or 'skipped')`),a)}function El(t){const r=[],a=[];let i;try{i=JSON.parse(t)}catch{return{valid:!1,errors:["Invalid JSON format. Please provide a valid JSON file."],warnings:[],data:null}}if(!i||typeof i!="object")return{valid:!1,errors:["File does not contain a valid object."],warnings:[],data:null};const d=i;if(!d.schemaVersion||typeof d.schemaVersion!="number"?r.push("Missing or invalid 'schemaVersion'."):Ea.includes(d.schemaVersion)||r.push(`Unsupported schema version: ${d.schemaVersion}. Supported: ${Ea.join(", ")}`),!Array.isArray(d.habits))r.push("Missing or invalid 'habits' array.");else{const f=Math.min(d.habits.length,5);for(let p=0;p<f;p++)r.push(...Ra(d.habits[p],p));if(d.habits.length>5){let p=0;for(let m=5;m<d.habits.length;m++)p+=Ra(d.habits[m],m).length;p>0&&r.push(`...and ${p} more habit validation errors`)}}if(!Array.isArray(d.logs))r.push("Missing or invalid 'logs' array.");else{const f=Math.min(d.logs.length,5);for(let p=0;p<f;p++)r.push(...Oa(d.logs[p],p));if(d.logs.length>5){let p=0;for(let m=5;m<d.logs.length;m++)p+=Oa(d.logs[m],m).length;p>0&&r.push(`...and ${p} more log validation errors`)}}if(Array.isArray(d.logs)){const f=new Set;let p=0;for(const m of d.logs)if(m.habitId&&m.date){const S=`${m.habitId}:${m.date}`;f.has(S)?p++:f.add(S)}p>0&&a.push(`Found ${p} duplicate log entries. Last occurrence will be used.`)}return r.length>0?{valid:!1,errors:r,warnings:a,data:null}:{valid:!0,errors:[],warnings:a,data:d}}function Rl(t){const r=new Map;for(const i of t){const d=`${i.habitId}:${i.date}`;r.set(d,i)}const a=Array.from(r.values());return{logs:a,duplicatesRemoved:t.length-a.length}}async function Ol(t){try{const{logs:r,duplicatesRemoved:a}=Rl(t.logs);return await oe.transaction("rw",[oe.habits,oe.logs],async()=>{await oe.habits.clear(),await oe.logs.clear(),t.habits.length>0&&await oe.habits.bulkAdd(t.habits),r.length>0&&await oe.logs.bulkAdd(r)}),{success:!0,habitsImported:t.habits.length,logsImported:r.length,duplicateLogsSkipped:a}}catch(r){return console.error("Import failed:",r),{success:!1,habitsImported:0,logsImported:0,duplicateLogsSkipped:0,error:r instanceof Error?r.message:"Unknown error"}}}async function Al(){try{return await oe.transaction("rw",[oe.habits,oe.logs],async()=>{await oe.habits.clear(),await oe.logs.clear()}),!0}catch(t){return console.error("Reset failed:",t),!1}}const Tl=!1;function Il({isOpen:t,onClose:r,onConfirm:a}){const[i,d]=y.useState(""),f=y.useRef(null);if(y.useEffect(()=>{t&&(d(""),setTimeout(()=>{var m;return(m=f.current)==null?void 0:m.focus()},100))},[t]),!t)return null;const p=i.toUpperCase()==="RESET";return u.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[u.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:r}),u.jsxs("div",{className:"relative w-full max-w-md bg-dark-surface border border-accent-error/30 rounded-2xl p-6",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("span",{className:"text-4xl mb-3 block",children:"âš ï¸"}),u.jsx("h2",{className:"text-xl font-bold text-accent-error mb-2",children:"Reset All Data?"}),u.jsx("p",{className:"text-gray-400 text-sm",children:"This will permanently delete all your habits and logs. This action cannot be undone."})]}),u.jsxs("div",{className:"mb-6",children:[u.jsxs("label",{className:"block text-sm text-gray-300 mb-2",children:["Type ",u.jsx("span",{className:"font-mono bg-dark-elevated px-1 rounded",children:"RESET"})," to confirm:"]}),u.jsx("input",{ref:f,type:"text",value:i,onChange:m=>d(m.target.value),placeholder:"Type RESET here",className:`w-full px-4 py-3 bg-dark-elevated border border-dark-border rounded-lg
                       text-white placeholder-gray-500 focus:outline-none focus:border-accent-error
                       text-center font-mono text-lg tracking-widest`})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:r,className:`flex-1 py-3 px-4 bg-dark-elevated hover:bg-dark-border
                       text-gray-300 font-medium rounded-lg transition-colors`,children:"Cancel"}),u.jsx("button",{onClick:a,disabled:!p,className:`flex-1 py-3 px-4 bg-accent-error hover:bg-accent-error/80
                       disabled:opacity-30 disabled:cursor-not-allowed
                       text-white font-medium rounded-lg transition-colors`,children:"Reset Everything"})]})]})]})}function Pl({isOpen:t,onClose:r,onConfirm:a,habitsCount:i,logsCount:d,warnings:f}){return t?u.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[u.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:r}),u.jsxs("div",{className:"relative w-full max-w-md bg-dark-surface border border-dark-border rounded-2xl p-6",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("span",{className:"text-4xl mb-3 block",children:"ðŸ“¥"}),u.jsx("h2",{className:"text-xl font-bold mb-2",children:"Import Data?"}),u.jsx("p",{className:"text-gray-400 text-sm",children:"This will replace your current data with:"})]}),u.jsx("div",{className:"bg-dark-elevated rounded-lg p-4 mb-4",children:u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-accent-primary",children:i}),u.jsx("div",{className:"text-xs text-gray-500",children:"Habits"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-accent-success",children:d}),u.jsx("div",{className:"text-xs text-gray-500",children:"Log Entries"})]})]})}),f.length>0&&u.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3 mb-4",children:[u.jsx("div",{className:"text-amber-400 text-sm font-medium mb-1",children:"âš ï¸ Warnings:"}),f.map((p,m)=>u.jsx("div",{className:"text-amber-300/80 text-xs",children:p},m))]}),u.jsx("p",{className:"text-sm text-gray-500 text-center mb-4",children:"Your current habits and logs will be permanently replaced."}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:r,className:`flex-1 py-3 px-4 bg-dark-elevated hover:bg-dark-border
                       text-gray-300 font-medium rounded-lg transition-colors`,children:"Cancel"}),u.jsx("button",{onClick:a,className:`flex-1 py-3 px-4 bg-accent-primary hover:bg-accent-primary/80
                       text-white font-medium rounded-lg transition-colors`,children:"Import"})]})]})]}):null}function Ml(){const t=Ls(),r=y.useRef(null),[a,i]=y.useState(null),[d,f]=y.useState(!1),[p,m]=y.useState(null),[S,D]=y.useState(!1),[O,R]=y.useState(!1),[M,F]=y.useState(null);y.useEffect(()=>{q()},[]);const q=async()=>{try{const P=await ui();i(P)}catch(P){console.error("Failed to load stats:",P)}},I=(P,W)=>{m({type:P,text:W}),setTimeout(()=>m(null),5e3)},z=async()=>{f(!0),m(null);try{const P=await Cl();I("success",`Exported to ${P.filename}`)}catch(P){console.error("Export failed:",P),I("error","Export failed. Check console for details.")}finally{f(!1)}},ne=()=>{var P;(P=r.current)==null||P.click()},B=async P=>{var Q;const W=(Q=P.target.files)==null?void 0:Q[0];if(W){P.target.value="",f(!0),m(null);try{const ae=await _l(W),le=El(ae);if(!le.valid){I("error","Invalid file: "+le.errors.slice(0,2).join("; ")),f(!1);return}F({data:le.data,warnings:le.warnings}),R(!0)}catch(ae){console.error("Import validation failed:",ae),I("error","Failed to read file.")}finally{f(!1)}}},K=async()=>{if(M){R(!1),f(!0);try{const P=await Ol(M.data);if(P.success){let W=`Imported ${P.habitsImported} habits and ${P.logsImported} logs.`;P.duplicateLogsSkipped>0&&(W+=` (${P.duplicateLogsSkipped} duplicate logs merged)`),I("success",W),await q(),setTimeout(()=>t("/"),1e3)}else I("error",`Import failed: ${P.error}`)}catch(P){console.error("Import failed:",P),I("error","Import failed unexpectedly.")}finally{f(!1),F(null)}}},Y=()=>{D(!0)},X=async()=>{D(!1),f(!0),m(null);try{await Al()?(I("success","All data has been reset."),await q(),setTimeout(()=>t("/"),1e3)):I("error","Reset failed.")}catch(P){console.error("Reset failed:",P),I("error","Reset failed unexpectedly.")}finally{f(!1)}};return u.jsxs("div",{className:"page-container p-4 space-y-6",children:[u.jsx("input",{ref:r,type:"file",accept:".json,application/json",onChange:B,className:"hidden"}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-xl font-semibold mb-1",children:"Settings"}),u.jsx("p",{className:"text-gray-400 text-sm",children:"Manage your data and preferences"})]}),p&&u.jsx("div",{className:`p-3 rounded-lg text-sm ${p.type==="success"?"bg-accent-success/20 text-accent-success border border-accent-success/30":p.type==="warning"?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-accent-error/20 text-accent-error border border-accent-error/30"}`,children:p.text}),u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-sm font-medium text-gray-300 mb-3",children:"Your Data"}),a?u.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-accent-primary",children:a.habitCount}),u.jsx("div",{className:"text-xs text-gray-500",children:"Active Habits"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-accent-success",children:a.logCount}),u.jsx("div",{className:"text-xs text-gray-500",children:"Log Entries"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-gray-500",children:a.archivedHabitCount}),u.jsx("div",{className:"text-xs text-gray-500",children:"Archived"})]})]}):u.jsx("div",{className:"text-gray-500 text-sm",children:"Loading..."})]}),u.jsxs("div",{className:"card",children:[u.jsx("h2",{className:"text-sm font-medium text-gray-300 mb-3",children:"ðŸ“¦ Backup & Restore"}),u.jsx("p",{className:"text-gray-500 text-xs mb-4",children:"Export your data to a JSON file for backup, or import from a previous export."}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:z,disabled:d,className:`flex-1 py-3 px-4 bg-accent-primary hover:bg-accent-primary/80 
                       disabled:opacity-50 disabled:cursor-not-allowed
                       text-white font-medium rounded-lg transition-colors`,children:d?"Working...":"ðŸ“¤ Export Data"}),u.jsx("button",{onClick:ne,disabled:d,className:`flex-1 py-3 px-4 bg-dark-elevated hover:bg-dark-border
                       border border-dark-border
                       disabled:opacity-50 disabled:cursor-not-allowed
                       text-gray-200 font-medium rounded-lg transition-colors`,children:d?"Working...":"ðŸ“¥ Import Data"})]}),u.jsx("div",{className:"mt-3 text-[10px] text-gray-600",children:"Exports include all habits (including archived) and all log entries."})]}),u.jsxs("div",{className:"card border-accent-error/20 bg-accent-error/5",children:[u.jsx("h2",{className:"text-sm font-medium text-accent-error/80 mb-3",children:"âš ï¸ Danger Zone"}),u.jsx("p",{className:"text-gray-500 text-xs mb-4",children:"This action is permanent and cannot be undone."}),u.jsx("button",{onClick:Y,disabled:d,className:`w-full py-3 px-4 bg-accent-error/20 hover:bg-accent-error/30 
                     border border-accent-error/50
                     disabled:opacity-50 disabled:cursor-not-allowed
                     text-accent-error font-medium rounded-lg transition-colors`,children:"ðŸ—‘ï¸ Reset All Data"})]}),Tl,u.jsx(Il,{isOpen:S,onClose:()=>D(!1),onConfirm:X}),M&&u.jsx(Pl,{isOpen:O,onClose:()=>{R(!1),F(null)},onConfirm:K,habitsCount:M.data.habits.length,logsCount:M.data.logs.length,warnings:M.warnings})]})}function Ll(){return u.jsx(Bs,{children:u.jsxs(In,{path:"/",element:u.jsx(Vs,{}),children:[u.jsx(In,{index:!0,element:u.jsx(fi,{})}),u.jsx(In,{path:"habits",element:u.jsx(il,{})}),u.jsx(In,{path:"analytics",element:u.jsx(jl,{})}),u.jsx(In,{path:"settings",element:u.jsx(Ml,{})})]})})}uo.createRoot(document.getElementById("root")).render(u.jsx(Ge.StrictMode,{children:u.jsx(Ks,{children:u.jsx(Ll,{})})}));
